<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN" "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="GENERATOR" content="LyX 2.3.6.1" />
<meta http-equiv="Content-type" content="text/html;charset=UTF-8" />
<title>LyX Document</title>
<style type='text/css'>
/* Layout-provided Styles */
div.standard {
text-align: left;

}
div.plain_layout {
text-align: left;

}
h3.subsection_ {
font-weight: bold;
font-size: medium;
margin-top: 0.9ex;
margin-bottom: 0.5ex;
text-align: left;

}
ul.itemize {
margin-top: 0.7ex;
margin-bottom: 0.7ex;
margin-left: 3ex;
text-align: left;

}
h2.section {
font-weight: normal;
font-style: normal;
font-variant: small-caps;
font-size: medium;
margin-top: 1.3ex;
margin-bottom: 0.7ex;
text-align: center;

}
div.theorem {
font-style: italic;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.theorem_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
div.problem {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.problem_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
div.remark {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.remark_label {
font-weight: normal;
font-style: italic;
font-variant: normal;
font-size: medium;

}
h3.subsection {
font-weight: bold;
font-size: medium;
margin-top: 0.9ex;
margin-bottom: 0.5ex;
text-align: left;

}
span.subsection_label {
font-weight: normal;
font-size: medium;

}
div.notation {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.notation_label {
font-weight: normal;
font-style: italic;
font-variant: normal;
font-size: medium;

}
div.algorithm {
font-style: italic;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.algorithm_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
ol.enumerate {
margin-top: 0.7ex;
margin-bottom: 0.7ex;
margin-left: 3ex;
text-align: left;

}
div.note {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.note_label {
font-weight: normal;
font-style: italic;
font-variant: normal;
font-size: medium;

}
div.condition {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.condition_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
div.proof {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.proof_label {
font-style: italic;
font-variant: normal;
font-size: medium;

}
div.proposition {
font-style: italic;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.proposition_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
div.example {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.example_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
div.definition {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.definition_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
div.Shadowbox { border: solid gray medium; border-bottom: solid black 1ex; border-right: solid black 1ex; padding: 0.5ex; }
div.Boxed {
	border: solid thick black;
	padding: 0.5ex;
}
span.foot_label {
	vertical-align: super;
	font-size: smaller;
	font-weight: bold;
	text-decoration: underline;
}
div.foot {
	display: inline;
	font-size: small;
	font-weight: medium;
	font-family: serif;
	font-variant: normal;
	font-style: normal;
}
div.foot_inner { display: none; }
div.foot:hover div.foot_inner {
	display: block;
	border: 1px double black;
	margin: 0em 1em;
	padding: 1em;
}
span.flex_url {
font-family: monospace;
}
div.float {
	border: 2px solid black;
	text-align: center;
}
div.float-caption {
	text-align: center;
	border: 2px solid black;
	padding: 1ex;
	margin: 1ex;
}


</style>
</head>
<body dir="auto">


<div class="standard" id='magicparlabel-1'><div class='Shadowbox'><div class="plain_layout" id='magicparlabel-10'>Machine Learning and Neural Networks (MATH3431)&nbsp;&nbsp;Epiphany term, 2023<div style='height:3ex'></div></div>

<div class="plain_layout" style='text-align: center;' id='magicparlabel-11'> Handout 3: Stochastic gradient descent <div style='height:3ex'></div></div>

<div class="plain_layout" id='magicparlabel-28'>Lecturer &amp; author: Georgios P. Karagiannis <a href="georgios.karagiannis@durham.ac.uk">georgios.karagiannis@durham.ac.uk</a></div>

<div class="plain_layout" id='magicparlabel-29'><hr />

<div style='height:3ex'></div></div>
<h3 class="subsection_" id='magicparlabel-30'>Aim</h3>
<div class="plain_layout" id='magicparlabel-31'>To introduce the stochastic gradient descent (motivation, description, practical tricks, analysis in the convex scenario, and implementation).</div>

<div class="plain_layout" id='magicparlabel-32'><hr />

<div style='height:3ex'></div></div>
<h3 class="subsection_" id='magicparlabel-33'>Reading list &amp; references:</h3>

<ul class="itemize" id='magicparlabel-34'><li class="itemize_item">Shalev-Shwartz, S., &amp; Ben-David, S. (2014). Understanding machine learning: From theory to algorithms. Cambridge university press. </li>
<li class="itemize_item">Bottou, L. (2012). Stochastic gradient descent tricks. In Neural networks: Tricks of the trade (pp. 421-436). Springer, Berlin, Heidelberg.</li>
</ul>
<div class="plain_layout" id='magicparlabel-40'>This is subject to minor changes that will be decided based on the Lecture. It will be finalized around 1 day after the Lecture. It is given as guide before the lecture. </div>
</div></div>
<h2 class="section" id='magicparlabel-41'><span class="section_label">1</span> Motivations for stochastic gradient descent</h2>

<div class="problem" id='magicparlabel-42'><div class="problem_item"><span class="problem_label">Problem 1.</span>
<a id="prob_Consider_a_learning" />
Consider a learning problem <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

  <mrow>
   <mstyle mathvariant='script'><mi>H</mi>
   </mstyle><mo>,</mo>
   <mstyle mathvariant='script'><mi>Z</mi>
   </mstyle><mo>,</mo><mi> &ell; </mi>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

 </mrow></math>. Learning may involve the computation of the minimizer <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msup>
    <mrow><mi>w</mi>
    </mrow>
    <mrow><mo>*</mo>
    </mrow>
   </msup><mo> &isin; </mo>
   <mstyle mathvariant='script'><mi>H</mi>
   </mstyle>
  </mrow>
 </mrow></math>, where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='script'><mi>H</mi>
  </mstyle>
 </mrow></math> is a class of hypotheses, of the risk function (RF) <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>R</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
   <msub>
    <mrow>
     <mstyle mathvariant='normal'><mi>E</mi>
     </mstyle>
    </mrow>
    <mrow>
     <mrow><mi>z</mi><mo> &sim; </mo><mi>g</mi>
     </mrow>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &ell; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow><mi>w</mi><mo>,</mo><mi>z</mi>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> given an unknown data generating model <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>g</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mo> &sdot; </mo>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> and using a known tractable loss <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &ell; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mo> &sdot; </mo><mo>,</mo><mo> &sdot; </mo>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>; that is <a id="eq_rfminproblem" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mo>*</mo>
      </mrow>
     </msup><mo>=</mo><mo> arg </mo>
     <msub>
      <mrow><mo> min </mo>
      </mrow>
      <mrow>
       <mrow><mi> &forall; </mi><mi>w</mi><mo> &isin; </mo>
        <mstyle mathvariant='script'><mi>H</mi>
        </mstyle>
       </mrow>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi>R</mi>
       </mrow>
       <mrow><mi>g</mi>
       </mrow>
      </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mo> arg </mo>
     <msub>
      <mrow><mo> min </mo>
      </mrow>
      <mrow>
       <mrow><mi> &forall; </mi><mi>w</mi><mo> &isin; </mo>
        <mstyle mathvariant='script'><mi>H</mi>
        </mstyle>
       </mrow>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow>
        <mstyle mathvariant='normal'><mi>E</mi>
        </mstyle>
       </mrow>
       <mrow>
        <mrow><mi>z</mi><mo> &sim; </mo><mi>g</mi>
        </mrow>
       </mrow>
      </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi> &ell; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow><mi>w</mi><mo>,</mo><mi>z</mi>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>(1.1)
   </mtd>
  </mtr>
 </mtable></math></div>
</div>

<div class="standard" id='magicparlabel-43'><br />

</div>

<div class="remark" id='magicparlabel-44'><div class="remark_item"><span class="remark_label">Remark 2.</span>
<a id="rem_Gradient_descent__GD_" />
Gradient descent (GD) cannot be directly utilized to address Problem <a href="#prob_Consider_a_learning">1</a> (i.e., minimize the Risk function) because <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>g</mi>
 </mrow></math> is unknown, and because <a href="#eq_rfminproblem">(1.1)</a> involves an integral which may be computationally intractable. Instead it aims to minimize the ERF <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mover>
    <mrow><mi>R</mi>
    </mrow><mo stretchy="true">&circ;</mo>
   </mover><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
   <mfrac>
    <mrow><mn>1</mn>
    </mrow>
    <mrow><mi>n</mi>
    </mrow>
   </mfrac>
   <msubsup>
    <mrow><mo> &sum; </mo>
    </mrow>
    <mrow>
     <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
     </mrow>
    </mrow>
    <mrow><mi>n</mi>
    </mrow>
   </msubsup><mi> &ell; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>w</mi><mo>,</mo>
    <msub>
     <mrow><mi>z</mi>
     </mrow>
     <mrow><mi>i</mi>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> which ideally is used as a proxy when data size <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>n</mi>
 </mrow></math> is big (big-data). </div>
</div>

<div class="standard" id='magicparlabel-45'><br />

</div>

<div class="remark" id='magicparlabel-46'><div class="remark_item"><span class="remark_label">Remark 3.</span>
<a id="rem_The_implementation_of" />
The implementation of GD may be computationally impractical even in problems where we need to minimize an ERF <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow>
     <mover>
      <mrow><mi>R</mi>
      </mrow><mo stretchy="true">&circ;</mo>
     </mover>
    </mrow>
    <mrow><mi>n</mi>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> if we have big data (<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>n</mi><mo> &ap; </mo>
  </mrow>
 </mrow></math>big). This is because GD requires the recursive computation of the exact gradient <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &nabla; </mi>
   <msub>
    <mrow>
     <mover>
      <mrow><mi>R</mi>
      </mrow><mo stretchy="true">&circ;</mo>
     </mover>
    </mrow>
    <mrow><mi>n</mi>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
   <mfrac>
    <mrow><mn>1</mn>
    </mrow>
    <mrow><mi>n</mi>
    </mrow>
   </mfrac>
   <msubsup>
    <mrow><mo> &sum; </mo>
    </mrow>
    <mrow>
     <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
     </mrow>
    </mrow>
    <mrow><mi>n</mi>
    </mrow>
   </msubsup><mi> &nabla; </mi><mi> &ell; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>w</mi><mo>,</mo>
    <msub>
     <mrow><mi>z</mi>
     </mrow>
     <mrow><mi>i</mi>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> using all the data <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

  <msub>
   <mrow><mi>z</mi>
   </mrow>
   <mrow><mi>i</mi>
   </mrow>
  </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

 </mrow></math> at each iteration. That may be too slow.</div>
</div>

<div class="standard" id='magicparlabel-59'><br />

</div>

<div class="remark" id='magicparlabel-60'><div class="remark_item"><span class="remark_label">Remark 4.</span>
Stochastic gradient descent (SGD) aims at solving <a href="#eq_rfminproblem">(1.1)</a>, and overcoming the issues in Remarks <a href="#rem_Gradient_descent__GD_">2</a> &amp; <a href="#rem_The_implementation_of">3</a> by using an unbiased estimator of the actual gradient (or some sub-gradient) based on a sample properly drawn from <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>g</mi>
 </mrow></math>.</div>
</div>

<div class="standard" id='magicparlabel-61'><br />

</div>
<h2 class="section" id='magicparlabel-62'><span class="section_label">2</span> Stochastic gradient descent</h2>
<h3 class="subsection" id='magicparlabel-63'><span class="subsection_label">2.1</span> Description</h3>

<div class="notation" id='magicparlabel-64'><div class="notation_item"><span class="notation_label">Notation 5.</span>
<a id="nota_For_the_sake" />
For the sake of notation simplicity and generalization, we present Stochastic Gradient Descent (SGD) in the following minimization problem<a id="eq_gvbzvcb_1" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mo>*</mo>
      </mrow>
     </msup><mo>=</mo><mo> arg </mo>
     <msub>
      <mrow><mo> min </mo>
      </mrow>
      <mrow>
       <mrow><mi> &forall; </mi><mi>w</mi><mo> &isin; </mo>
        <mstyle mathvariant='script'><mi>H</mi>
        </mstyle>
       </mrow>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>(2.1)
   </mtd>
  </mtr>
 </mtable></math> where here <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>f</mi><mo>:</mo>
   <msup>
    <mrow>
     <mstyle mathvariant='double-struck'><mi>R</mi>
     </mstyle>
    </mrow>
    <mrow><mi>d</mi>
    </mrow>
   </msup><mo> &rarr; </mo>
   <mstyle mathvariant='double-struck'><mi>R</mi>
   </mstyle>
  </mrow>
 </mrow></math> , and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>w</mi><mo> &isin; </mo>
   <mstyle mathvariant='script'><mi>H</mi>
   </mstyle><mo> &sube; </mo>
   <msup>
    <mrow>
     <mstyle mathvariant='double-struck'><mi>R</mi>
     </mstyle>
    </mrow>
    <mrow><mi>d</mi>
    </mrow>
   </msup>
  </mrow>
 </mrow></math>; <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mo> &sdot; </mo>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> is the unknown function to be minimized, e.g., <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mo> &sdot; </mo>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> can be the risk function <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>R</mi>
    </mrow>
    <mrow><mi>g</mi>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
   <msub>
    <mrow>
     <mstyle mathvariant='normal'><mi>E</mi>
     </mstyle>
    </mrow>
    <mrow>
     <mrow><mi>z</mi><mo> &sim; </mo><mi>g</mi>
     </mrow>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &ell; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow><mi>w</mi><mo>,</mo><mi>z</mi>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>.</div>
</div>

<div class="standard" id='magicparlabel-65'><br />

</div>


<div class="standard" id='magicparlabel-66'><div class='Boxed'><div class="algorithm" id='magicparlabel-70'><div class="algorithm_item"><span class="algorithm_label">Algorithm 6.</span>
<a id="alg_Stochastic_Gradient_descent" />
 Stochastic Gradient Descent (SGD) with learning rate <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo>&gt;</mo><mn>0</mn>
  </mrow>
 </mrow></math> for the solution of the minimization problem <a href="#eq_gvbzvcb">eq:gvbzvcb</a> </div>
<div class="algorithm_item"><hr />

</div>
<div class="plain_layout" id='magicparlabel-76'><i>For <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>t</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>...</mn>
  </mrow>
 </mrow></math> iterate:</i></div>

<ol class="enumerate" id='magicparlabel-77'><li class="enumerate" style='text-align: left;'><i><a id="enu_compute__where" />
compute <a id="eq_GD_UPDATE_MECHANISM" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow><mi>t</mi><mo>+</mo><mn>1</mn>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup><mo>=</mo>
     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup><mo>-</mo>
     <msub>
      <mrow><mi> &eta; </mi>
      </mrow>
      <mrow><mi>t</mi>
      </mrow>
     </msub>
     <msub>
      <mrow><mi>v</mi>
      </mrow>
      <mrow><mi>t</mi>
      </mrow>
     </msub><mo>,</mo>
    </mrow>
   </mtd>
   <mtd>(2.2)
   </mtd>
  </mtr>
 </mtable></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>v</mi>
   </mrow>
   <mrow><mi>t</mi>
   </mrow>
  </msub>
 </mrow></math> is a random vector such that <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mstyle mathvariant='normal'><mi>E</mi>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>v</mi>
     </mrow>
     <mrow><mi>t</mi>
     </mrow>
    </msub><mo>|</mo>
    <msup>
     <mrow><mi>w</mi>
     </mrow>
     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </msup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &isin; </mo><mi> &part; </mi><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <msup>
    <mrow><mi>w</mi>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math></i></li>
<li class="enumerate_item"><i><a id="enu_terminate_if_2" />
terminate if a termination criterion is satisfied, e.g.<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mstyle mathvariant='normal'>
    <mrow><mi>I</mi><mi>f</mi>
    </mrow>
   </mstyle><mspace width="6px" /><mspace width="6px" /><mspace width="6px" /><mi>t</mi><mo> &ge; </mo><mi>T</mi><mspace width="6px" /><mspace width="6px" /><mspace width="6px" />
   <mstyle mathvariant='normal'>
    <mrow><mi>t</mi><mi>h</mi><mi>e</mi><mi>n</mi>
    </mrow>
   </mstyle><mspace width="6px" /><mspace width="6px" /><mspace width="6px" />
   <mstyle mathvariant='normal'>
    <mrow><mi>S</mi><mi>T</mi><mi>O</mi><mi>P</mi>
    </mrow>
   </mstyle>
  </mrow>
 </mrow></math></i></li>
</ol>
</div>
</div>
<br />

</div>

<div class="remark" id='magicparlabel-79'><div class="remark_item"><span class="remark_label">Remark 7.</span>
If <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>f</mi>
 </mrow></math> is differentiable at <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup>
   <mrow><mi>w</mi>
   </mrow>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
  </msup>
 </mrow></math>, it is <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &part; </mi><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <msup>
    <mrow><mi>w</mi>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

   <mrow><mi> &nabla; </mi><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <msup>
     <mrow><mi>w</mi>
     </mrow>
     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

  </mrow>
 </mrow></math>. Hence <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>v</mi>
   </mrow>
   <mrow><mi>t</mi>
   </mrow>
  </msub>
 </mrow></math> is such as <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mstyle mathvariant='normal'><mi>E</mi>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>v</mi>
     </mrow>
     <mrow><mi>t</mi>
     </mrow>
    </msub><mo>|</mo>
    <msup>
     <mrow><mi>w</mi>
     </mrow>
     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </msup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mi> &nabla; </mi><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <msup>
    <mrow><mi>w</mi>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> in Algorithm <a href="#alg_Stochastic_Gradient_descent">6</a> step <a href="#enu_compute__where">1.</a>. </div>
</div>

<div class="standard" id='magicparlabel-80'><br />

</div>

<div class="note" id='magicparlabel-81'><div class="note_item"><span class="note_label">Note 8.</span>
Assume <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>f</mi>
 </mrow></math> is differentiable (for simplicity). To compare SGD with GD, we can re-write <a href="#eq_GD_UPDATE_MECHANISM">(2.2)</a> in the SGD Algorithm <a href="#alg_Stochastic_Gradient_descent">6</a> as<a id="eq_GD_UPDATE_MECHANISM_1" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow><mi>t</mi><mo>+</mo><mn>1</mn>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup><mo>=</mo>
     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup><mo>-</mo>
     <msub>
      <mrow><mi> &eta; </mi>
      </mrow>
      <mrow><mi>t</mi>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

     <mrow><mi> &nabla; </mi><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <msup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo>
      <msub>
       <mrow><mi> &xi; </mi>
       </mrow>
       <mrow><mi>t</mi>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>
<mo>,</mo>
    </mrow>
   </mtd>
   <mtd>(2.3)
   </mtd>
  </mtr>
 </mtable></math> where <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &xi; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo>:</mo><mo>=</mo>
   <msub>
    <mrow><mi>v</mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo>-</mo><mi> &nabla; </mi><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <msup>
    <mrow><mi>w</mi>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> represents the (observed) noise introduced in <a href="#eq_GD_UPDATE_MECHANISM">(2.2)</a> by using a random realization of the exact gradient.</div>
</div>

<div class="standard" id='magicparlabel-82'><br />

</div>

<div class="remark" id='magicparlabel-83'><div class="remark_item"><span class="remark_label">Remark 9.</span>
Given <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>T</mi>
 </mrow></math> SGD algorithm iterations, the output of SGD can be (but not a exclusively)</div>

<ol class="enumerate" id='magicparlabel-84'><li class="enumerate_item">the average (after discarding the first few iterations of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup>
   <mrow><mi>w</mi>
   </mrow>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
  </msup>
 </mrow></math> for stability reasons)<a id="eq_fghsgh" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <msubsup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow>
       <mstyle mathvariant='normal'>
        <mrow><mi>S</mi><mi>G</mi><mi>D</mi>
        </mrow>
       </mstyle>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>T</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msubsup><mo>=</mo>
     <mfrac>
      <mrow><mn>1</mn>
      </mrow>
      <mrow><mi>T</mi>
      </mrow>
     </mfrac>
     <msubsup>
      <mrow><mo> &sum; </mo>
      </mrow>
      <mrow>
       <mrow><mi>t</mi><mo>=</mo><mn>1</mn>
       </mrow>
      </mrow>
      <mrow><mi>T</mi>
      </mrow>
     </msubsup>
     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup>
    </mrow>
   </mtd>
   <mtd>(2.4)
   </mtd>
  </mtr>
 </mtable></math></li>
<li class="enumerate_item">or the best value discovered<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msubsup>
    <mrow><mi>w</mi>
    </mrow>
    <mrow>
     <mstyle mathvariant='normal'>
      <mrow><mi>S</mi><mi>G</mi><mi>D</mi>
      </mrow>
     </mstyle>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>T</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msubsup><mo>=</mo><mo> arg </mo>
   <msub>
    <mrow><mo> min </mo>
    </mrow>
    <mrow>
     <mrow><mi> &forall; </mi>
      <msub>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mi>t</mi>
       </mrow>
      </msub>
     </mrow>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <msup>
     <mrow><mi>w</mi>
     </mrow>
     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> </li>
<li class="enumerate_item">or the last value discovered <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msubsup>
    <mrow><mi>w</mi>
    </mrow>
    <mrow>
     <mstyle mathvariant='normal'>
      <mrow><mi>S</mi><mi>G</mi><mi>D</mi>
      </mrow>
     </mstyle>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>T</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msubsup><mo>=</mo>
   <msup>
    <mrow><mi>w</mi>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>T</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup>
  </mrow>
 </mrow></math></li>
</ol>
</div>

<div class="standard" id='magicparlabel-87'><br />

</div>

<div class="note" id='magicparlabel-88'><div class="note_item"><span class="note_label">Note 10.</span>
SGD output converges to a local minimum, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msubsup>
    <mrow><mi>w</mi>
    </mrow>
    <mrow>
     <mstyle mathvariant='normal'>
      <mrow><mi>S</mi><mi>G</mi><mi>D</mi>
      </mrow>
     </mstyle>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>T</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msubsup><mo> &rarr; </mo>
   <msub>
    <mrow><mi>w</mi>
    </mrow>
    <mrow><mo>*</mo>
    </mrow>
   </msub>
  </mrow>
 </mrow></math> (in some sense), under different sets of regularity conditions. Section <a href="#subsec_Analysis">4</a> has a brief analysis. To achieve this, Conditions <a href="#rem_For_the_SGD">11</a> on the learning rate are rather inevitable and should be satisfied. </div>
</div>

<div class="standard" id='magicparlabel-89'><br />

</div>

<div class="condition" id='magicparlabel-90'><div class="condition_item"><span class="condition_label">Condition 11.</span>
<a id="rem_For_the_SGD" />
Regarding the learning rate (or gain) <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

  <msub>
   <mrow><mi> &eta; </mi>
   </mrow>
   <mrow><mi>t</mi>
   </mrow>
  </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

 </mrow></math> should satisfy conditions </div>

<ol class="enumerate" id='magicparlabel-91'><li class="enumerate_item"><a id="enu__" />
<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo> &ge; </mo><mn>0</mn>
  </mrow>
 </mrow></math>, </li>
<li class="enumerate_item"><a id="enu_" />
<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msubsup>
    <mrow><mo> &sum; </mo>
    </mrow>
    <mrow>
     <mrow><mi>t</mi><mo>=</mo><mn>1</mn>
     </mrow>
    </mrow>
    <mrow><mi> &infin; </mi>
    </mrow>
   </msubsup>
   <msub>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo>=</mo><mi> &infin; </mi>
  </mrow>
 </mrow></math></li>
<li class="enumerate_item"><a id="enu__1" />
<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msubsup>
    <mrow><mo> &sum; </mo>
    </mrow>
    <mrow>
     <mrow><mi>t</mi><mo>=</mo><mn>1</mn>
     </mrow>
    </mrow>
    <mrow><mi> &infin; </mi>
    </mrow>
   </msubsup>
   <msubsup>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msubsup><mo>&lt;</mo><mi> &infin; </mi>
  </mrow>
 </mrow></math></li>
</ol>
</div>

<div class="standard" id='magicparlabel-94'><br />

</div>

<div class="remark" id='magicparlabel-95'><div class="remark_item"><span class="remark_label">Remark 12.</span>
The popular learning rates <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

  <msub>
   <mrow><mi> &eta; </mi>
   </mrow>
   <mrow><mi>t</mi>
   </mrow>
  </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

 </mrow></math> in Remark <a href="#rem_The_parameter_">rem:The-parameter-</a> in Handout 2 satisfy Condition <a href="#rem_For_the_SGD">11</a> and hence can be used in SGD too. Once parametrized, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &eta; </mi>
   </mrow>
   <mrow><mi>t</mi>
   </mrow>
  </msub>
 </mrow></math> can be tuned based on pilot runs using a reasonably small number of data.</div>
</div>

<div class="standard" id='magicparlabel-96'><br />

</div>

<div class="remark" id='magicparlabel-97'><div class="remark_item"><span class="remark_label">Remark 13.</span>
Intuition on Condition <a href="#rem_For_the_SGD">11</a>. Assume that <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>v</mi>
   </mrow>
   <mrow><mi>t</mi>
   </mrow>
  </msub>
 </mrow></math> is bounded. Condition <a href="#rem_For_the_SGD">11</a><a href="#enu__1">(3.)</a> aims at reducing the effect of the randomness in <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>v</mi>
   </mrow>
   <mrow><mi>t</mi>
   </mrow>
  </msub>
 </mrow></math> (introduced noise <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &xi; </mi>
   </mrow>
   <mrow><mi>t</mi>
   </mrow>
  </msub>
 </mrow></math>) because it implies <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo> ssearrow </mo><mn>0</mn>
  </mrow>
 </mrow></math> as <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>t</mi><mo> &rarr; </mo><mi> &infin; </mi>
  </mrow>
 </mrow></math>; if this was not the case then <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msup>
    <mrow><mi>w</mi>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>t</mi><mo>+</mo><mn>1</mn>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup><mo>-</mo>
   <msup>
    <mrow><mi>w</mi>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup><mo>=</mo><mo>-</mo>
   <msub>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub>
   <msub>
    <mrow><mi>v</mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo> &rarr; </mo><mn>0</mn>
  </mrow>
 </mrow></math>may not be satisfied and the chain <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

  <msup>
   <mrow><mi>w</mi>
   </mrow>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
  </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

 </mrow></math> may not converge. Condition <a href="#rem_For_the_SGD">11</a>(<a href="#enu_">2.</a>) prevents <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &eta; </mi>
   </mrow>
   <mrow><mi>t</mi>
   </mrow>
  </msub>
 </mrow></math> from reducing too fast and allows the generated chain <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

  <msup>
   <mrow><mi>w</mi>
   </mrow>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
  </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

 </mrow></math> to be able to converge. E.g.,  after <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>t</mi>
 </mrow></math> iterations <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd><mo form='prefix' fence='true' stretchy='true' symmetric='true'>&par;</mo>

    <mrow>
     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup><mo>-</mo>
     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mo>*</mo>
      </mrow>
     </msup>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&par;</mo>

   </mtd>
   <mtd>
    <mrow><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>&par;</mo>

     <mrow>
      <msup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup><mo> &plusmn; </mo>
      <msup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mn>0</mn>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup><mo>-</mo>
      <msup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mo>*</mo>
       </mrow>
      </msup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&par;</mo>
<mo> &ge; </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>&par;</mo>

     <mrow>
      <msup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mn>0</mn>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup><mo>-</mo>
      <msup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mo>*</mo>
       </mrow>
      </msup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&par;</mo>
<mo>-</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>&par;</mo>

     <mrow>
      <msup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup><mo>-</mo>
      <msup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mn>0</mn>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&par;</mo>

    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd><mrow/>
   </mtd>
   <mtd>
    <mrow><mo> &ge; </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>&par;</mo>

     <mrow>
      <msup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mn>0</mn>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup><mo>-</mo>
      <msup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mo>*</mo>
       </mrow>
      </msup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&par;</mo>
<mo>-</mo>
     <msubsup>
      <mrow><mo> &sum; </mo>
      </mrow>
      <mrow>
       <mrow><mi>t</mi><mo>=</mo><mn>0</mn>
       </mrow>
      </mrow>
      <mrow><mi> &infin; </mi>
      </mrow>
     </msubsup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>&par;</mo>

     <mrow>
      <msup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>t</mi><mo>+</mo><mn>1</mn>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup><mo>-</mo>
      <msup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&par;</mo>
<mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>&par;</mo>

     <mrow>
      <msup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mn>0</mn>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup><mo>-</mo>
      <msup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mo>*</mo>
       </mrow>
      </msup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&par;</mo>
<mo>-</mo>
     <msubsup>
      <mrow><mo> &sum; </mo>
      </mrow>
      <mrow>
       <mrow><mi>t</mi><mo>=</mo><mn>0</mn>
       </mrow>
      </mrow>
      <mrow>
       <mrow><mi>T</mi><mo>-</mo><mn>1</mn>
       </mrow>
      </mrow>
     </msubsup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>&par;</mo>

     <mrow>
      <msub>
       <mrow><mi> &eta; </mi>
       </mrow>
       <mrow><mi>t</mi>
       </mrow>
      </msub>
      <msub>
       <mrow><mi>v</mi>
       </mrow>
       <mrow><mi>t</mi>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&par;</mo>

    </mrow>
   </mtd>
  </mtr>
 </mtable></math> However if it was <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msubsup>
    <mrow><mo> &sum; </mo>
    </mrow>
    <mrow>
     <mrow><mi>t</mi><mo>=</mo><mn>1</mn>
     </mrow>
    </mrow>
    <mrow><mi> &infin; </mi>
    </mrow>
   </msubsup>
   <msub>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo>&lt;</mo><mi> &infin; </mi>
  </mrow>
 </mrow></math> it would be <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msubsup>
    <mrow><mo> &sum; </mo>
    </mrow>
    <mrow>
     <mrow><mi>t</mi><mo>=</mo><mn>0</mn>
     </mrow>
    </mrow>
    <mrow><mi> &infin; </mi>
    </mrow>
   </msubsup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>&par;</mo>

   <mrow>
    <msub>
     <mrow><mi> &eta; </mi>
     </mrow>
     <mrow><mi>t</mi>
     </mrow>
    </msub>
    <msub>
     <mrow><mi>v</mi>
     </mrow>
     <mrow><mi>t</mi>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&par;</mo>
<mo>&lt;</mo><mi> &infin; </mi>
  </mrow>
 </mrow></math> and hence <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup>
   <mrow><mi>w</mi>
   </mrow>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
  </msup>
 </mrow></math> would never converge to <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup>
   <mrow><mi>w</mi>
   </mrow>
   <mrow><mo>*</mo>
   </mrow>
  </msup>
 </mrow></math> if the seed <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup>
   <mrow><mi>w</mi>
   </mrow>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mn>0</mn>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
  </msup>
 </mrow></math> is far enough from <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup>
   <mrow><mi>w</mi>
   </mrow>
   <mrow><mo>*</mo>
   </mrow>
  </msup>
 </mrow></math>.</div>
</div>
<h2 class="section" id='magicparlabel-107'><span class="section_label">3</span> Stochastic gradient descent with projection</h2>

<div class="remark" id='magicparlabel-108'><div class="remark_item"><span class="remark_label">Remark 14.</span>
Consider the scenario in Problem <a href="#prob_Consider_a_learning">1</a> where the learning problem requires to discover <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup>
   <mrow><mi>w</mi>
   </mrow>
   <mrow><mo>*</mo>
   </mrow>
  </msup>
 </mrow></math> in the restricted/bounded set <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='script'><mi>H</mi>
  </mstyle>
 </mrow></math>. Assume the function to be minimized is convex in the restricted hypothesis set <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='script'><mi>H</mi>
  </mstyle>
 </mrow></math>, e.g. <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mstyle mathvariant='script'><mi>H</mi>
   </mstyle><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

   <mrow><mi>w</mi><mo>:</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>&par;</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&par;</mo>
<mo> &le; </mo><mi>B</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

  </mrow>
 </mrow></math>, but non-convex in <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup>
   <mrow>
    <mstyle mathvariant='double-struck'><mi>R</mi>
    </mstyle>
   </mrow>
   <mrow><mi>d</mi>
   </mrow>
  </msup>
 </mrow></math>. Direct implementation of vanilla SGD (Algorithm <a href="#alg_Stochastic_Gradient_descent">6</a>) may produce a chain stepping out <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='script'><mi>H</mi>
  </mstyle>
 </mrow></math> and hence an output <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>w</mi>
    </mrow>
    <mrow>
     <mstyle mathvariant='normal'>
      <mrow><mi>S</mi><mi>G</mi><mi>D</mi>
      </mrow>
     </mstyle>
    </mrow>
   </msub>
   <mrow><mo> / </mo>
   </mrow><mo> &isin; </mo>
   <mstyle mathvariant='script'><mi>H</mi>
   </mstyle>
  </mrow>
 </mrow></math>. SGD can be modified to address this issue, as in Algorithm <a href="#alg_Stochastic_Gradient_descent_1">15</a>, by including a projection step guarantying <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>w</mi><mo> &isin; </mo>
   <mstyle mathvariant='script'><mi>H</mi>
   </mstyle>
  </mrow>
 </mrow></math>.</div>
</div>

<div class="standard" id='magicparlabel-109'><br />

</div>


<div class="standard" id='magicparlabel-110'><div class='Boxed'><div class="algorithm" id='magicparlabel-114'><div class="algorithm_item"><span class="algorithm_label">Algorithm 15.</span>
<a id="alg_Stochastic_Gradient_descent_1" />
 Stochastic Gradient Descent with learning rate <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo>&gt;</mo><mn>0</mn>
  </mrow>
 </mrow></math> and with projection in <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='script'><mi>H</mi>
  </mstyle>
 </mrow></math> for problem in <a href="#eq_gvbzvcb">eq:gvbzvcb</a> </div>
<div class="algorithm_item"><hr />

</div>
<div class="plain_layout" id='magicparlabel-120'><i>For <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>t</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>...</mn>
  </mrow>
 </mrow></math> iterate:</i></div>

<ol class="enumerate" id='magicparlabel-121'><li class="enumerate" style='text-align: left;'><i><a id="enu_compute__where_1" />
compute <a id="eq_GD_UPDATE_MECHANISM_3" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow><mi>t</mi><mo>+</mo>
        <mfrac>
         <mrow><mn>1</mn>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </mfrac>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup><mo>=</mo>
     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup><mo>-</mo>
     <msub>
      <mrow><mi> &eta; </mi>
      </mrow>
      <mrow><mi>t</mi>
      </mrow>
     </msub>
     <msub>
      <mrow><mi>v</mi>
      </mrow>
      <mrow><mi>t</mi>
      </mrow>
     </msub><mo>,</mo>
    </mrow>
   </mtd>
   <mtd>(3.1)
   </mtd>
  </mtr>
 </mtable></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>v</mi>
   </mrow>
   <mrow><mi>t</mi>
   </mrow>
  </msub>
 </mrow></math> is a random vector such that <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mstyle mathvariant='normal'><mi>E</mi>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>v</mi>
     </mrow>
     <mrow><mi>t</mi>
     </mrow>
    </msub><mo>|</mo>
    <msup>
     <mrow><mi>w</mi>
     </mrow>
     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </msup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &isin; </mo><mi> &part; </mi><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <msup>
    <mrow><mi>w</mi>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math></i></li>
<li class="enumerate_item"><i>compute <a id="eq_GD_UPDATE_MECHANISM_3_1" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow><mi>t</mi><mo>+</mo><mn>1</mn>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup><mo>=</mo><mo> arg </mo>
     <msub>
      <mrow><mo> min </mo>
      </mrow>
      <mrow>
       <mrow><mi>w</mi><mo> &isin; </mo>
        <mstyle mathvariant='script'><mi>H</mi>
        </mstyle>
       </mrow>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mo form='prefix' fence='true' stretchy='true' symmetric='true'>&par;</mo>

     <mrow><mi>w</mi><mo>-</mo>
      <msup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>t</mi><mo>+</mo>
         <mfrac>
          <mrow><mn>1</mn>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </mfrac>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&par;</mo>

<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>(3.2)
   </mtd>
  </mtr>
 </mtable></math></i></li>
<li class="enumerate_item"><i><a id="enu_terminate_if_2_1" />
terminate if a termination criterion is satisfied</i></li>
</ol>
</div>
</div>
<br />

</div>
<h2 class="section" id='magicparlabel-128'><span class="section_label">4</span> <a id="subsec_Analysis" />
Analysis of SGD (Algorithm <a href="#alg_Stochastic_Gradient_descent">6</a>)</h2>

<div class="standard" id='magicparlabel-129'><br />

</div>

<div class="note" id='magicparlabel-130'><div class="note_item"><span class="note_label">Note 16.</span>
Recall that the stochasticity of SGD comes from the stochastic sub-gradients <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

    <msub>
     <mrow><mi>v</mi>
     </mrow>
     <mrow><mi>t</mi>
     </mrow>
    </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

   </mrow>
   <mrow>
    <mrow><mi> &forall; </mi><mi>t</mi>
    </mrow>
   </mrow>
  </msub>
 </mrow></math>; hence the expectations below are under these random vectors' distributions.</div>
</div>

<div class="theorem" id='magicparlabel-131'><div class="theorem_item"><span class="theorem_label">Theorem 17.</span>
<a id="thm_Let__be" />
Let <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mo> &sdot; </mo>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> be a convex and Lipschitz function.  If we run SGD algorithm of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>f</mi>
 </mrow></math> with learning rate <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo>&gt;</mo><mn>0</mn>
  </mrow>
 </mrow></math> for <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>T</mi>
 </mrow></math> steps, the output <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msubsup>
    <mrow><mi>w</mi>
    </mrow>
    <mrow>
     <mstyle mathvariant='normal'>
      <mrow><mi>G</mi><mi>D</mi>
      </mrow>
     </mstyle>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>T</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msubsup><mo>=</mo>
   <mfrac>
    <mrow><mn>1</mn>
    </mrow>
    <mrow><mi>T</mi>
    </mrow>
   </mfrac>
   <msubsup>
    <mrow><mo> &sum; </mo>
    </mrow>
    <mrow>
     <mrow><mi>t</mi><mo>=</mo><mn>1</mn>
     </mrow>
    </mrow>
    <mrow><mi>T</mi>
    </mrow>
   </msubsup>
   <msup>
    <mrow><mi>w</mi>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup>
  </mrow>
 </mrow></math> satisfies <a id="eq_sgd_upper_bound" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mstyle mathvariant='normal'><mi>E</mi>
     </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <msubsup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow>
        <mstyle mathvariant='normal'>
         <mrow><mi>G</mi><mi>D</mi>
         </mrow>
        </mstyle>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>T</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msubsup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>-</mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mo>*</mo>
      </mrow>
     </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &le; </mo>
     <mfrac>
      <mrow>
       <msup>
        <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>&par;</mo>

         <msup>
          <mrow><mi>w</mi>
          </mrow>
          <mrow><mo>*</mo>
          </mrow>
         </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&par;</mo>

        </mrow>
        <mrow><mn>2</mn>
        </mrow>
       </msup>
      </mrow>
      <mrow>
       <mrow><mn>2</mn><mi> &eta; </mi>
       </mrow>
      </mrow>
     </mfrac><mo>+</mo>
     <mfrac>
      <mrow><mi> &eta; </mi>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </mfrac>
     <msubsup>
      <mrow><mo> &sum; </mo>
      </mrow>
      <mrow>
       <mrow><mi>t</mi><mo>=</mo><mn>1</mn>
       </mrow>
      </mrow>
      <mrow><mi>T</mi>
      </mrow>
     </msubsup>
     <mstyle mathvariant='normal'><mi>E</mi>
     </mstyle>
     <msup>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>&par;</mo>

       <msub>
        <mrow><mi>v</mi>
        </mrow>
        <mrow><mi>t</mi>
        </mrow>
       </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&par;</mo>

      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msup>
    </mrow>
   </mtd>
   <mtd>(4.1)
   </mtd>
  </mtr>
 </mtable></math></div>

<div class="proof" id='magicparlabel-144'><div class="proof_item"><span class="proof_label">Proof.</span>
Let <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>v</mi>
    </mrow>
    <mrow>
     <mrow><mn>1</mn><mo>:</mo><mi>t</mi>
     </mrow>
    </mrow>
   </msub><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>v</mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
    </msub><mo>,</mo><mn>...</mn><mo>,</mo>
    <msub>
     <mrow><mi>v</mi>
     </mrow>
     <mrow><mi>t</mi>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>. By Jensens' inequality (or see <a href="#eq_SFGSDFSFSDF">eq:SFGSDFSFSDF</a> in Handout 2)<a id="eq_svbnhgjh" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mstyle mathvariant='normal'><mi>E</mi>
     </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <msubsup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow>
        <mstyle mathvariant='normal'>
         <mrow><mi>G</mi><mi>D</mi>
         </mrow>
        </mstyle>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>T</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msubsup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>-</mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <msup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mo>*</mo>
       </mrow>
      </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &le; </mo>
     <mstyle mathvariant='normal'><mi>E</mi>
     </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <mfrac>
       <mrow><mn>1</mn>
       </mrow>
       <mrow><mi>T</mi>
       </mrow>
      </mfrac>
      <msubsup>
       <mrow><mo> &sum; </mo>
       </mrow>
       <mrow>
        <mrow><mi>t</mi><mo>=</mo><mn>1</mn>
        </mrow>
       </mrow>
       <mrow><mi>T</mi>
       </mrow>
      </msubsup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <msup>
        <mrow><mi>w</mi>
        </mrow>
        <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>-</mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <msup>
        <mrow><mi>w</mi>
        </mrow>
        <mrow><mo>*</mo>
        </mrow>
       </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
     <mfrac>
      <mrow><mn>1</mn>
      </mrow>
      <mrow><mi>T</mi>
      </mrow>
     </mfrac>
     <msubsup>
      <mrow><mo> &sum; </mo>
      </mrow>
      <mrow>
       <mrow><mi>t</mi><mo>=</mo><mn>1</mn>
       </mrow>
      </mrow>
      <mrow><mi>T</mi>
      </mrow>
     </msubsup>
     <mstyle mathvariant='normal'><mi>E</mi>
     </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <msup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>-</mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <msup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mo>*</mo>
       </mrow>
      </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>(4.2)
   </mtd>
  </mtr>
 </mtable></math></div>
<div class="proof_item">I will try to use Lemma <a href="#lem_Let__be">lem:Let--be</a> from Handout 2, hence I need to show <a id="eq_dfggbgghgdrds" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mstyle mathvariant='normal'><mi>E</mi>
     </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <msup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>-</mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <msup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mo>*</mo>
       </mrow>
      </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &le; </mo>
     <mstyle mathvariant='normal'><mi>E</mi>
     </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mo> &lang; </mo>
      <msup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup><mo>-</mo>
      <msup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mo>*</mo>
       </mrow>
      </msup><mo>,</mo>
      <msub>
       <mrow><mi>v</mi>
       </mrow>
       <mrow><mi>t</mi>
       </mrow>
      </msub><mo> &rang; </mo>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>(4.3)
   </mtd>
  </mtr>
 </mtable></math>where the expectation is under <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>v</mi>
   </mrow>
   <mrow>
    <mrow><mn>1</mn><mo>:</mo><mi>T</mi>
    </mrow>
   </mrow>
  </msub>
 </mrow></math>. It is <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <msub>
      <mrow>
       <mstyle mathvariant='normal'><mi>E</mi>
       </mstyle>
      </mrow>
      <mrow>
       <msub>
        <mrow><mi>v</mi>
        </mrow>
        <mrow>
         <mrow><mn>1</mn><mo>:</mo><mi>T</mi>
         </mrow>
        </mrow>
       </msub>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mo> &lang; </mo>
      <msup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup><mo>-</mo>
      <msup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mo>*</mo>
       </mrow>
      </msup><mo>,</mo>
      <msub>
       <mrow><mi>v</mi>
       </mrow>
       <mrow><mi>t</mi>
       </mrow>
      </msub><mo> &rang; </mo>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
    </mrow>
   </mtd>
   <mtd>
    <mrow>
     <msub>
      <mrow>
       <mstyle mathvariant='normal'><mi>E</mi>
       </mstyle>
      </mrow>
      <mrow>
       <msub>
        <mrow><mi>v</mi>
        </mrow>
        <mrow>
         <mrow><mn>1</mn><mo>:</mo><mi>t</mi>
         </mrow>
        </mrow>
       </msub>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mo> &lang; </mo>
      <msup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup><mo>-</mo>
      <msup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mo>*</mo>
       </mrow>
      </msup><mo>,</mo>
      <msub>
       <mrow><mi>v</mi>
       </mrow>
       <mrow><mi>t</mi>
       </mrow>
      </msub><mo> &rang; </mo>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd><mrow/>
   </mtd>
  </mtr>
  <mtr>
   <mtd><mo>=</mo>
   </mtd>
   <mtd>
    <mrow>
     <msub>
      <mrow>
       <mstyle mathvariant='normal'><mi>E</mi>
       </mstyle>
      </mrow>
      <mrow>
       <msub>
        <mrow><mi>v</mi>
        </mrow>
        <mrow>
         <mrow><mn>1</mn><mo>:</mo><mi>t</mi><mo>-</mo><mn>1</mn>
         </mrow>
        </mrow>
       </msub>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow>
        <mstyle mathvariant='normal'><mi>E</mi>
        </mstyle>
       </mrow>
       <mrow>
        <msub>
         <mrow><mi>v</mi>
         </mrow>
         <mrow>
          <mrow><mn>1</mn><mo>:</mo><mi>t</mi>
          </mrow>
         </mrow>
        </msub>
       </mrow>
      </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mo> &lang; </mo>
       <msup>
        <mrow><mi>w</mi>
        </mrow>
        <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </msup><mo>-</mo>
       <msup>
        <mrow><mi>w</mi>
        </mrow>
        <mrow><mo>*</mo>
        </mrow>
       </msup><mo>,</mo>
       <msub>
        <mrow><mi>v</mi>
        </mrow>
        <mrow><mi>t</mi>
        </mrow>
       </msub><mo> &rang; </mo><mo>|</mo>
       <msub>
        <mrow><mi>v</mi>
        </mrow>
        <mrow>
         <mrow><mn>1</mn><mo>:</mo><mi>t</mi><mo>-</mo><mn>1</mn>
         </mrow>
        </mrow>
       </msub>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mspace width="6px" /><mspace width="6px" /><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mstyle mathvariant='normal'>
      <mrow>&nbsp;<mi>l</mi><mi>a</mi><mi>w</mi>&nbsp;<mi>o</mi><mi>f</mi>&nbsp;<mi>t</mi><mi>o</mi><mi>t</mi><mi>a</mi><mi>l</mi>&nbsp;<mi>e</mi><mi>x</mi><mi>p</mi><mi>e</mi><mi>c</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi>&nbsp;
      </mrow>
     </mstyle>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
  </mtr>
 </mtable></math> But <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup>
   <mrow><mi>w</mi>
   </mrow>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
  </msup>
 </mrow></math> is fully determined by <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>v</mi>
   </mrow>
   <mrow>
    <mrow><mn>1</mn><mo>:</mo><mi>t</mi><mo>-</mo><mn>1</mn>
    </mrow>
   </mrow>
  </msub>
 </mrow></math>, (see <a href="#eq_GD_UPDATE_MECHANISM">(2.2)</a>) so<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <msub>
      <mrow>
       <mstyle mathvariant='normal'><mi>E</mi>
       </mstyle>
      </mrow>
      <mrow>
       <msub>
        <mrow><mi>v</mi>
        </mrow>
        <mrow>
         <mrow><mn>1</mn><mo>:</mo><mi>t</mi><mo>-</mo><mn>1</mn>
         </mrow>
        </mrow>
       </msub>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow>
        <mstyle mathvariant='normal'><mi>E</mi>
        </mstyle>
       </mrow>
       <mrow>
        <msub>
         <mrow><mi>v</mi>
         </mrow>
         <mrow>
          <mrow><mn>1</mn><mo>:</mo><mi>t</mi>
          </mrow>
         </mrow>
        </msub>
       </mrow>
      </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mo> &lang; </mo>
       <msup>
        <mrow><mi>w</mi>
        </mrow>
        <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </msup><mo>-</mo>
       <msup>
        <mrow><mi>w</mi>
        </mrow>
        <mrow><mo>*</mo>
        </mrow>
       </msup><mo>,</mo>
       <msub>
        <mrow><mi>v</mi>
        </mrow>
        <mrow><mi>t</mi>
        </mrow>
       </msub><mo> &rang; </mo><mo>|</mo>
       <msub>
        <mrow><mi>v</mi>
        </mrow>
        <mrow>
         <mrow><mn>1</mn><mo>:</mo><mi>t</mi><mo>-</mo><mn>1</mn>
         </mrow>
        </mrow>
       </msub>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
    </mrow>
   </mtd>
   <mtd>
    <mrow>
     <msub>
      <mrow>
       <mstyle mathvariant='normal'><mi>E</mi>
       </mstyle>
      </mrow>
      <mrow>
       <msub>
        <mrow><mi>v</mi>
        </mrow>
        <mrow>
         <mrow><mn>1</mn><mo>:</mo><mi>t</mi><mo>-</mo><mn>1</mn>
         </mrow>
        </mrow>
       </msub>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mo> &lang; </mo>
      <msup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup><mo>-</mo>
      <msup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mo>*</mo>
       </mrow>
      </msup><mo>,</mo>
      <msub>
       <mrow>
        <mstyle mathvariant='normal'><mi>E</mi>
        </mstyle>
       </mrow>
       <mrow>
        <msub>
         <mrow><mi>v</mi>
         </mrow>
         <mrow>
          <mrow><mn>1</mn><mo>:</mo><mi>t</mi>
          </mrow>
         </mrow>
        </msub>
       </mrow>
      </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msub>
        <mrow><mi>v</mi>
        </mrow>
        <mrow><mi>t</mi>
        </mrow>
       </msub><mo>|</mo>
       <msub>
        <mrow><mi>v</mi>
        </mrow>
        <mrow>
         <mrow><mn>1</mn><mo>:</mo><mi>t</mi><mo>-</mo><mn>1</mn>
         </mrow>
        </mrow>
       </msub>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &rang; </mo>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
  </mtr>
 </mtable></math>As <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup>
   <mrow><mi>w</mi>
   </mrow>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
  </msup>
 </mrow></math> is fully determined by <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>v</mi>
   </mrow>
   <mrow>
    <mrow><mn>1</mn><mo>:</mo><mi>t</mi><mo>-</mo><mn>1</mn>
    </mrow>
   </mrow>
  </msub>
 </mrow></math> then <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow>
     <mstyle mathvariant='normal'><mi>E</mi>
     </mstyle>
    </mrow>
    <mrow>
     <msub>
      <mrow><mi>v</mi>
      </mrow>
      <mrow>
       <mrow><mn>1</mn><mo>:</mo><mi>t</mi>
       </mrow>
      </mrow>
     </msub>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>v</mi>
     </mrow>
     <mrow><mi>t</mi>
     </mrow>
    </msub><mo>|</mo>
    <msub>
     <mrow><mi>v</mi>
     </mrow>
     <mrow>
      <mrow><mn>1</mn><mo>:</mo><mi>t</mi><mo>-</mo><mn>1</mn>
      </mrow>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
   <msub>
    <mrow>
     <mstyle mathvariant='normal'><mi>E</mi>
     </mstyle>
    </mrow>
    <mrow>
     <msub>
      <mrow><mi>v</mi>
      </mrow>
      <mrow>
       <mrow><mn>1</mn><mo>:</mo><mi>t</mi>
       </mrow>
      </mrow>
     </msub>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>v</mi>
     </mrow>
     <mrow><mi>t</mi>
     </mrow>
    </msub><mo>|</mo>
    <msup>
     <mrow><mi>w</mi>
     </mrow>
     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </msup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &isin; </mo><mi> &part; </mi><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <msup>
    <mrow><mi>w</mi>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>, hence <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow>
     <mstyle mathvariant='normal'><mi>E</mi>
     </mstyle>
    </mrow>
    <mrow>
     <msub>
      <mrow><mi>v</mi>
      </mrow>
      <mrow>
       <mrow><mn>1</mn><mo>:</mo><mi>t</mi>
       </mrow>
      </mrow>
     </msub>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>v</mi>
     </mrow>
     <mrow><mi>t</mi>
     </mrow>
    </msub><mo>|</mo>
    <msub>
     <mrow><mi>v</mi>
     </mrow>
     <mrow>
      <mrow><mn>1</mn><mo>:</mo><mi>t</mi><mo>-</mo><mn>1</mn>
      </mrow>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> is a sub-gradient. By sub-gradient definition<a id="eq_xgsxfg" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <msub>
      <mrow>
       <mstyle mathvariant='normal'><mi>E</mi>
       </mstyle>
      </mrow>
      <mrow>
       <msub>
        <mrow><mi>v</mi>
        </mrow>
        <mrow>
         <mrow><mn>1</mn><mo>:</mo><mi>t</mi><mo>-</mo><mn>1</mn>
         </mrow>
        </mrow>
       </msub>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mo> &lang; </mo>
      <msup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup><mo>-</mo>
      <msup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mo>*</mo>
       </mrow>
      </msup><mo>,</mo>
      <msub>
       <mrow>
        <mstyle mathvariant='normal'><mi>E</mi>
        </mstyle>
       </mrow>
       <mrow>
        <msub>
         <mrow><mi>v</mi>
         </mrow>
         <mrow>
          <mrow><mn>1</mn><mo>:</mo><mi>t</mi>
          </mrow>
         </mrow>
        </msub>
       </mrow>
      </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msub>
        <mrow><mi>v</mi>
        </mrow>
        <mrow><mi>t</mi>
        </mrow>
       </msub><mo>|</mo>
       <msub>
        <mrow><mi>v</mi>
        </mrow>
        <mrow>
         <mrow><mn>1</mn><mo>:</mo><mi>t</mi><mo>-</mo><mn>1</mn>
         </mrow>
        </mrow>
       </msub>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &rang; </mo>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &ge; </mo>
    </mrow>
   </mtd>
   <mtd>
    <mrow>
     <msub>
      <mrow>
       <mstyle mathvariant='normal'><mi>E</mi>
       </mstyle>
      </mrow>
      <mrow>
       <msub>
        <mrow><mi>v</mi>
        </mrow>
        <mrow>
         <mrow><mn>1</mn><mo>:</mo><mi>t</mi><mo>-</mo><mn>1</mn>
         </mrow>
        </mrow>
       </msub>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <msup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>-</mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <msup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mo>*</mo>
       </mrow>
      </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
   </mtd>
  </mtr>
  <mtr>
   <mtd><mo>=</mo>
   </mtd>
   <mtd>
    <mrow>
     <msub>
      <mrow>
       <mstyle mathvariant='normal'><mi>E</mi>
       </mstyle>
      </mrow>
      <mrow>
       <msub>
        <mrow><mi>v</mi>
        </mrow>
        <mrow>
         <mrow><mn>1</mn><mo>:</mo><mi>T</mi>
         </mrow>
        </mrow>
       </msub>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <msup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>-</mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <msup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mo>*</mo>
       </mrow>
      </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>(4.4)
   </mtd>
  </mtr>
 </mtable></math> Hence combining <a href="#eq_xgsxfg">(4.4)</a>, <a href="#eq_dfggbgghgdrds">(4.3)</a>, and <a href="#eq_dfggbgghgdrds">(4.3)</a><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mstyle mathvariant='normal'><mi>E</mi>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <msubsup>
     <mrow><mi>w</mi>
     </mrow>
     <mrow>
      <mstyle mathvariant='normal'>
       <mrow><mi>G</mi><mi>D</mi>
       </mrow>
      </mstyle>
     </mrow>
     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>T</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </msubsup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>-</mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <msup>
     <mrow><mi>w</mi>
     </mrow>
     <mrow><mo>*</mo>
     </mrow>
    </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &le; </mo>
   <mfrac>
    <mrow><mn>1</mn>
    </mrow>
    <mrow><mi>T</mi>
    </mrow>
   </mfrac>
   <msubsup>
    <mrow><mo> &sum; </mo>
    </mrow>
    <mrow>
     <mrow><mi>t</mi><mo>=</mo><mn>1</mn>
     </mrow>
    </mrow>
    <mrow><mi>T</mi>
    </mrow>
   </msubsup>
   <mstyle mathvariant='normal'><mi>E</mi>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mo> &lang; </mo>
    <msup>
     <mrow><mi>w</mi>
     </mrow>
     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </msup><mo>-</mo>
    <msup>
     <mrow><mi>w</mi>
     </mrow>
     <mrow><mo>*</mo>
     </mrow>
    </msup><mo>,</mo>
    <msub>
     <mrow><mi>v</mi>
     </mrow>
     <mrow><mi>t</mi>
     </mrow>
    </msub><mo> &rang; </mo>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>Lemma <a href="#lem_Let__be">lem:Let--be</a> from Handout 2<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mstyle mathvariant='normal'><mi>E</mi>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <msubsup>
     <mrow><mi>w</mi>
     </mrow>
     <mrow>
      <mstyle mathvariant='normal'>
       <mrow><mi>G</mi><mi>D</mi>
       </mrow>
      </mstyle>
     </mrow>
     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>T</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </msubsup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>-</mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <msup>
     <mrow><mi>w</mi>
     </mrow>
     <mrow><mo>*</mo>
     </mrow>
    </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &le; </mo>
   <mfrac>
    <mrow>
     <mrow>
      <mstyle mathvariant='normal'><mi>E</mi>
      </mstyle>
      <msup>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>&par;</mo>

        <msup>
         <mrow><mi>w</mi>
         </mrow>
         <mrow><mo>*</mo>
         </mrow>
        </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&par;</mo>

       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msup>
     </mrow>
    </mrow>
    <mrow>
     <mrow><mn>2</mn><mi> &eta; </mi>
     </mrow>
    </mrow>
   </mfrac><mo>+</mo>
   <mfrac>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </mfrac>
   <msubsup>
    <mrow><mo> &sum; </mo>
    </mrow>
    <mrow>
     <mrow><mi>t</mi><mo>=</mo><mn>1</mn>
     </mrow>
    </mrow>
    <mrow><mi>T</mi>
    </mrow>
   </msubsup>
   <mstyle mathvariant='normal'><mi>E</mi>
   </mstyle>
   <msup>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>&par;</mo>

     <msub>
      <mrow><mi>v</mi>
      </mrow>
      <mrow><mi>t</mi>
      </mrow>
     </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&par;</mo>

    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msup>
  </mrow>
 </mrow></math></div>
</div>
</div>

<div class="standard" id='magicparlabel-146'><br />

</div>

<div class="remark" id='magicparlabel-147'><div class="remark_item"><span class="remark_label">Remark 18.</span>
<a id="rem_Note_that_the" />
The upper bound in <a href="#eq_sgd_upper_bound">(4.1)</a> depends on the variation of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>v</mi>
   </mrow>
   <mrow><mi>t</mi>
   </mrow>
  </msub>
 </mrow></math> as <a id="eq_" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mstyle mathvariant='normal'><mi>E</mi>
     </mstyle>
     <msup>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>&par;</mo>

       <msub>
        <mrow><mi>v</mi>
        </mrow>
        <mrow><mi>t</mi>
        </mrow>
       </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&par;</mo>

      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msup><mo>=</mo>
     <msubsup>
      <mrow><mo> &sum; </mo>
      </mrow>
      <mrow>
       <mrow><mi>j</mi><mo>=</mo><mn>1</mn>
       </mrow>
      </mrow>
      <mrow><mi>d</mi>
      </mrow>
     </msubsup>
     <mstyle mathvariant='normal'>
      <mrow><mi>V</mi><mi>a</mi><mi>r</mi>
      </mrow>
     </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <msub>
      <mrow><mi>v</mi>
      </mrow>
      <mrow>
       <mrow><mi>t</mi><mo>,</mo><mi>j</mi>
       </mrow>
      </mrow>
     </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo>
     <msubsup>
      <mrow><mo> &sum; </mo>
      </mrow>
      <mrow>
       <mrow><mi>j</mi><mo>=</mo><mn>1</mn>
       </mrow>
      </mrow>
      <mrow><mi>d</mi>
      </mrow>
     </msubsup>
     <msup>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow>
        <mstyle mathvariant='normal'><mi>E</mi>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <msub>
         <mrow><mi>v</mi>
         </mrow>
         <mrow>
          <mrow><mi>t</mi><mo>,</mo><mi>j</mi>
          </mrow>
         </mrow>
        </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msup>
    </mrow>
   </mtd>
   <mtd>(4.5)
   </mtd>
  </mtr>
 </mtable></math>  where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>d</mi>
 </mrow></math> is the dimension of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>v</mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>v</mi>
     </mrow>
     <mrow>
      <mrow><mi>t</mi><mo>,</mo><mn>1</mn>
      </mrow>
     </mrow>
    </msub><mo>,</mo><mn>...</mn><mo>,</mo>
    <msub>
     <mrow><mi>v</mi>
     </mrow>
     <mrow>
      <mrow><mi>t</mi><mo>,</mo><mi>d</mi>
      </mrow>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>. The second term on the right hand side of <a href="#eq_">(4.5)</a> is constant as <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>v</mi>
   </mrow>
   <mrow>
    <mrow><mi>t</mi><mo>,</mo><mi>j</mi>
    </mrow>
   </mrow>
  </msub>
 </mrow></math> is the unbiased estimator of the sub-gradient by construction.</div>
</div>

<div class="standard" id='magicparlabel-152'><br />

</div>

<div class="proposition" id='magicparlabel-153'><div class="proposition_item"><span class="proposition_label">Proposition 19.</span>
Let <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mo> &sdot; </mo>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> be a convex and Lipschitz function, and let <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mstyle mathvariant='script'><mi>H</mi>
   </mstyle><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

   <mrow><mi>w</mi><mo> &isin; </mo>
    <mstyle mathvariant='double-struck'><mi>R</mi>
    </mstyle><mo>:</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>&par;</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&par;</mo>
<mo> &le; </mo><mi>B</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

  </mrow>
 </mrow></math>. Assume we run SGD algorithm of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mo> &sdot; </mo>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> with learning rate <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo>=</mo>
   <msqrt>
    <mfrac>
     <mrow>
      <msup>
       <mrow><mi>B</mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msup>
     </mrow>
     <mrow>
      <mrow>
       <msup>
        <mrow><mi> &rho; </mi>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
       </msup><mi>T</mi>
      </mrow>
     </mrow>
    </mfrac>
   </msqrt>
  </mrow>
 </mrow></math> for <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>T</mi>
 </mrow></math> steps, and output <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msubsup>
    <mrow><mi>w</mi>
    </mrow>
    <mrow>
     <mstyle mathvariant='normal'>
      <mrow><mi>S</mi><mi>G</mi><mi>D</mi>
      </mrow>
     </mstyle>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>T</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msubsup><mo>=</mo>
   <mfrac>
    <mrow><mn>1</mn>
    </mrow>
    <mrow><mi>T</mi>
    </mrow>
   </mfrac>
   <msubsup>
    <mrow><mo> &sum; </mo>
    </mrow>
    <mrow>
     <mrow><mi>t</mi><mo>=</mo><mn>1</mn>
     </mrow>
    </mrow>
    <mrow><mi>T</mi>
    </mrow>
   </msubsup>
   <msup>
    <mrow><mi>w</mi>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup>
  </mrow>
 </mrow></math> <i>. Then</i></div>

<ol class="enumerate" id='magicparlabel-154'><li class="enumerate_item"><i><a id="enu_the_output_WEDSD" />
upper bound on the sub-optimality is </i><a id="eq_asfgasfgasdfDFSDF" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mstyle mathvariant='normal'><mi>E</mi>
     </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <msubsup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow>
        <mstyle mathvariant='normal'>
         <mrow><mi>S</mi><mi>G</mi><mi>D</mi>
         </mrow>
        </mstyle>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>T</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msubsup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>-</mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mo>*</mo>
      </mrow>
     </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &le; </mo>
     <mfrac>
      <mrow>
       <mrow><mi>B</mi><mi> &rho; </mi>
       </mrow>
      </mrow>
      <mrow>
       <msqrt><mi>T</mi>
       </msqrt>
      </mrow>
     </mfrac>
    </mrow>
   </mtd>
   <mtd>(4.6)
   </mtd>
  </mtr>
 </mtable></math></li>
<li class="enumerate_item"><i><a id="enu_a_given_levelDFGDSF" />
a given level off accuracy <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi> &epsiv; </mi>
 </mrow></math> such that <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mstyle mathvariant='normal'><mi>E</mi>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <msubsup>
     <mrow><mi>w</mi>
     </mrow>
     <mrow>
      <mstyle mathvariant='normal'>
       <mrow><mi>S</mi><mi>G</mi><mi>D</mi>
       </mrow>
      </mstyle>
     </mrow>
     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>T</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </msubsup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>-</mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <msup>
    <mrow><mi>w</mi>
    </mrow>
    <mrow><mo>*</mo>
    </mrow>
   </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &le; </mo><mi> &epsiv; </mi>
  </mrow>
 </mrow></math> can be achieved after <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>T</mi>
 </mrow></math>iterations <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>T</mi><mo> &ge; </mo>
   <mfrac>
    <mrow>
     <mrow>
      <msup>
       <mrow><mi>B</mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msup>
      <msup>
       <mrow><mi> &rho; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msup>
     </mrow>
    </mrow>
    <mrow>
     <msup>
      <mrow><mi> &epsiv; </mi>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msup>
    </mrow>
   </mfrac><mn>.</mn>
  </mrow>
 </mrow></math></i></li>
</ol>

<div class="proof" id='magicparlabel-156'><div class="proof_item"><span class="proof_label">Proof.</span>
It follows from <a href="#thm_Let__be">17</a>.</div>
</div>
</div>

<div class="standard" id='magicparlabel-157'><br />

</div>

<div class="remark" id='magicparlabel-158'><div class="remark_item"><span class="remark_label">Remark 20.</span>
Lemma <a href="#lem_Let__be">lem:Let--be</a> in Handout 2 holds even when projection steps are added in the vanilla SGD algorithm, hence the above analysis holds for the SGD with projections (Algorithm <a href="#alg_Stochastic_Gradient_descent_1">15</a>) too.</div>
</div>

<div class="standard" id='magicparlabel-159'><br />

</div>
<h2 class="section" id='magicparlabel-160'><span class="section_label">5</span> Implementation of SGD in the learning Problem <a href="#prob_Consider_a_learning">1</a></h2>

<div class="note" id='magicparlabel-161'><div class="note_item"><span class="note_label">Note 21.</span>
Below we show SGD can be implement in the learning Problem 1.</div>
</div>

<div class="standard" id='magicparlabel-162'><br />

</div>

<div class="proposition" id='magicparlabel-163'><div class="proposition_item"><span class="proposition_label">Proposition 22.</span>
For a randomly drawn <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>z</mi><mo> &sim; </mo><mi>g</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mo> &sdot; </mo>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>, the sub-gradient <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>v</mi>
 </mrow></math> of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &ell; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>w</mi><mo>,</mo><mi>z</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> at point <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>w</mi>
 </mrow></math> is an unbiased estimator of the sub-gradient of the risk <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>R</mi>
    </mrow>
    <mrow><mi>g</mi>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> at point <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>w</mi>
 </mrow></math>. </div>

<div class="proof" id='magicparlabel-164'><div class="proof_item"><span class="proof_label">Proof.</span>
Let <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>v</mi>
 </mrow></math> be a sub-gradient of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &ell; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>w</mi><mo>,</mo><mi>z</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> at point <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>w</mi>
 </mrow></math>, then<a id="eq_sfgfgrqwetg" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mi> &ell; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>u</mi><mo>,</mo><mi>z</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>-</mo><mi> &ell; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>w</mi><mo>,</mo><mi>z</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &ge; </mo><mo> &lang; </mo><mi>u</mi><mo>-</mo><mi>w</mi><mo>,</mo><mi>v</mi><mo> &rang; </mo>
    </mrow>
   </mtd>
   <mtd>(5.1)
   </mtd>
  </mtr>
 </mtable></math>It is  <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <msub>
      <mrow><mi>R</mi>
      </mrow>
      <mrow><mi>g</mi>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>u</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>-</mo>
     <msub>
      <mrow><mi>R</mi>
      </mrow>
      <mrow><mi>g</mi>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mo>=</mo>
     <msub>
      <mrow>
       <mstyle mathvariant='normal'><mi>E</mi>
       </mstyle>
      </mrow>
      <mrow>
       <mrow><mi>z</mi><mo> &sim; </mo><mi>g</mi>
       </mrow>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi> &ell; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi>u</mi><mo>,</mo><mi>z</mi>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>-</mo><mi> &ell; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi>w</mi><mo>,</mo><mi>z</mi>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>|</mo><mi>w</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &ge; </mo>
     <msub>
      <mrow>
       <mstyle mathvariant='normal'><mi>E</mi>
       </mstyle>
      </mrow>
      <mrow>
       <mrow><mi>z</mi><mo> &sim; </mo><mi>g</mi>
       </mrow>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mo> &lang; </mo><mi>u</mi><mo>-</mo><mi>w</mi><mo>,</mo><mi>v</mi><mo> &rang; </mo><mo>|</mo><mi>w</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd><mrow/>
   </mtd>
   <mtd>
    <mrow><mo>=</mo><mo> &lang; </mo><mi>u</mi><mo>-</mo><mi>w</mi><mo>,</mo>
     <msub>
      <mrow>
       <mstyle mathvariant='normal'><mi>E</mi>
       </mstyle>
      </mrow>
      <mrow>
       <mrow><mi>z</mi><mo> &sim; </mo><mi>g</mi>
       </mrow>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>v</mi><mo>|</mo><mi>w</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &rang; </mo>
    </mrow>
   </mtd>
  </mtr>
 </mtable></math> Hence, by definition, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>v</mi>
 </mrow></math> is such that <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow>
     <mstyle mathvariant='normal'><mi>E</mi>
     </mstyle>
    </mrow>
    <mrow>
     <mrow><mi>z</mi><mo> &sim; </mo><mi>g</mi>
     </mrow>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>v</mi><mo>|</mo><mi>w</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> is a sub-gradient of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>R</mi>
    </mrow>
    <mrow><mi>g</mi>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>.</div>
</div>
</div>

<div class="standard" id='magicparlabel-169'><br />

</div>

<div class="example" id='magicparlabel-170'><div class="example_item"><span class="example_label">Example 23.</span>
Consider that loss <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi> &ell; </mi>
 </mrow></math> is differentiable wrt <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>w</mi>
 </mrow></math>. If <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>v</mi><mo>=</mo>
   <msub>
    <mrow><mi> &nabla; </mi>
    </mrow>
    <mrow><mi>w</mi>
    </mrow>
   </msub><mi> &ell; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>w</mi><mo>,</mo><mi>z</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>, then <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow>
     <mstyle mathvariant='normal'><mi>E</mi>
     </mstyle>
    </mrow>
    <mrow>
     <mrow><mi>z</mi><mo> &sim; </mo><mi>g</mi>
     </mrow>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>v</mi><mo>|</mo><mi>w</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
   <msub>
    <mrow><mi> &nabla; </mi>
    </mrow>
    <mrow><mi>w</mi>
    </mrow>
   </msub>
   <msub>
    <mrow><mi>R</mi>
    </mrow>
    <mrow><mi>g</mi>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math></div>
</div>

<div class="standard" id='magicparlabel-171'><br />

</div>

<div class="note" id='magicparlabel-172'><div class="note_item"><span class="note_label">Note 24.</span>
Below we show how SGD can be implement in the learning Problem 1.</div>
</div>

<div class="standard" id='magicparlabel-173'><br />

</div>

<div class="note" id='magicparlabel-174'><div class="note_item"><span class="note_label">Note 25.</span>
Assume there is available a finite dataset <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow>
     <mstyle mathvariant='script'><mi>S</mi>
     </mstyle>
    </mrow>
    <mrow><mi>n</mi>
    </mrow>
   </msub><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

   <mrow>
    <msub>
     <mrow><mi>z</mi>
     </mrow>
     <mrow><mi>i</mi>
     </mrow>
    </msub><mo>;</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>n</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

  </mrow>
 </mrow></math> of size <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>n</mi>
 </mrow></math> which consists of independent realizations <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>z</mi>
   </mrow>
   <mrow><mi>i</mi>
   </mrow>
  </msub>
 </mrow></math> from the data generating distribution <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>g</mi>
 </mrow></math>; <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>z</mi>
    </mrow>
    <mrow><mi>i</mi>
    </mrow>
   </msub><mover accent='false'><mo> &sim; </mo>
   <mstyle mathvariant='normal'>
    <mrow><mi>i</mi><mi>n</mi><mi>d</mi>
    </mrow>
   </mstyle></mover><mi>g</mi>
  </mrow>
 </mrow></math>. Batch sampling (Algorithm <a href="#alg_batch_Stochastic_Gradient">26</a>) is an implementation of the SGD (Algorithm <a href="#alg_Stochastic_Gradient_descent">6</a>) in the learning Problem <a href="#prob_Consider_a_learning">1</a>. </div>
</div>

<div class="standard" id='magicparlabel-175'><br />

</div>


<div class="standard" id='magicparlabel-176'><div class='Boxed'><div class="algorithm" id='magicparlabel-180'><div class="algorithm_item"><span class="algorithm_label">Algorithm 26.</span>
<a id="alg_batch_Stochastic_Gradient" />
batch Stochastic Gradient Descent with learning rate <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo>&gt;</mo><mn>0</mn>
  </mrow>
 </mrow></math>, and batch size <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>m</mi>
 </mrow></math>, for Problem <a href="#prob_Consider_a_learning">1</a>.</div>
<div class="algorithm_item"><hr />

</div>
<div class="plain_layout" style='text-align: left;' id='magicparlabel-186'><i>For <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>t</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>...</mn>
  </mrow>
 </mrow></math> iterate:</i></div>

<ol class="enumerate" id='magicparlabel-187'><li class="enumerate_item"><i><a id="enu_sample___and" />
 get a random sub-sample <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

  <mrow>
   <msubsup>
    <mrow>
     <mover>
      <mrow><mi>z</mi>
      </mrow><mo stretchy="true">&tilde;</mo>
     </mover>
    </mrow>
    <mrow><mi>j</mi>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msubsup><mo>;</mo><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>m</mi>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

 </mrow></math> of size <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>m</mi>
 </mrow></math> with or without replacement from the complete data-set <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow>
    <mstyle mathvariant='script'><mi>S</mi>
    </mstyle>
   </mrow>
   <mrow><mi>n</mi>
   </mrow>
  </msub>
 </mrow></math>.</i></li>
<li class="enumerate" style='text-align: left;'><i>compute <a id="eq_GD_UPDATE_MECHANISM_2" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow><mi>t</mi><mo>+</mo><mn>1</mn>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup><mo>=</mo>
     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup><mo>-</mo>
     <msub>
      <mrow><mi> &eta; </mi>
      </mrow>
      <mrow><mi>t</mi>
      </mrow>
     </msub>
     <msub>
      <mrow><mi>v</mi>
      </mrow>
      <mrow><mi>t</mi>
      </mrow>
     </msub><mo>,</mo>
    </mrow>
   </mtd>
   <mtd>(5.2)
   </mtd>
  </mtr>
 </mtable></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>v</mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo>=</mo>
   <mfrac>
    <mrow><mn>1</mn>
    </mrow>
    <mrow><mi>m</mi>
    </mrow>
   </mfrac>
   <msubsup>
    <mrow><mo> &sum; </mo>
    </mrow>
    <mrow>
     <mrow><mi>j</mi><mo>=</mo><mn>1</mn>
     </mrow>
    </mrow>
    <mrow><mi>m</mi>
    </mrow>
   </msubsup>
   <msub>
    <mrow>
     <mover>
      <mrow><mi>v</mi>
      </mrow><mo stretchy="true">&tilde;</mo>
     </mover>
    </mrow>
    <mrow>
     <mrow><mi>t</mi><mo>,</mo><mi>j</mi>
     </mrow>
    </mrow>
   </msub>
  </mrow>
 </mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow>
     <mover>
      <mrow><mi>v</mi>
      </mrow><mo stretchy="true">&tilde;</mo>
     </mover>
    </mrow>
    <mrow>
     <mrow><mi>t</mi><mo>,</mo><mi>j</mi>
     </mrow>
    </mrow>
   </msub><mo> &isin; </mo>
   <msub>
    <mrow><mi> &part; </mi>
    </mrow>
    <mrow><mi>w</mi>
    </mrow>
   </msub><mi> &ell; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msup>
     <mrow><mi>w</mi>
     </mrow>
     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </msup><mo>,</mo>
    <msubsup>
     <mrow>
      <mover>
       <mrow><mi>z</mi>
       </mrow><mo stretchy="true">&tilde;</mo>
      </mover>
     </mrow>
     <mrow><mi>j</mi>
     </mrow>
     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </msubsup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>.</i></li>
<li class="enumerate" style='text-align: left;'><i>terminate if a termination criterion is satisfied</i></li>
</ol>
</div>
</div></div>


<div class="standard" id='magicparlabel-202'><br />

</div>

<div class="standard" id='magicparlabel-203'> </div>


<div class="standard" id='magicparlabel-214'><br />

</div>

<div class="remark" id='magicparlabel-215'><div class="remark_item"><span class="remark_label">Remark 27.</span>
Step <a href="#enu_sample___and">1.</a> can be presented equivalently as </div>

<ol class="enumerate" id='magicparlabel-216'><li class="enumerate_item">Randomly generate a set <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msup>
    <mrow>
     <mstyle mathvariant='script'><mi>J</mi>
     </mstyle>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup><mo> &sube; </mo>
   <msup>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

     <mrow><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>n</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

    </mrow>
    <mrow><mi>m</mi>
    </mrow>
   </msup>
  </mrow>
 </mrow></math> of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>m</mi>
 </mrow></math> indices from <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mn>1</mn>
 </mrow></math> to <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>n</mi>
 </mrow></math> with or without repeatations, and set a <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow>
     <mover>
      <mrow>
       <mstyle mathvariant='script'><mi>S</mi>
       </mstyle>
      </mrow><mo stretchy="true">&tilde;</mo>
     </mover>
    </mrow>
    <mrow><mi>m</mi>
    </mrow>
   </msub><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

   <mrow>
    <msub>
     <mrow><mi>z</mi>
     </mrow>
     <mrow><mi>i</mi>
     </mrow>
    </msub><mo>;</mo><mi>i</mi><mo> &isin; </mo>
    <msup>
     <mrow>
      <mstyle mathvariant='script'><mi>J</mi>
      </mstyle>
     </mrow>
     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </msup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

  </mrow>
 </mrow></math>. </li>
</ol>
<div class="standard" id='magicparlabel-217'>Hence <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>v</mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo>=</mo>
   <mfrac>
    <mrow><mn>1</mn>
    </mrow>
    <mrow><mi>m</mi>
    </mrow>
   </mfrac>
   <msub>
    <mrow><mo> &sum; </mo>
    </mrow>
    <mrow>
     <mrow><mi>j</mi><mo> &isin; </mo>
      <msup>
       <mrow>
        <mstyle mathvariant='script'><mi>J</mi>
        </mstyle>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup>
     </mrow>
    </mrow>
   </msub>
   <msub>
    <mrow><mi>v</mi>
    </mrow>
    <mrow>
     <mrow><mi>t</mi><mo>,</mo><mi>j</mi>
     </mrow>
    </mrow>
   </msub>
  </mrow>
 </mrow></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>v</mi>
    </mrow>
    <mrow>
     <mrow><mi>t</mi><mo>,</mo><mi>j</mi>
     </mrow>
    </mrow>
   </msub><mo> &isin; </mo>
   <msub>
    <mrow><mi> &part; </mi>
    </mrow>
    <mrow><mi>w</mi>
    </mrow>
   </msub><mi> &ell; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msup>
     <mrow><mi>w</mi>
     </mrow>
     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </msup><mo>,</mo>
    <msubsup>
     <mrow><mi>z</mi>
     </mrow>
     <mrow><mi>j</mi>
     </mrow>
     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </msubsup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>.</div>
</div>

<div class="standard" id='magicparlabel-218'><br />

</div>

<div class="remark" id='magicparlabel-219'><div class="remark_item"><span class="remark_label">Remark 28.</span>
A projection step, such as <a href="#eq_GD_UPDATE_MECHANISM_3_1">(3.2)</a> can be added right after step 2 in Algorithm <a href="#alg_batch_Stochastic_Gradient">26</a>, if needed.</div>
</div>

<div class="standard" id='magicparlabel-220'><br />

</div>

<div class="remark" id='magicparlabel-221'><div class="remark_item"><span class="remark_label">Remark 29.</span>
If it is possible to sample anytime fresh examples <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>z</mi>
   </mrow>
   <mrow><mi>i</mi>
   </mrow>
  </msub>
 </mrow></math> directly from the data generation model <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>g</mi>
 </mrow></math> instead of just having access to only a given finite dataset of examples <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow>
    <mstyle mathvariant='script'><mi>S</mi>
    </mstyle>
   </mrow>
   <mrow><mi>n</mi>
   </mrow>
  </msub>
 </mrow></math>, then step <a href="#enu_sample___and">1.</a> in Algorithm <a href="#alg_batch_Stochastic_Gradient">26</a> can become </div>

<ol class="enumerate" id='magicparlabel-222'><li class="enumerate_item">sample <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msubsup>
    <mrow>
     <mover>
      <mrow><mi>z</mi>
      </mrow><mo stretchy="true">&tilde;</mo>
     </mover>
    </mrow>
    <mrow><mi>j</mi>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msubsup><mo> &sim; </mo><mi>g</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mo> &sdot; </mo>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> for <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>m</mi>
  </mrow>
 </mrow></math>.</li>
</ol>
</div>

<div class="standard" id='magicparlabel-223'><br />

</div>

<div class="definition" id='magicparlabel-224'><div class="definition_item"><span class="definition_label">Definition 30.</span>
Online Stochastic gradient descent is the special case of Algorithm <a href="#alg_batch_Stochastic_Gradient">26</a> using sub-samples of size one ( <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>m</mi><mo>=</mo><mn>1</mn>
  </mrow>
 </mrow></math> ), namely, only one example is randomly chosen in Step <a href="#enu_sample___and">1.</a> of Algorithm <a href="#alg_batch_Stochastic_Gradient">26</a>. </div>
</div>

<div class="standard" id='magicparlabel-225'><br />

</div>

<div class="remark" id='magicparlabel-226'><div class="remark_item"><span class="remark_label">Remark 31.</span>
In theory, using larger <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>m</mi>
 </mrow></math> has the benefit that reduces the variance <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mstyle mathvariant='normal'>
    <mrow><mi>V</mi><mi>a</mi><mi>r</mi>
    </mrow>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>v</mi>
     </mrow>
     <mrow><mi>t</mi>
     </mrow>
    </msub><mo>|</mo>
    <msup>
     <mrow><mi>w</mi>
     </mrow>
     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </msup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>v</mi>
   </mrow>
   <mrow><mi>t</mi>
   </mrow>
  </msub>
 </mrow></math> at iteration <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>t</mi>
 </mrow></math> due to averaging effect, stabilizes the SGD algorithm, and reduces the error bound <a href="#eq_sgd_upper_bound">(4.1)</a>; see Remark <a href="#rem_Note_that_the">18</a>. </div>
</div>

<div class="standard" id='magicparlabel-231'><br />

</div>

<div class="remark" id='magicparlabel-232'><div class="remark_item"><span class="remark_label">Remark 32.</span>
<a id="rem_In_practice__using" />
In practice, for a given fixed computational time, using smaller <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>m</mi>
 </mrow></math> has the benefit that the algorithm iterates faster as each iteration processes less number of examples. E.g., consider the extreme cases GD vs online SGD in a scenario with big-data: if the dataset consists of several replications of the same values, GD (using all the data) has to process the same information multiple times, while the online SGD (using only one example at a time) would avoid this issue.</div>
</div>

<div class="standard" id='magicparlabel-233'><br />

</div>

<div class="remark" id='magicparlabel-234'><div class="remark_item"><span class="remark_label">Remark 33.</span>
In practice, for a given fixed computational time, it is possible for a batch SGD with smaller batch size <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>m</mi>
 </mrow></math> to present better generalization properties (wrt the theoretical assumptions) than those with larger <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>m</mi>
 </mrow></math> (GD is included). It is observed for the former to be often less prone to getting stuck in shallow local minima because of the additional amount of noise E.g., consider the extreme cases GD vs online SGD in a scenario with non-convex risk function (e.g. our theoretical assumptions as violated): if the Risk function presents local minima, considering less examples randomly chosen each time may cause fluctuations in the gradient that allow the chain to accidentally jump/escape to an area with a lower minimum.</div>
</div>

<div class="standard" id='magicparlabel-235'><br />

</div>
<h2 class="section" id='magicparlabel-236'><span class="section_label">6</span> SVRG: Stochastic Variance Reduced Gradient </h2>

<div class="remark" id='magicparlabel-237'><div class="remark_item"><span class="remark_label">Remark 34.</span>
Recall the upper bound of the error <a href="#eq_sgd_upper_bound">(4.1)</a> in SGD depends on the variance of the stochastic gradient, as shown in Remark <a href="#eq_">4.5</a>. Hence the algorithm may be improved by reducing the variance of each element of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>v</mi>
   </mrow>
   <mrow><mi>t</mi>
   </mrow>
  </msub>
 </mrow></math>. </div>
</div>

<div class="standard" id='magicparlabel-238'><br />

</div>

<div class="remark" id='magicparlabel-239'><div class="remark_item"><span class="remark_label">Remark 35.</span>
<a id="rem_Control_variate_is" />
Control variate is a general way to perform variance reduction. Let random variables <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>v</mi><mo> &isin; </mo>
   <mstyle mathvariant='double-struck'><mi>R</mi>
   </mstyle>
  </mrow>
 </mrow></math>, and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>y</mi><mo> &isin; </mo>
   <mstyle mathvariant='double-struck'><mi>R</mi>
   </mstyle>
  </mrow>
 </mrow></math>. Let <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>z</mi><mo>=</mo><mi>v</mi><mo>+</mo><mi>c</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>y</mi><mo>-</mo>
    <mstyle mathvariant='normal'><mi>E</mi>
    </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>y</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> for some constant <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>c</mi><mo> &isin; </mo>
   <mstyle mathvariant='double-struck'><mi>R</mi>
   </mstyle>
  </mrow>
 </mrow></math>. It is <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow>
     <mstyle mathvariant='normal'><mi>E</mi>
     </mstyle>
    </mrow>
    <mrow><mi>c</mi>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>z</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
   <mstyle mathvariant='normal'><mi>E</mi>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>v</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> and <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow>
     <mstyle mathvariant='normal'>
      <mrow><mi>V</mi><mi>a</mi><mi>r</mi>
      </mrow>
     </mstyle>
    </mrow>
    <mrow><mi>c</mi>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>z</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
   <mstyle mathvariant='normal'>
    <mrow><mi>V</mi><mi>a</mi><mi>r</mi>
    </mrow>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>v</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo>
   <msup>
    <mrow><mi>c</mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msup>
   <mstyle mathvariant='normal'>
    <mrow><mi>V</mi><mi>a</mi><mi>r</mi>
    </mrow>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>y</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo><mn>2</mn><mi>c</mi>
   <mstyle mathvariant='normal'>
    <mrow><mi>C</mi><mi>o</mi><mi>v</mi>
    </mrow>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>x</mi><mo>,</mo><mi>y</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> which is minimized for<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msup>
    <mrow><mi>c</mi>
    </mrow>
    <mrow><mo>*</mo>
    </mrow>
   </msup><mo>=</mo><mo>-</mo>
   <mfrac>
    <mrow>
     <mrow>
      <mstyle mathvariant='normal'>
       <mrow><mi>C</mi><mi>o</mi><mi>v</mi>
       </mrow>
      </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi>v</mi><mo>,</mo><mi>y</mi>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </mrow>
    <mrow>
     <mrow>
      <mstyle mathvariant='normal'>
       <mrow><mi>V</mi><mi>a</mi><mi>r</mi>
       </mrow>
      </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>y</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </mrow>
   </mfrac>
  </mrow>
 </mrow></math> hence<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow>
     <mstyle mathvariant='normal'>
      <mrow><mi>V</mi><mi>a</mi><mi>r</mi>
      </mrow>
     </mstyle>
    </mrow>
    <mrow>
     <msup>
      <mrow><mi>c</mi>
      </mrow>
      <mrow><mo>*</mo>
      </mrow>
     </msup>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>z</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
   <mstyle mathvariant='normal'>
    <mrow><mi>V</mi><mi>a</mi><mi>r</mi>
    </mrow>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>v</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>-</mo>
   <mfrac>
    <mrow>
     <msup>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow>
        <mstyle mathvariant='normal'>
         <mrow><mi>C</mi><mi>o</mi><mi>v</mi>
         </mrow>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>v</mi><mo>,</mo><mi>y</mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msup>
    </mrow>
    <mrow>
     <mrow>
      <mstyle mathvariant='normal'>
       <mrow><mi>V</mi><mi>a</mi><mi>r</mi>
       </mrow>
      </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>y</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </mrow>
   </mfrac>
  </mrow>
 </mrow></math></div>
</div>

<div class="standard" id='magicparlabel-240'><br />

</div>

<div class="note" id='magicparlabel-241'><div class="note_item"><span class="note_label">Note 36.</span>
For simplicity, SVRG is presented in the case where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &kappa; </mi><mo>=</mo><mn>1</mn>
  </mrow>
 </mrow></math> and the loss function <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &ell; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mo> &sdot; </mo><mo>,</mo><mo> &sdot; </mo>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> is differentiable hence its gradient exists. However it is applicable to the more general cases introduced. </div>
</div>

<div class="standard" id='magicparlabel-242'><br />

</div>

<div class="remark" id='magicparlabel-243'><div class="remark_item"><span class="remark_label">Remark 37.</span>
Every <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>m</mi>
 </mrow></math> iterations, SVRG keeps a snapshot <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mover>
   <mrow><mi>w</mi>
   </mrow><mo stretchy="true">&tilde;</mo>
  </mover>
 </mrow></math>, and computes the gradient using all data i.e. <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mfrac>
    <mrow><mn>1</mn>
    </mrow>
    <mrow><mi>n</mi>
    </mrow>
   </mfrac>
   <msubsup>
    <mrow><mo> &sum; </mo>
    </mrow>
    <mrow>
     <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
     </mrow>
    </mrow>
    <mrow><mi>n</mi>
    </mrow>
   </msubsup><mi> &ell; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <mover>
     <mrow><mi>w</mi>
     </mrow><mo stretchy="true">&tilde;</mo>
    </mover><mo>,</mo>
    <msub>
     <mrow><mi>z</mi>
     </mrow>
     <mrow><mi>i</mi>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>.. At each iteration <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>t</mi>
 </mrow></math>, the update is <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msup>
    <mrow><mi>w</mi>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>t</mi><mo>+</mo><mn>1</mn>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup><mo>=</mo>
   <msup>
    <mrow><mi>w</mi>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup><mo>-</mo>
   <msub>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>
<munder accent='false'>
   <munder>
    <mrow>
     <mrow><munder accent='false'>
      <munder>
       <mrow>
        <mrow><mi> &nabla; </mi><mi> &ell; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <mrow>
          <msup>
           <mrow><mi>w</mi>
           </mrow>
           <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

           </mrow>
          </msup><mo>,</mo>
          <msup>
           <mrow>
            <mover>
             <mrow><mi>z</mi>
             </mrow><mo stretchy="true">&tilde;</mo>
            </mover>
           </mrow>
           <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

           </mrow>
          </msup>
         </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </mrow><mo stretchy="true">&UnderBrace;</mo>
      </munder>
      <mrow><mo>=</mo><mi>v</mi>
      </mrow></munder><mo>-</mo><munder accent='false'>
      <munder>
       <mrow><mn>1</mn>
       </mrow><mo stretchy="true">&UnderBrace;</mo>
      </munder>
      <mrow><mo>=</mo><mi>c</mi>
      </mrow></munder><munder accent='false'>
      <munder>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi> &nabla; </mi><mi> &ell; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <mrow>
          <mover>
           <mrow><mi>w</mi>
           </mrow><mo stretchy="true">&tilde;</mo>
          </mover><mo>,</mo>
          <msup>
           <mrow>
            <mover>
             <mrow><mi>z</mi>
             </mrow><mo stretchy="true">&tilde;</mo>
            </mover>
           </mrow>
           <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

           </mrow>
          </msup>
         </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>-</mo>
         <mfrac>
          <mrow><mn>1</mn>
          </mrow>
          <mrow><mi>n</mi>
          </mrow>
         </mfrac>
         <msubsup>
          <mrow><mo> &sum; </mo>
          </mrow>
          <mrow>
           <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
           </mrow>
          </mrow>
          <mrow><mi>n</mi>
          </mrow>
         </msubsup><mi> &ell; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <mrow>
          <mover>
           <mrow><mi>w</mi>
           </mrow><mo stretchy="true">&tilde;</mo>
          </mover><mo>,</mo>
          <msub>
           <mrow><mi>z</mi>
           </mrow>
           <mrow><mi>i</mi>
           </mrow>
          </msub>
         </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow><mo stretchy="true">&UnderBrace;</mo>
      </munder><mi>y</mi></munder>
     </mrow>
    </mrow><mo stretchy="true">&UnderBrace;</mo>
   </munder><mi>z</mi></munder>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

  </mrow>
 </mrow></math> given that a random <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup>
   <mrow>
    <mover>
     <mrow><mi>z</mi>
     </mrow><mo stretchy="true">&tilde;</mo>
    </mover>
   </mrow>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
  </msup>
 </mrow></math> has been collected from the sample. The symbols below the brackets are given with reference to Remark <a href="#rem_Control_variate_is">35</a>. </div>
</div>

<div class="standard" id='magicparlabel-265'><br />

</div>


<div class="standard" id='magicparlabel-266'><br />

</div>


<div class="standard" id='magicparlabel-267'><div class='Boxed'><div class="algorithm" id='magicparlabel-271'><div class="algorithm_item"><span class="algorithm_label">Algorithm 38.</span>
<a id="alg_Stochastic_Variance_Reduced" />
Stochastic Variance Reduced Gradient with learning rate <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo>&gt;</mo><mn>0</mn>
  </mrow>
 </mrow></math> for Problem <a href="#prob_Consider_a_learning">1</a>.</div>
<div class="algorithm_item"><hr />

</div>
<div class="plain_layout" style='text-align: left;' id='magicparlabel-273'><i>For <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>t</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>...</mn>
  </mrow>
 </mrow></math> iterate:</i></div>

<ol class="enumerate" id='magicparlabel-274'><li class="enumerate_item"><i><a id="enu_sample___and_2" />
 randomly get an example <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup>
   <mrow>
    <mover>
     <mrow><mi>z</mi>
     </mrow><mo stretchy="true">&tilde;</mo>
    </mover>
   </mrow>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
  </msup>
 </mrow></math> from <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>S</mi>
   </mrow>
   <mrow><mi>n</mi>
   </mrow>
  </msub>
 </mrow></math>.</i></li>
<li class="enumerate" style='text-align: left;'><i>compute <a id="eq_GD_UPDATE_MECHANISM_2_2" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow><mi>t</mi><mo>+</mo><mn>1</mn>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup><mo>=</mo>
     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup><mo>-</mo>
     <msub>
      <mrow><mi> &eta; </mi>
      </mrow>
      <mrow><mi>t</mi>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

     <mrow><mi> &nabla; </mi><mi> &ell; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msup>
        <mrow><mi>w</mi>
        </mrow>
        <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </msup><mo>,</mo>
       <msup>
        <mrow>
         <mover>
          <mrow><mi>z</mi>
          </mrow><mo stretchy="true">&tilde;</mo>
         </mover>
        </mrow>
        <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </msup>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>-</mo><mi> &nabla; </mi><mi> &ell; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <mover>
        <mrow><mi>w</mi>
        </mrow><mo stretchy="true">&tilde;</mo>
       </mover><mo>,</mo>
       <msup>
        <mrow>
         <mover>
          <mrow><mi>z</mi>
          </mrow><mo stretchy="true">&tilde;</mo>
         </mover>
        </mrow>
        <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </msup>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo>
      <mfrac>
       <mrow><mn>1</mn>
       </mrow>
       <mrow><mi>n</mi>
       </mrow>
      </mfrac>
      <msubsup>
       <mrow><mo> &sum; </mo>
       </mrow>
       <mrow>
        <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
        </mrow>
       </mrow>
       <mrow><mi>n</mi>
       </mrow>
      </msubsup><mi> &ell; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <mover>
        <mrow><mi>w</mi>
        </mrow><mo stretchy="true">&tilde;</mo>
       </mover><mo>,</mo>
       <msub>
        <mrow><mi>z</mi>
        </mrow>
        <mrow><mi>i</mi>
        </mrow>
       </msub>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

    </mrow>
   </mtd>
   <mtd>(6.1)
   </mtd>
  </mtr>
 </mtable></math></i></li>
<li class="enumerate_item"><i>if <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mstyle mathvariant='normal'>
    <mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>u</mi><mi>l</mi><mi>o</mi>
    </mrow>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>t</mi><mo>,</mo><mi> &kappa; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mn>0</mn>
  </mrow>
 </mrow></math>, set <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mover>
    <mrow><mi>w</mi>
    </mrow><mo stretchy="true">&tilde;</mo>
   </mover><mo>=</mo>
   <msup>
    <mrow><mi>w</mi>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup>
  </mrow>
 </mrow></math></i></li>
<li class="enumerate" style='text-align: left;'><i>if a termination criterion is satisfied STOP</i></li>
</ol>
</div>
</div></div>



<div class="remark" id='magicparlabel-311'><div class="remark_item"><span class="remark_label">Remark 39.</span>
Iterations of SVRG are computationally faster than those of full GD, but SVRG can still match the theoretical convergence rate of GD.</div>
</div>

<div class="standard" id='magicparlabel-312'><br />

</div>

<div class="remark" id='magicparlabel-313'><div class="remark_item"><span class="remark_label">Remark 40.</span>
How often we get snapshots, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi> &kappa; </mi>
 </mrow></math>, in Algorithm <a href="#alg_Stochastic_Variance_Reduced">38</a> is specified by the researcher. The larger <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi> &kappa; </mi>
 </mrow></math> the more correlated the baseline <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>y</mi>
 </mrow></math> will be with the objective <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>x</mi>
 </mrow></math>and hence the bigger the performance improvement; however the iterations will be slower. </div>
</div>

<div class="standard" id='magicparlabel-314'><br />

</div>
<h2 class="section" id='magicparlabel-315'><span class="section_label">7</span> Preconditioned SGD; The AdaGrad algorithm</h2>

<div class="remark" id='magicparlabel-316'><div class="remark_item"><span class="remark_label">Remark 41.</span>
Vanilla SGD are first order methods in the sense they consider only the gradient. Their advantage is each iteration is fast. The disadvantage is that they ignore the curvature of the space and hence can be slower to converge in cases the curvature changes eg. among dimensions of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>w</mi>
 </mrow></math>. </div>
</div>

<div class="standard" id='magicparlabel-317'><br />

</div>

<div class="remark" id='magicparlabel-318'><div class="remark_item"><span class="remark_label">Remark 42.</span>
To address this, SGD (Algorithm <a href="#alg_Stochastic_Gradient_descent">6</a>) can be modified in the update step as in Algorithm <a href="#alg_Stochastic_Gradient_descent_2">43</a> by using a preconditioner <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>P</mi>
   </mrow>
   <mrow><mi>t</mi>
   </mrow>
  </msub>
 </mrow></math> that accounts for the courvature (or geometry in general of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>f</mi>
 </mrow></math>). </div>
</div>

<div class="standard" id='magicparlabel-323'><br />

</div>


<div class="standard" id='magicparlabel-324'><div class='Boxed'><div class="algorithm" id='magicparlabel-328'><div class="algorithm_item"><span class="algorithm_label">Algorithm 43.</span>
<a id="alg_Stochastic_Gradient_descent_2" />
 Preconditioned Stochastic Gradient Descent with learning rate <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo>&gt;</mo><mn>0</mn>
  </mrow>
 </mrow></math>, and preconditioner <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>P</mi>
   </mrow>
   <mrow><mi>t</mi>
   </mrow>
  </msub>
 </mrow></math> for the solution of the minimization problem <a href="#eq_gvbzvcb">eq:gvbzvcb</a> <hr />

</div>
<div class="plain_layout" id='magicparlabel-333'><i>For <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>t</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>...</mn>
  </mrow>
 </mrow></math> iterate:</i></div>

<ol class="enumerate" id='magicparlabel-334'><li class="enumerate" style='text-align: left;'><i><a id="enu_compute__where_2" />
compute <a id="eq_GD_UPDATE_MECHANISM_4" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow><mi>t</mi><mo>+</mo><mn>1</mn>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup><mo>=</mo>
     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup><mo>-</mo>
     <msub>
      <mrow><mi> &eta; </mi>
      </mrow>
      <mrow><mi>t</mi>
      </mrow>
     </msub>
     <msub>
      <mrow><mi>P</mi>
      </mrow>
      <mrow><mi>t</mi>
      </mrow>
     </msub>
     <msub>
      <mrow><mi>v</mi>
      </mrow>
      <mrow><mi>t</mi>
      </mrow>
     </msub><mo>,</mo>
    </mrow>
   </mtd>
   <mtd>(7.1)
   </mtd>
  </mtr>
 </mtable></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>v</mi>
   </mrow>
   <mrow><mi>t</mi>
   </mrow>
  </msub>
 </mrow></math> is a random vector such that <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mstyle mathvariant='normal'><mi>E</mi>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>v</mi>
     </mrow>
     <mrow><mi>t</mi>
     </mrow>
    </msub><mo>|</mo>
    <msup>
     <mrow><mi>w</mi>
     </mrow>
     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </msup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &isin; </mo><mi> &part; </mi><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <msup>
    <mrow><mi>w</mi>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>, and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>P</mi>
   </mrow>
   <mrow><mi>t</mi>
   </mrow>
  </msub>
 </mrow></math> a preconditioner</i></li>
<li class="enumerate_item"><i><a id="enu_terminate_if_2_2" />
terminate if a termination criterion is satisfied, e.g.<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mstyle mathvariant='normal'>
    <mrow><mi>I</mi><mi>f</mi>
    </mrow>
   </mstyle><mspace width="6px" /><mspace width="6px" /><mspace width="6px" /><mi>t</mi><mo> &ge; </mo><mi>T</mi><mspace width="6px" /><mspace width="6px" /><mspace width="6px" />
   <mstyle mathvariant='normal'>
    <mrow><mi>t</mi><mi>h</mi><mi>e</mi><mi>n</mi>
    </mrow>
   </mstyle><mspace width="6px" /><mspace width="6px" /><mspace width="6px" />
   <mstyle mathvariant='normal'>
    <mrow><mi>S</mi><mi>T</mi><mi>O</mi><mi>P</mi>
    </mrow>
   </mstyle>
  </mrow>
 </mrow></math></i></li>
</ol>
</div>
</div></div>


<div class="standard" id='magicparlabel-336'><br />

</div>

<div class="remark" id='magicparlabel-337'><div class="remark_item"><span class="remark_label">Remark 44.</span>
A natural choice of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>P</mi>
   </mrow>
   <mrow><mi>t</mi>
   </mrow>
  </msub>
 </mrow></math> can be <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>P</mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo>:</mo><mo>=</mo>
   <msup>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

     <mrow>
      <msub>
       <mrow><mi>H</mi>
       </mrow>
       <mrow><mi>t</mi>
       </mrow>
      </msub><mo>+</mo><mi> &epsi; </mi>
      <msub>
       <mrow><mi>I</mi>
       </mrow>
       <mrow><mi>d</mi>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

    </mrow>
    <mrow>
     <mrow><mo>-</mo><mn>1</mn>
     </mrow>
    </mrow>
   </msup>
  </mrow>
 </mrow></math>, where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>H</mi>
   </mrow>
   <mrow><mi>t</mi>
   </mrow>
  </msub>
 </mrow></math> is the Hessian matrix <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

     <msub>
      <mrow><mi>H</mi>
      </mrow>
      <mrow><mi>t</mi>
      </mrow>
     </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

    </mrow>
    <mrow>
     <mrow><mi>i</mi><mo>,</mo><mi>j</mi>
     </mrow>
    </mrow>
   </msub><mo>=</mo>
   <msub>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>.</mo>

     <mrow>
      <mfrac>
       <mrow>
        <msup>
         <mrow><mi> &part; </mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msup>
       </mrow>
       <mrow>
        <mrow><mi> &part; </mi>
         <msub>
          <mrow><mi>w</mi>
          </mrow>
          <mrow><mi>i</mi>
          </mrow>
         </msub><mi> &part; </mi>
         <msub>
          <mrow><mi>w</mi>
          </mrow>
          <mrow><mi>j</mi>
          </mrow>
         </msub>
        </mrow>
       </mrow>
      </mfrac><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

    </mrow>
    <mrow>
     <mrow><mi>w</mi><mo>=</mo>
      <msup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup>
     </mrow>
    </mrow>
   </msub>
  </mrow>
 </mrow></math> (ie. the gradient of the gradient's elements), and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi> &epsi; </mi>
 </mrow></math> is a tiny <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &epsi; </mi><mo>&gt;</mo><mn>0</mn>
  </mrow>
 </mrow></math> to mitigate machine error when Hessian elements ar close to zero. </div>
</div>

<div class="standard" id='magicparlabel-338'><br />

</div>

<div class="remark" id='magicparlabel-339'><div class="remark_item"><span class="remark_label">Remark 45.</span>
If the preconditioner <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>P</mi>
   </mrow>
   <mrow><mi>t</mi>
   </mrow>
  </msub>
 </mrow></math> is set to be the inverse of the full Hessian, it may be too expensive to perform matrix operations in <a href="#eq_GD_UPDATE_MECHANISM_4">(7.1)</a> with the full Hessian, and such operations can be too unstable/inaccurate due to the random error induced by the stochasticity of the gradient. </div>
</div>
<h3 class="subsection" id='magicparlabel-340'><span class="subsection_label">7.1</span> Adaptive Stochastic Gradient Decent (AdaGrad)</h3>

<div class="remark" id='magicparlabel-354'><div class="remark_item"><span class="remark_label">Remark 46.</span>
AdaGrad dynamically incorporates knowledge of the geometry of function <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mo> &sdot; </mo>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> (to be minimized) in earlier iterations to perform more informative gradient-based learning. </div>
</div>

<div class="standard" id='magicparlabel-355'><br />

</div>

<div class="remark" id='magicparlabel-356'><div class="remark_item"><span class="remark_label">Remark 47.</span>
AdaGrad aims to perform larger updates (i.e. high learning rates) for those dimensions of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>w</mi>
 </mrow></math> that are related to infrequent features (largest partial derivative) and smaller updates (i.e. low learning rates) for frequent ones (smaller partial derivative).</div>
</div>

<div class="standard" id='magicparlabel-357'><br />

</div>

<div class="remark" id='magicparlabel-358'><div class="remark_item"><span class="remark_label">Remark 48.</span>
Hence, this strategy often improves convergence performance over standard stochastic gradient descent in settings where data is sparse and sparse features <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>w</mi>
 </mrow></math>'s are more informative. </div>
</div>

<div class="standard" id='magicparlabel-359'><br />

</div>

<div class="definition" id='magicparlabel-360'><div class="definition_item"><span class="definition_label">Definition 49.</span>
Adaptive Stochastic Gradient Decent (AdaGrad) can be presented in terms of as a preconditioned SGD (Algorithm <a href="#alg_Stochastic_Gradient_descent_2">43</a>) with preconditioner <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>P</mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo>=</mo>
   <msup>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

     <mrow>
      <msup>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow>
         <mstyle mathvariant='normal'>
          <mrow><mi>d</mi><mi>i</mi><mi>a</mi><mi>g</mi>
          </mrow>
         </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <msub>
          <mrow><mi>G</mi>
          </mrow>
          <mrow><mi>t</mi>
          </mrow>
         </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
       <mrow><mi> &top; </mi>
       </mrow>
      </msup>
      <msub>
       <mrow><mi>I</mi>
       </mrow>
       <mrow><mi>d</mi>
       </mrow>
      </msub><mo>+</mo><mi> &epsi; </mi>
      <msub>
       <mrow><mi>I</mi>
       </mrow>
       <mrow><mi>d</mi>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

    </mrow>
    <mrow>
     <mrow><mo>-</mo><mn>1</mn>
     </mrow>
    </mrow>
   </msup>
  </mrow>
 </mrow></math> in <a href="#eq_GD_UPDATE_MECHANISM_4">(7.1)</a> i.e. <a id="eq_GD_UPDATE_MECHANISM_4_1" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <msup>
     <mrow><mi>w</mi>
     </mrow>
     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi>t</mi><mo>+</mo><mn>1</mn>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </msup>
   </mtd>
   <mtd>
    <mrow><mo>=</mo>
     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup><mo>-</mo>
     <msub>
      <mrow><mi> &eta; </mi>
      </mrow>
      <mrow><mi>t</mi>
      </mrow>
     </msub>
     <msup>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

       <mrow>
        <msup>
         <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

          <mrow>
           <mstyle mathvariant='normal'>
            <mrow><mi>d</mi><mi>i</mi><mi>a</mi><mi>g</mi>
            </mrow>
           </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

           <msub>
            <mrow><mi>G</mi>
            </mrow>
            <mrow><mi>t</mi>
            </mrow>
           </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

          </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
         <mrow><mi> &top; </mi>
         </mrow>
        </msup>
        <msub>
         <mrow><mi>I</mi>
         </mrow>
         <mrow><mi>d</mi>
         </mrow>
        </msub><mo>+</mo><mi> &epsi; </mi>
        <msub>
         <mrow><mi>I</mi>
         </mrow>
         <mrow><mi>d</mi>
         </mrow>
        </msub>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

      </mrow>
      <mrow>
       <mrow><mo>-</mo><mn>1</mn><mo>/</mo><mn>2</mn>
       </mrow>
      </mrow>
     </msup>
     <msub>
      <mrow><mi>v</mi>
      </mrow>
      <mrow><mi>t</mi>
      </mrow>
     </msub><mo>,</mo>
    </mrow>
   </mtd>
   <mtd>(7.2)
   </mtd>
  </mtr>
 </mtable></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mstyle mathvariant='normal'>
    <mrow><mi>d</mi><mi>i</mi><mi>a</mi><mi>g</mi>
    </mrow>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <msub>
    <mrow><mi>G</mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> is the vector of the diagonal of matrix <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>G</mi>
   </mrow>
   <mrow><mi>t</mi>
   </mrow>
  </msub>
 </mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>G</mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo>=</mo>
   <msubsup>
    <mrow><mo> &sum; </mo>
    </mrow>
    <mrow>
     <mrow><mi> &tau; </mi><mo>=</mo><mn>1</mn>
     </mrow>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msubsup>
   <msubsup>
    <mrow><mi>v</mi>
    </mrow>
    <mrow><mi> &tau; </mi>
    </mrow>
    <mrow><mi> &top; </mi>
    </mrow>
   </msubsup>
   <msub>
    <mrow><mi>v</mi>
    </mrow>
    <mrow><mi> &tau; </mi>
    </mrow>
   </msub>
  </mrow>
 </mrow></math> is the sum of the outer products of the gradients <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

  <mrow>
   <msub>
    <mrow><mi>v</mi>
    </mrow>
    <mrow><mi> &tau; </mi>
    </mrow>
   </msub><mo>;</mo><mi> &tau; </mi><mo> &le; </mo><mi>t</mi>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

 </mrow></math> up to the state <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>t</mi>
 </mrow></math>, and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &epsi; </mi><mo>&gt;</mo><mn>0</mn>
  </mrow>
 </mrow></math> is a tiny value (eg, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mn>1</mn>
   <msup>
    <mrow><mn>0</mn>
    </mrow>
    <mrow>
     <mrow><mo>-</mo><mn>6</mn>
     </mrow>
    </mrow>
   </msup>
  </mrow>
 </mrow></math>) set for computational stability is case the gradient becomes too close to zero.</div>
</div>

<div class="standard" id='magicparlabel-361'><br />

</div>

<div class="remark" id='magicparlabel-362'><div class="remark_item"><span class="remark_label">Remark 50.</span>
AdaGrad algorithm individually adapts the learning rate of each dimension of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>w</mi>
   </mrow>
   <mrow><mi>t</mi>
   </mrow>
  </msub>
 </mrow></math> by scaling them inversely proportional to the square root of the sum of all the past squared values of the gradient <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

  <mrow>
   <msub>
    <mrow><mi>v</mi>
    </mrow>
    <mrow><mi> &tau; </mi>
    </mrow>
   </msub><mo>;</mo><mi> &tau; </mi><mo> &le; </mo><mi>t</mi>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

 </mrow></math>. This is because <a id="eq_fgsfg" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <msub>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

       <msub>
        <mrow><mi>G</mi>
        </mrow>
        <mrow><mi>t</mi>
        </mrow>
       </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

      </mrow>
      <mrow>
       <mrow><mi>j</mi><mo>,</mo><mi>j</mi>
       </mrow>
      </mrow>
     </msub><mo>=</mo>
     <msubsup>
      <mrow><mo> &sum; </mo>
      </mrow>
      <mrow>
       <mrow><mi> &tau; </mi><mo>=</mo><mn>1</mn>
       </mrow>
      </mrow>
      <mrow><mi>t</mi>
      </mrow>
     </msubsup>
     <msup>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <msub>
        <mrow><mi>v</mi>
        </mrow>
        <mrow>
         <mrow><mi> &tau; </mi><mo>,</mo><mi>j</mi>
         </mrow>
        </mrow>
       </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msup>
    </mrow>
   </mtd>
   <mtd>(7.3)
   </mtd>
  </mtr>
 </mtable></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>j</mi>
 </mrow></math> denotes the <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>j</mi>
 </mrow></math>-th dimension of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>w</mi>
 </mrow></math>.</div>
</div>

<div class="standard" id='magicparlabel-363'><br />

</div>

<div class="remark" id='magicparlabel-364'><div class="remark_item"><span class="remark_label">Remark 51.</span>
The accumulation of positive terms in <a href="#eq_fgsfg">(7.3)</a> makes the sum keep growing during training and causes the learning rate to shrink and becoming infinitesimally small. This offers an automatic way to choose a decreasing learning rate simplifying setting the learning rate; however it may result in a premature and excessive decrease in the effective learning rate. This can be mitigated by still considering in <a href="#eq_GD_UPDATE_MECHANISM_4_1">(7.2)</a> a (user specified rate) <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo> &ge; </mo><mn>0</mn>
  </mrow>
 </mrow></math> and adjusting it properly.</div>
</div>

<div class="standard" id='magicparlabel-365'><br />

</div>
<h2 class="section" id='magicparlabel-366'><span class="section_label">8</span> <a id="sec_Example" />
Example<div class="foot"><span class="foot_label">1</span><div class="foot_inner"><div class="plain_layout" id='magicparlabel-370'>Code can be found in <span class="flex_url">https://github.com/georgios-stats/Machine_Learning_and_Neural_Networks_III_Epiphany_2023/tree/main/Lecture_handouts/code/03.Stochastic_gradient_descent</span></div>
</div></div></h2>
<div class="standard" id='magicparlabel-375'>We Continue Example in Section <a href="#sec_Examples">sec:Examples</a> in Handout 2, however here we consider a dataset <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow>
     <mstyle mathvariant='script'><mi>S</mi>
     </mstyle>
    </mrow>
    <mrow><mi>n</mi>
    </mrow>
   </msub><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

   <mrow>
    <msub>
     <mrow><mi>z</mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
    </msub><mo>,</mo><mn>...</mn><mo>,</mo>
    <msub>
     <mrow><mi>z</mi>
     </mrow>
     <mrow><mi>n</mi>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

  </mrow>
 </mrow></math> with <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>n</mi><mo>=</mo><mn>1</mn>
   <msup>
    <mrow><mn>0</mn>
    </mrow>
    <mrow><mn>6</mn>
    </mrow>
   </msup>
  </mrow>
 </mrow></math> examples.</div>


<div class="standard" id='magicparlabel-380'><br />

</div>

<div class="example" id='magicparlabel-381'><div class="example_item"><span class="example_label">Example 52.</span>
<a id="exa_The_batch_SGD" />
The batch SGD algorithm (Algorithm <a href="#alg_batch_Stochastic_Gradient">26</a>) with learning rate <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &eta; </mi>
   </mrow>
   <mrow><mi>t</mi>
   </mrow>
  </msub>
 </mrow></math> and batch size <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>m</mi><mo>=</mo><mn>10</mn>
  </mrow>
 </mrow></math> is </div>

<ul class="itemize" id='magicparlabel-382'><li class="itemize_item">For <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>t</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>...</mn>
  </mrow>
 </mrow></math> iterate:

<ol class="enumerate" id='magicparlabel-383'><li class="enumerate_item">Randomly generate a set <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup>
   <mrow>
    <mstyle mathvariant='script'><mi>J</mi>
    </mstyle>
   </mrow>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
  </msup>
 </mrow></math> by drawing <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>m</mi><mo>=</mo><mn>10</mn>
  </mrow>
 </mrow></math> numbers from <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

  <mrow><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>n</mi><mo>=</mo><mn>1</mn>
   <msup>
    <mrow><mn>0</mn>
    </mrow>
    <mrow><mn>6</mn>
    </mrow>
   </msup>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

 </mrow></math>, and set <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow>
     <mover>
      <mrow>
       <mstyle mathvariant='script'><mi>S</mi>
       </mstyle>
      </mrow><mo stretchy="true">&tilde;</mo>
     </mover>
    </mrow>
    <mrow><mi>m</mi>
    </mrow>
   </msub><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

   <mrow>
    <msub>
     <mrow><mi>z</mi>
     </mrow>
     <mrow><mi>i</mi>
     </mrow>
    </msub><mo>;</mo><mi>i</mi><mo> &isin; </mo>
    <msup>
     <mrow>
      <mstyle mathvariant='script'><mi>J</mi>
      </mstyle>
     </mrow>
     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </msup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

  </mrow>
 </mrow></math></li>
<li class="enumerate" style='text-align: left;'><a id="enu_sample___and_3" />
compute <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msup>
    <mrow><mi>w</mi>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>t</mi><mo>+</mo><mn>1</mn>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup><mo>=</mo>
   <msup>
    <mrow><mi>w</mi>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup><mo>-</mo>
   <msub>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub>
   <msub>
    <mrow><mi>v</mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo>,</mo>
  </mrow>
 </mrow></math> where <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>v</mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>(</mo>
   <mtable>
    <mtr>
     <mtd>
      <mrow><mn>2</mn>
       <msubsup>
        <mrow><mi>w</mi>
        </mrow>
        <mrow><mn>1</mn>
        </mrow>
        <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </msubsup><mo>+</mo><mn>2</mn>
       <msubsup>
        <mrow><mi>w</mi>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
        <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </msubsup>
       <mfrac>
        <mrow><mn>1</mn>
        </mrow>
        <mrow><mi>m</mi>
        </mrow>
       </mfrac>
       <msub>
        <mrow><mo> &sum; </mo>
        </mrow>
        <mrow>
         <mrow><mi>j</mi><mo> &isin; </mo>
          <msup>
           <mrow>
            <mstyle mathvariant='script'><mi>J</mi>
            </mstyle>
           </mrow>
           <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

           </mrow>
          </msup>
         </mrow>
        </mrow>
       </msub>
       <msub>
        <mrow><mi>x</mi>
        </mrow>
        <mrow><mi>j</mi>
        </mrow>
       </msub><mo>-</mo><mn>2</mn>
       <mfrac>
        <mrow><mn>1</mn>
        </mrow>
        <mrow><mi>m</mi>
        </mrow>
       </mfrac>
       <msub>
        <mrow><mo> &sum; </mo>
        </mrow>
        <mrow>
         <mrow><mi>j</mi><mo> &isin; </mo>
          <msup>
           <mrow>
            <mstyle mathvariant='script'><mi>J</mi>
            </mstyle>
           </mrow>
           <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

           </mrow>
          </msup>
         </mrow>
        </mrow>
       </msub>
       <msub>
        <mrow><mi>y</mi>
        </mrow>
        <mrow><mi>j</mi>
        </mrow>
       </msub>
      </mrow>
     </mtd>
    </mtr>
    <mtr>
     <mtd>
      <mrow><mn>2</mn>
       <msubsup>
        <mrow><mi>w</mi>
        </mrow>
        <mrow><mn>1</mn>
        </mrow>
        <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </msubsup>
       <mover>
        <mrow><mi>x</mi>
        </mrow><mo stretchy="true">&OverBar;</mo>
       </mover><mo>+</mo><mn>2</mn>
       <msubsup>
        <mrow><mi>w</mi>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
        <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </msubsup>
       <mfrac>
        <mrow><mn>1</mn>
        </mrow>
        <mrow><mi>m</mi>
        </mrow>
       </mfrac>
       <msub>
        <mrow><mo> &sum; </mo>
        </mrow>
        <mrow>
         <mrow><mi>j</mi><mo> &isin; </mo>
          <msup>
           <mrow>
            <mstyle mathvariant='script'><mi>J</mi>
            </mstyle>
           </mrow>
           <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

           </mrow>
          </msup>
         </mrow>
        </mrow>
       </msub>
       <msubsup>
        <mrow><mi>x</mi>
        </mrow>
        <mrow><mi>j</mi>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
       </msubsup><mo>-</mo><mn>2</mn>
       <msub>
        <mrow><mo> &sum; </mo>
        </mrow>
        <mrow>
         <mrow><mi>j</mi><mo> &isin; </mo>
          <msup>
           <mrow>
            <mstyle mathvariant='script'><mi>J</mi>
            </mstyle>
           </mrow>
           <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

           </mrow>
          </msup>
         </mrow>
        </mrow>
       </msub>
       <msub>
        <mrow><mi>y</mi>
        </mrow>
        <mrow><mi>j</mi>
        </mrow>
       </msub>
       <msub>
        <mrow><mi>x</mi>
        </mrow>
        <mrow><mi>j</mi>
        </mrow>
       </msub>
      </mrow>
     </mtd>
    </mtr>
   </mtable><mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>)</mo>
  </mrow>
 </mrow></math>, </li>
<li class="enumerate_item">if <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>t</mi><mo> &ge; </mo><mi>T</mi><mo>=</mo><mn>1000</mn>
  </mrow>
 </mrow></math> STOP</li>
</ol>
</li></ul>
<div class="standard" id='magicparlabel-386'>because <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>v</mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo>=</mo><mi> &nabla; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

   <mrow>
    <mfrac>
     <mrow><mn>1</mn>
     </mrow>
     <mrow><mi>m</mi>
     </mrow>
    </mfrac>
    <msub>
     <mrow><mo> &sum; </mo>
     </mrow>
     <mrow>
      <mrow><mi>j</mi><mo> &isin; </mo>
       <msup>
        <mrow>
         <mstyle mathvariant='script'><mi>J</mi>
         </mstyle>
        </mrow>
        <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </msup>
      </mrow>
     </mrow>
    </msub><mi> &nabla; </mi><mi> &ell; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow>
     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup><mo>,</mo>
     <msup>
      <mrow>
       <mover>
        <mrow><mi>z</mi>
        </mrow><mo stretchy="true">&tilde;</mo>
       </mover>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>
<mo>=</mo><mn>...</mn><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>(</mo>
   <mtable>
    <mtr>
     <mtd>
      <mrow><mn>2</mn>
       <msubsup>
        <mrow><mi>w</mi>
        </mrow>
        <mrow><mn>1</mn>
        </mrow>
        <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </msubsup><mo>+</mo><mn>2</mn>
       <msubsup>
        <mrow><mi>w</mi>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
        <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </msubsup>
       <mfrac>
        <mrow><mn>1</mn>
        </mrow>
        <mrow><mi>m</mi>
        </mrow>
       </mfrac>
       <msub>
        <mrow><mo> &sum; </mo>
        </mrow>
        <mrow>
         <mrow><mi>j</mi><mo> &isin; </mo>
          <msup>
           <mrow>
            <mstyle mathvariant='script'><mi>J</mi>
            </mstyle>
           </mrow>
           <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

           </mrow>
          </msup>
         </mrow>
        </mrow>
       </msub>
       <msub>
        <mrow><mi>x</mi>
        </mrow>
        <mrow><mi>j</mi>
        </mrow>
       </msub><mo>-</mo><mn>2</mn>
       <mfrac>
        <mrow><mn>1</mn>
        </mrow>
        <mrow><mi>m</mi>
        </mrow>
       </mfrac>
       <msub>
        <mrow><mo> &sum; </mo>
        </mrow>
        <mrow>
         <mrow><mi>j</mi><mo> &isin; </mo>
          <msup>
           <mrow>
            <mstyle mathvariant='script'><mi>J</mi>
            </mstyle>
           </mrow>
           <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

           </mrow>
          </msup>
         </mrow>
        </mrow>
       </msub>
       <msub>
        <mrow><mi>y</mi>
        </mrow>
        <mrow><mi>j</mi>
        </mrow>
       </msub>
      </mrow>
     </mtd>
    </mtr>
    <mtr>
     <mtd>
      <mrow><mn>2</mn>
       <msubsup>
        <mrow><mi>w</mi>
        </mrow>
        <mrow><mn>1</mn>
        </mrow>
        <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </msubsup>
       <mover>
        <mrow><mi>x</mi>
        </mrow><mo stretchy="true">&OverBar;</mo>
       </mover><mo>+</mo><mn>2</mn>
       <msubsup>
        <mrow><mi>w</mi>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
        <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </msubsup>
       <mfrac>
        <mrow><mn>1</mn>
        </mrow>
        <mrow><mi>m</mi>
        </mrow>
       </mfrac>
       <msub>
        <mrow><mo> &sum; </mo>
        </mrow>
        <mrow>
         <mrow><mi>j</mi><mo> &isin; </mo>
          <msup>
           <mrow>
            <mstyle mathvariant='script'><mi>J</mi>
            </mstyle>
           </mrow>
           <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

           </mrow>
          </msup>
         </mrow>
        </mrow>
       </msub>
       <msubsup>
        <mrow><mi>x</mi>
        </mrow>
        <mrow><mi>j</mi>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
       </msubsup><mo>-</mo><mn>2</mn>
       <msub>
        <mrow><mo> &sum; </mo>
        </mrow>
        <mrow>
         <mrow><mi>j</mi><mo> &isin; </mo>
          <msup>
           <mrow>
            <mstyle mathvariant='script'><mi>J</mi>
            </mstyle>
           </mrow>
           <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

           </mrow>
          </msup>
         </mrow>
        </mrow>
       </msub>
       <msub>
        <mrow><mi>y</mi>
        </mrow>
        <mrow><mi>j</mi>
        </mrow>
       </msub>
       <msub>
        <mrow><mi>x</mi>
        </mrow>
        <mrow><mi>j</mi>
        </mrow>
       </msub>
      </mrow>
     </mtd>
    </mtr>
   </mtable><mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>)</mo>
  </mrow>
 </mrow></math> In Figures <a href="#fig_Example_">a</a> &amp; <a href="#fig_Example__3">d</a>, we observe that increasing the batch size has improved the convergence, however this is not a panacea. </div>
</div>

<div class="standard" id='magicparlabel-387'><br />

</div>

<div class="example" id='magicparlabel-388'><div class="example_item"><span class="example_label">Example 53.</span>
<a id="exa_The_SVRG_with" />
The SVRG with learning rate <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo>&gt;</mo><mn>0</mn>
  </mrow>
 </mrow></math> and batch size <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>m</mi><mo>=</mo><mn>1</mn>
  </mrow>
 </mrow></math> is</div>

<ul class="itemize" id='magicparlabel-389'><li class="itemize" style='text-align: left;'>For <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>t</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>...</mn>
  </mrow>
 </mrow></math> iterate:

<ol class="enumerate" id='magicparlabel-390'><li class="enumerate_item"><a id="enu_sample___and_2_1" />
 randomly generate a set <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msup>
    <mrow>
     <mstyle mathvariant='script'><mi>J</mi>
     </mstyle>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

   <msup>
    <mrow><mi>j</mi>
    </mrow>
    <mrow><mo>*</mo>
    </mrow>
   </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

  </mrow>
 </mrow></math> by drawing one number <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup>
   <mrow><mi>j</mi>
   </mrow>
   <mrow><mo>*</mo>
   </mrow>
  </msup>
 </mrow></math> from <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

  <mrow><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>n</mi><mo>=</mo><mn>1</mn>
   <msup>
    <mrow><mn>0</mn>
    </mrow>
    <mrow><mn>6</mn>
    </mrow>
   </msup>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

 </mrow></math>, and set <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow>
     <mover>
      <mrow>
       <mstyle mathvariant='script'><mi>S</mi>
       </mstyle>
      </mrow><mo stretchy="true">&tilde;</mo>
     </mover>
    </mrow>
    <mrow><mn>1</mn>
    </mrow>
   </msub><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

   <msub>
    <mrow><mi>z</mi>
    </mrow>
    <mrow>
     <msup>
      <mrow><mi>j</mi>
      </mrow>
      <mrow><mo>*</mo>
      </mrow>
     </msup>
    </mrow>
   </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

  </mrow>
 </mrow></math></li>
<li class="enumerate" style='text-align: left;'>compute <a id="eq_GD_UPDATE_MECHANISM_2_2_2" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow><mi>t</mi><mo>+</mo><mn>1</mn>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>[</mo>
     <mtable>
      <mtr>
       <mtd>
        <msubsup>
         <mrow><mi>w</mi>
         </mrow>
         <mrow><mn>1</mn>
         </mrow>
         <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
        </msubsup>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <msubsup>
         <mrow><mi>w</mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
         <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
        </msubsup>
       </mtd>
      </mtr>
     </mtable><mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>]</mo><mo>-</mo>
     <msub>
      <mrow><mi> &eta; </mi>
      </mrow>
      <mrow><mi>t</mi>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>[</mo>
      <mtable>
       <mtr>
        <mtd>
         <mrow><mn>2</mn><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

          <mrow>
           <msubsup>
            <mrow><mi>w</mi>
            </mrow>
            <mrow><mn>1</mn>
            </mrow>
            <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

            </mrow>
           </msubsup><mo>-</mo>
           <msubsup>
            <mrow>
             <mover>
              <mrow><mi>w</mi>
              </mrow><mo stretchy="true">&tilde;</mo>
             </mover>
            </mrow>
            <mrow><mn>1</mn>
            </mrow>
            <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

            </mrow>
           </msubsup>
          </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo><mn>2</mn>
          <msubsup>
           <mrow><mi>w</mi>
           </mrow>
           <mrow><mn>2</mn>
           </mrow>
           <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

           </mrow>
          </msubsup>
          <msub>
           <mrow><mi>x</mi>
           </mrow>
           <mrow>
            <msup>
             <mrow><mi>j</mi>
             </mrow>
             <mrow><mo>*</mo>
             </mrow>
            </msup>
           </mrow>
          </msub>
         </mrow>
        </mtd>
       </mtr>
       <mtr>
        <mtd>
         <mrow><mn>2</mn><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

          <mrow>
           <msubsup>
            <mrow><mi>w</mi>
            </mrow>
            <mrow><mn>2</mn>
            </mrow>
            <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

            </mrow>
           </msubsup><mo>-</mo>
           <msubsup>
            <mrow>
             <mover>
              <mrow><mi>w</mi>
              </mrow><mo stretchy="true">&tilde;</mo>
             </mover>
            </mrow>
            <mrow><mn>2</mn>
            </mrow>
            <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

            </mrow>
           </msubsup>
          </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

          <mover>
           <mrow><mi>x</mi>
           </mrow><mo stretchy="true">&OverBar;</mo>
          </mover><mo>+</mo><mn>2</mn><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

          <mrow>
           <msubsup>
            <mrow><mi>w</mi>
            </mrow>
            <mrow><mn>2</mn>
            </mrow>
            <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

            </mrow>
           </msubsup>
           <msup>
            <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

             <msub>
              <mrow><mi>x</mi>
              </mrow>
              <mrow>
               <msup>
                <mrow><mi>j</mi>
                </mrow>
                <mrow><mo>*</mo>
                </mrow>
               </msup>
              </mrow>
             </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

            </mrow>
            <mrow><mn>2</mn>
            </mrow>
           </msup><mo>-</mo>
           <msubsup>
            <mrow>
             <mover>
              <mrow><mi>w</mi>
              </mrow><mo stretchy="true">&tilde;</mo>
             </mover>
            </mrow>
            <mrow><mn>2</mn>
            </mrow>
            <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

            </mrow>
           </msubsup>
           <msup>
            <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

             <msub>
              <mrow><mi>x</mi>
              </mrow>
              <mrow>
               <msup>
                <mrow><mi>j</mi>
                </mrow>
                <mrow><mo>*</mo>
                </mrow>
               </msup>
              </mrow>
             </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

            </mrow>
            <mrow><mn>2</mn>
            </mrow>
           </msup>
          </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
        </mtd>
       </mtr>
      </mtable><mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>]</mo><mo>+</mo><mi> &nabla; </mi>
      <msub>
       <mrow>
        <mover>
         <mrow><mi>R</mi>
         </mrow><mo stretchy="true">&circ;</mo>
        </mover>
       </mrow>
       <mrow>
        <mstyle mathvariant='script'><mi>D</mi>
        </mstyle>
       </mrow>
      </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mover>
       <mrow><mi>w</mi>
       </mrow><mo stretchy="true">&tilde;</mo>
      </mover>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>(8.1)
   </mtd>
  </mtr>
 </mtable></math></li>
<li class="enumerate_item">if <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mstyle mathvariant='normal'>
    <mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>u</mi><mi>l</mi><mi>o</mi>
    </mrow>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>t</mi><mo>,</mo><mi> &kappa; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mn>0</mn>
  </mrow>
 </mrow></math>, 

<ol class="enumerate" id='magicparlabel-397'><li class="enumerate_item">set <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mover>
    <mrow><mi>w</mi>
    </mrow><mo stretchy="true">&tilde;</mo>
   </mover><mo>=</mo>
   <msup>
    <mrow><mi>w</mi>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup>
  </mrow>
 </mrow></math></li>
<li class="enumerate_item">compute <a id="eq_tyhtsstyrujey" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mfrac>
      <mrow><mn>1</mn>
      </mrow>
      <mrow><mi>n</mi>
      </mrow>
     </mfrac>
     <msubsup>
      <mrow><mo> &sum; </mo>
      </mrow>
      <mrow>
       <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
       </mrow>
      </mrow>
      <mrow><mi>n</mi>
      </mrow>
     </msubsup><mi> &ell; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <mover>
       <mrow><mi>w</mi>
       </mrow><mo stretchy="true">&tilde;</mo>
      </mover><mo>,</mo>
      <msub>
       <mrow><mi>z</mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>(</mo>
     <mtable>
      <mtr>
       <mtd>
        <mrow><mn>2</mn>
         <msubsup>
          <mrow>
           <mover>
            <mrow><mi>w</mi>
            </mrow><mo stretchy="true">&tilde;</mo>
           </mover>
          </mrow>
          <mrow><mn>1</mn>
          </mrow>
          <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

          </mrow>
         </msubsup><mo>+</mo><mn>2</mn>
         <msubsup>
          <mrow>
           <mover>
            <mrow><mi>w</mi>
            </mrow><mo stretchy="true">&tilde;</mo>
           </mover>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
          <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

          </mrow>
         </msubsup>
         <mover>
          <mrow><mi>x</mi>
          </mrow><mo stretchy="true">&OverBar;</mo>
         </mover><mo>-</mo><mn>2</mn>
         <mover>
          <mrow><mi>y</mi>
          </mrow><mo stretchy="true">&OverBar;</mo>
         </mover>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <mrow><mn>2</mn>
         <msubsup>
          <mrow>
           <mover>
            <mrow><mi>w</mi>
            </mrow><mo stretchy="true">&tilde;</mo>
           </mover>
          </mrow>
          <mrow><mn>1</mn>
          </mrow>
          <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

          </mrow>
         </msubsup>
         <mover>
          <mrow><mi>x</mi>
          </mrow><mo stretchy="true">&OverBar;</mo>
         </mover><mo>+</mo><mn>2</mn>
         <msubsup>
          <mrow>
           <mover>
            <mrow><mi>w</mi>
            </mrow><mo stretchy="true">&tilde;</mo>
           </mover>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
          <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

          </mrow>
         </msubsup>
         <mover>
          <mrow>
           <msup>
            <mrow><mi>x</mi>
            </mrow>
            <mrow><mn>2</mn>
            </mrow>
           </msup>
          </mrow><mo stretchy="true">&macr;</mo>
         </mover><mo>-</mo><mn>2</mn>
         <msup>
          <mrow><mi>y</mi>
          </mrow>
          <mrow><mi> &top; </mi>
          </mrow>
         </msup><mi>x</mi>
        </mrow>
       </mtd>
      </mtr>
     </mtable><mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>)</mo><mo>=</mo><mi> &nabla; </mi>
     <msub>
      <mrow>
       <mover>
        <mrow><mi>R</mi>
        </mrow><mo stretchy="true">&circ;</mo>
       </mover>
      </mrow>
      <mrow>
       <mstyle mathvariant='script'><mi>D</mi>
       </mstyle>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mover>
      <mrow><mi>w</mi>
      </mrow><mo stretchy="true">&tilde;</mo>
     </mover>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>(8.2)
   </mtd>
  </mtr>
 </mtable></math></li>
</ol>
</li><li class="enumerate" style='text-align: left;'>if a termination criterion is satisfied STOP</li>
</ol>
</li></ul>
<div class="standard" id='magicparlabel-404'>Because <a href="#eq_tyhtsstyrujey">(8.2)</a> is actually the gradient of the Risk function at <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mover>
   <mrow><mi>w</mi>
   </mrow><mo stretchy="true">&tilde;</mo>
  </mover>
 </mrow></math> and <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &nabla; </mi><mi> &ell; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msup>
     <mrow><mi>w</mi>
     </mrow>
     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </msup><mo>,</mo>
    <msub>
     <mrow><mi>z</mi>
     </mrow>
     <mrow>
      <msup>
       <mrow><mi>j</mi>
       </mrow>
       <mrow><mo>*</mo>
       </mrow>
      </msup>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>-</mo><mi> &nabla; </mi><mi> &ell; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <mover>
     <mrow><mi>w</mi>
     </mrow><mo stretchy="true">&tilde;</mo>
    </mover><mo>,</mo>
    <msub>
     <mrow><mi>z</mi>
     </mrow>
     <mrow>
      <msup>
       <mrow><mi>j</mi>
       </mrow>
       <mrow><mo>*</mo>
       </mrow>
      </msup>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>(</mo>
   <mtable>
    <mtr>
     <mtd>
      <mrow><mn>2</mn><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow>
        <msubsup>
         <mrow><mi>w</mi>
         </mrow>
         <mrow><mn>1</mn>
         </mrow>
         <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
        </msubsup><mo>-</mo>
        <msubsup>
         <mrow>
          <mover>
           <mrow><mi>w</mi>
           </mrow><mo stretchy="true">&tilde;</mo>
          </mover>
         </mrow>
         <mrow><mn>1</mn>
         </mrow>
         <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
        </msubsup>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo><mn>2</mn>
       <msubsup>
        <mrow><mi>w</mi>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
        <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </msubsup>
       <msub>
        <mrow><mi>x</mi>
        </mrow>
        <mrow>
         <msup>
          <mrow><mi>j</mi>
          </mrow>
          <mrow><mo>*</mo>
          </mrow>
         </msup>
        </mrow>
       </msub>
      </mrow>
     </mtd>
    </mtr>
    <mtr>
     <mtd>
      <mrow><mn>2</mn><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow>
        <msubsup>
         <mrow><mi>w</mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
         <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
        </msubsup><mo>-</mo>
        <msubsup>
         <mrow>
          <mover>
           <mrow><mi>w</mi>
           </mrow><mo stretchy="true">&tilde;</mo>
          </mover>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
         <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
        </msubsup>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       <mover>
        <mrow><mi>x</mi>
        </mrow><mo stretchy="true">&OverBar;</mo>
       </mover><mo>+</mo><mn>2</mn><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow>
        <msubsup>
         <mrow><mi>w</mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
         <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
        </msubsup>
        <msup>
         <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

          <msub>
           <mrow><mi>x</mi>
           </mrow>
           <mrow>
            <msup>
             <mrow><mi>j</mi>
             </mrow>
             <mrow><mo>*</mo>
             </mrow>
            </msup>
           </mrow>
          </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msup><mo>-</mo>
        <msubsup>
         <mrow>
          <mover>
           <mrow><mi>w</mi>
           </mrow><mo stretchy="true">&tilde;</mo>
          </mover>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
         <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
        </msubsup>
        <msup>
         <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

          <msub>
           <mrow><mi>x</mi>
           </mrow>
           <mrow>
            <msup>
             <mrow><mi>j</mi>
             </mrow>
             <mrow><mo>*</mo>
             </mrow>
            </msup>
           </mrow>
          </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msup>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </mtd>
    </mtr>
   </mtable><mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>)</mo>
  </mrow>
 </mrow></math>In Figure <a href="#fig_Example__2">c</a> we observe the frequency of the snapshots has improved the convergence; however this is not a panacea as seen in Figure <a href="#fig_Example__5">f</a>. </div>
</div>

<div class="standard" id='magicparlabel-405'><br />

</div>

<div class="example" id='magicparlabel-406'><div class="example_item"><span class="example_label">Example 54.</span>
<a id="exa_The_AdaGrad_with" />
The AdaGrad with <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo>=</mo><mn>1</mn>
  </mrow>
 </mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &epsi; </mi><mo>=</mo><mn>1</mn>
   <msup>
    <mrow><mn>0</mn>
    </mrow>
    <mrow>
     <mrow><mo>-</mo><mn>6</mn>
     </mrow>
    </mrow>
   </msup>
  </mrow>
 </mrow></math>, and batch size <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>m</mi><mo>=</mo><mn>1</mn>
  </mrow>
 </mrow></math> is</div>

<ul class="itemize" id='magicparlabel-407'><li class="itemize_item">Set <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>G</mi>
    </mrow>
    <mrow><mn>0</mn>
    </mrow>
   </msub><mo>=</mo>
   <msup>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mn>0</mn><mo>,</mo><mn>0</mn>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
    <mrow><mi> &top; </mi>
    </mrow>
   </msup>
  </mrow>
 </mrow></math>.</li>
<li class="itemize_item">For <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>t</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>...</mn>
  </mrow>
 </mrow></math> iterate:

<ol class="enumerate" id='magicparlabel-409'><li class="enumerate_item"><a id="enu_sample___and_2_1_1" />
 randomly generate a set <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msup>
    <mrow>
     <mstyle mathvariant='script'><mi>J</mi>
     </mstyle>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

   <msup>
    <mrow><mi>j</mi>
    </mrow>
    <mrow><mo>*</mo>
    </mrow>
   </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

  </mrow>
 </mrow></math> by drawing one number from <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

  <mrow><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>n</mi><mo>=</mo><mn>1</mn>
   <msup>
    <mrow><mn>0</mn>
    </mrow>
    <mrow><mn>6</mn>
    </mrow>
   </msup>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

 </mrow></math>, and set <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow>
     <mover>
      <mrow>
       <mstyle mathvariant='script'><mi>S</mi>
       </mstyle>
      </mrow><mo stretchy="true">&tilde;</mo>
     </mover>
    </mrow>
    <mrow><mn>1</mn>
    </mrow>
   </msub><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

   <msub>
    <mrow><mi>z</mi>
    </mrow>
    <mrow>
     <msup>
      <mrow><mi>j</mi>
      </mrow>
      <mrow><mo>*</mo>
      </mrow>
     </msup>
    </mrow>
   </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

  </mrow>
 </mrow></math></li>
<li class="enumerate" style='text-align: left;'><a id="enu_sample___and_3_1" />
compute<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <msub>
      <mrow><mi>v</mi>
      </mrow>
      <mrow><mi>t</mi>
      </mrow>
     </msub><mo>=</mo>
    </mrow>
   </mtd>
   <mtd><mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>(</mo>
    <mtable>
     <mtr>
      <mtd>
       <mrow><mn>2</mn>
        <msubsup>
         <mrow><mi>w</mi>
         </mrow>
         <mrow><mn>1</mn>
         </mrow>
         <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
        </msubsup><mo>+</mo><mn>2</mn>
        <msubsup>
         <mrow><mi>w</mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
         <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
        </msubsup>
        <msub>
         <mrow><mi>x</mi>
         </mrow>
         <mrow>
          <msup>
           <mrow><mi>j</mi>
           </mrow>
           <mrow><mo>*</mo>
           </mrow>
          </msup>
         </mrow>
        </msub><mo>-</mo><mn>2</mn>
        <msub>
         <mrow><mi>y</mi>
         </mrow>
         <mrow>
          <msup>
           <mrow><mi>j</mi>
           </mrow>
           <mrow><mo>*</mo>
           </mrow>
          </msup>
         </mrow>
        </msub>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mrow><mn>2</mn>
        <msubsup>
         <mrow><mi>w</mi>
         </mrow>
         <mrow><mn>1</mn>
         </mrow>
         <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
        </msubsup>
        <mover>
         <mrow><mi>x</mi>
         </mrow><mo stretchy="true">&OverBar;</mo>
        </mover><mo>+</mo><mn>2</mn>
        <msubsup>
         <mrow><mi>w</mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
         <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
        </msubsup>
        <msubsup>
         <mrow><mi>x</mi>
         </mrow>
         <mrow>
          <msup>
           <mrow><mi>j</mi>
           </mrow>
           <mrow><mo>*</mo>
           </mrow>
          </msup>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msubsup><mo>-</mo><mn>2</mn>
        <msub>
         <mrow><mi>y</mi>
         </mrow>
         <mrow>
          <msup>
           <mrow><mi>j</mi>
           </mrow>
           <mrow><mo>*</mo>
           </mrow>
          </msup>
         </mrow>
        </msub>
        <msub>
         <mrow><mi>x</mi>
         </mrow>
         <mrow>
          <msup>
           <mrow><mi>j</mi>
           </mrow>
           <mrow><mo>*</mo>
           </mrow>
          </msup>
         </mrow>
        </msub>
       </mrow>
      </mtd>
     </mtr>
    </mtable><mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>)</mo>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow>
     <msub>
      <mrow><mi>G</mi>
      </mrow>
      <mrow><mi>t</mi>
      </mrow>
     </msub><mo>=</mo>
    </mrow>
   </mtd>
   <mtd>
    <mrow>
     <msub>
      <mrow><mi>G</mi>
      </mrow>
      <mrow>
       <mrow><mi>t</mi><mo>-</mo><mn>1</mn>
       </mrow>
      </mrow>
     </msub><mo>+</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>(</mo>
     <mtable>
      <mtr>
       <mtd>
        <msubsup>
         <mrow><mi>v</mi>
         </mrow>
         <mrow>
          <mrow><mi>t</mi><mo>,</mo><mn>1</mn>
          </mrow>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msubsup>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <msubsup>
         <mrow><mi>v</mi>
         </mrow>
         <mrow>
          <mrow><mi>t</mi><mo>,</mo><mn>2</mn>
          </mrow>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msubsup>
       </mtd>
      </mtr>
     </mtable><mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>)</mo>
    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <msup>
     <mrow><mi>w</mi>
     </mrow>
     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi>t</mi><mo>+</mo><mn>1</mn>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </msup>
   </mtd>
   <mtd>
    <mrow><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>(</mo>
     <mtable>
      <mtr>
       <mtd>
        <mrow>
         <msubsup>
          <mrow><mi>w</mi>
          </mrow>
          <mrow><mn>1</mn>
          </mrow>
          <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

          </mrow>
         </msubsup><mo>-</mo>
         <mfrac>
          <mrow>
           <msub>
            <mrow><mi> &eta; </mi>
            </mrow>
            <mrow><mi>t</mi>
            </mrow>
           </msub>
          </mrow>
          <mrow>
           <msqrt>
            <mrow>
             <msub>
              <mrow><mi>G</mi>
              </mrow>
              <mrow>
               <mrow><mi>t</mi><mo>,</mo><mn>1</mn>
               </mrow>
              </mrow>
             </msub><mo>+</mo><mi> &epsi; </mi>
            </mrow>
           </msqrt>
          </mrow>
         </mfrac>
         <msub>
          <mrow><mi>v</mi>
          </mrow>
          <mrow>
           <mrow><mi>t</mi><mo>,</mo><mn>1</mn>
           </mrow>
          </mrow>
         </msub>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <mrow>
         <msubsup>
          <mrow><mi>w</mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
          <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

          </mrow>
         </msubsup><mo>-</mo>
         <mfrac>
          <mrow>
           <msub>
            <mrow><mi> &eta; </mi>
            </mrow>
            <mrow><mi>t</mi>
            </mrow>
           </msub>
          </mrow>
          <mrow>
           <msqrt>
            <mrow>
             <msub>
              <mrow><mi>G</mi>
              </mrow>
              <mrow>
               <mrow><mi>t</mi><mo>,</mo><mn>2</mn>
               </mrow>
              </mrow>
             </msub><mo>+</mo><mi> &epsi; </mi>
            </mrow>
           </msqrt>
          </mrow>
         </mfrac>
         <msub>
          <mrow><mi>v</mi>
          </mrow>
          <mrow>
           <mrow><mi>t</mi><mo>,</mo><mn>2</mn>
           </mrow>
          </mrow>
         </msub>
        </mrow>
       </mtd>
      </mtr>
     </mtable><mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>)</mo><mo>,</mo>
    </mrow>
   </mtd>
  </mtr>
 </mtable></math></li>
<li class="enumerate_item">if <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>t</mi><mo> &ge; </mo><mi>T</mi><mo>=</mo><mn>1000</mn>
  </mrow>
 </mrow></math> STOP</li>
</ol>
</li></ul>
<div class="standard" id='magicparlabel-416'>because <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>v</mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo>=</mo><mi> &nabla; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

   <mrow><mi> &nabla; </mi><mi> &ell; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow>
     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup><mo>,</mo>
     <msub>
      <mrow><mi>z</mi>
      </mrow>
      <mrow>
       <msup>
        <mrow><mi>j</mi>
        </mrow>
        <mrow><mo>*</mo>
        </mrow>
       </msup>
      </mrow>
     </msub>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>
<mo>=</mo><mn>...</mn><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>(</mo>
   <mtable>
    <mtr>
     <mtd>
      <mrow><mn>2</mn>
       <msubsup>
        <mrow><mi>w</mi>
        </mrow>
        <mrow><mn>1</mn>
        </mrow>
        <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </msubsup><mo>+</mo><mn>2</mn>
       <msubsup>
        <mrow><mi>w</mi>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
        <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </msubsup>
       <msub>
        <mrow><mi>x</mi>
        </mrow>
        <mrow>
         <msup>
          <mrow><mi>j</mi>
          </mrow>
          <mrow><mo>*</mo>
          </mrow>
         </msup>
        </mrow>
       </msub><mo>-</mo><mn>2</mn>
       <msub>
        <mrow><mi>y</mi>
        </mrow>
        <mrow>
         <msup>
          <mrow><mi>j</mi>
          </mrow>
          <mrow><mo>*</mo>
          </mrow>
         </msup>
        </mrow>
       </msub>
      </mrow>
     </mtd>
    </mtr>
    <mtr>
     <mtd>
      <mrow><mn>2</mn>
       <msubsup>
        <mrow><mi>w</mi>
        </mrow>
        <mrow><mn>1</mn>
        </mrow>
        <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </msubsup>
       <mover>
        <mrow><mi>x</mi>
        </mrow><mo stretchy="true">&OverBar;</mo>
       </mover><mo>+</mo><mn>2</mn>
       <msubsup>
        <mrow><mi>w</mi>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
        <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </msubsup>
       <msubsup>
        <mrow><mi>x</mi>
        </mrow>
        <mrow>
         <msup>
          <mrow><mi>j</mi>
          </mrow>
          <mrow><mo>*</mo>
          </mrow>
         </msup>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
       </msubsup><mo>-</mo><mn>2</mn>
       <msub>
        <mrow><mi>y</mi>
        </mrow>
        <mrow>
         <msup>
          <mrow><mi>j</mi>
          </mrow>
          <mrow><mo>*</mo>
          </mrow>
         </msup>
        </mrow>
       </msub>
       <msub>
        <mrow><mi>x</mi>
        </mrow>
        <mrow>
         <msup>
          <mrow><mi>j</mi>
          </mrow>
          <mrow><mo>*</mo>
          </mrow>
         </msup>
        </mrow>
       </msub>
      </mrow>
     </mtd>
    </mtr>
   </mtable><mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>)</mo>
  </mrow>
 </mrow></math> In Figures <a href="#fig_Example__1_1">g</a> &amp; <a href="#fig_Example__1_1_1">h</a>, we see that AdaGrad with <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &eta; </mi><mo>=</mo><mn>1</mn>
  </mrow>
 </mrow></math> works (I did not try to tune it), however to make vanilla SGD to work I have to tune <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &eta; </mi><mo>=</mo><mn>0.03</mn>
  </mrow>
 </mrow></math>otherwise for <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &eta; </mi><mo>=</mo><mn>1.0</mn>
  </mrow>
 </mrow></math> it did not work. </div>
</div>

<div class="standard" id='magicparlabel-417'><br />

</div>

<div class="example" id='magicparlabel-418'><div class="example_item"><span class="example_label">Example 55.</span>
<a id="exa_Consider_a__rather" />
Consider a (rather naive) loss function <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &ell; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>w</mi><mo>,</mo><mi>z</mi><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow><mi>x</mi><mo>,</mo><mi>y</mi>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mo>-</mo>
   <mstyle mathvariant='normal'>
    <mrow><mi>c</mi><mi>o</mi><mi>s</mi>
    </mrow>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mn>0.5</mn><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow><mi>y</mi><mo>-</mo>
     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mi> &top; </mi>
      </mrow>
     </msup><mi>x</mi>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>, a hypothesis class <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mstyle mathvariant='script'><mi>H</mi>
   </mstyle><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

   <mrow><mi>w</mi><mo> &isin; </mo>
    <msup>
     <mrow>
      <mstyle mathvariant='double-struck'><mi>R</mi>
      </mstyle>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msup><mo>:</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>&par;</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&par;</mo>
<mo> &le; </mo><mn>1.5</mn>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

  </mrow>
 </mrow></math>, and assume that inputs <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>x</mi>
 </mrow></math> in dataset <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='script'><mi>D</mi>
  </mstyle>
 </mrow></math> are such that <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>x</mi><mo> &isin; </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

   <mrow><mo>-</mo><mn>1</mn><mo>,</mo><mn>1</mn>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

  </mrow>
 </mrow></math>. Note that <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo>-</mo>
   <mstyle mathvariant='normal'>
    <mrow><mi>c</mi><mi>o</mi><mi>s</mi>
    </mrow>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mo> &sdot; </mo>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> is convex in <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

  <mrow><mo>-</mo><mn>1.5</mn><mo>,</mo><mn>1.5</mn>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

 </mrow></math> and non-convex in <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='double-struck'><mi>R</mi>
  </mstyle>
 </mrow></math>. Consider learning rate <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo>=</mo><mn>50</mn><mo>/</mo><mi>t</mi>
  </mrow>
 </mrow></math> reducing to zero, and seed <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msup>
    <mrow><mi>w</mi>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mn>0</mn>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mn>1.5</mn><mo>,</mo><mn>1.5</mn>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>. An unconstrained SGD may produce a minimizer/solution outside <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='script'><mi>H</mi>
  </mstyle>
 </mrow></math>. We can design the online SGD (batch size <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>m</mi><mo>=</mo><mn>1</mn>
  </mrow>
 </mrow></math>) with projection to <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='script'><mi>H</mi>
  </mstyle>
 </mrow></math> as</div>
</div>

<ul class="itemize" id='magicparlabel-419'><li class="itemize_item">For <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>t</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>...</mn>
  </mrow>
 </mrow></math> iterate:

<ol class="enumerate" id='magicparlabel-420'><li class="enumerate_item"><a id="enu_sample___and_2_1_1_1" />
 randomly generate a set <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msup>
    <mrow>
     <mstyle mathvariant='script'><mi>J</mi>
     </mstyle>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

   <msup>
    <mrow><mi>j</mi>
    </mrow>
    <mrow><mo>*</mo>
    </mrow>
   </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

  </mrow>
 </mrow></math> by drawing one number from <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

  <mrow><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>n</mi><mo>=</mo><mn>1</mn>
   <msup>
    <mrow><mn>0</mn>
    </mrow>
    <mrow><mn>6</mn>
    </mrow>
   </msup>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

 </mrow></math>, and set <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow>
     <mover>
      <mrow>
       <mstyle mathvariant='script'><mi>S</mi>
       </mstyle>
      </mrow><mo stretchy="true">&tilde;</mo>
     </mover>
    </mrow>
    <mrow><mn>1</mn>
    </mrow>
   </msub><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

   <msub>
    <mrow><mi>z</mi>
    </mrow>
    <mrow>
     <msup>
      <mrow><mi>j</mi>
      </mrow>
      <mrow><mo>*</mo>
      </mrow>
     </msup>
    </mrow>
   </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

  </mrow>
 </mrow></math></li>
<li class="enumerate" style='text-align: left;'><a id="enu_sample___and_3_1_1" />
compute<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow><mi>t</mi><mo>+</mo><mn>1</mn><mo>/</mo><mn>2</mn>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup><mo>=</mo>
    </mrow>
   </mtd>
   <mtd>
    <mrow>
     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup><mo>-</mo>
     <mfrac>
      <mrow><mn>50</mn>
      </mrow>
      <mrow><mi>t</mi>
      </mrow>
     </mfrac><mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>(</mo>
     <mtable>
      <mtr>
       <mtd>
        <mrow><mo>-</mo><mo> cos </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <mrow>
          <msub>
           <mrow><mi>y</mi>
           </mrow>
           <mrow>
            <msup>
             <mrow><mi>j</mi>
             </mrow>
             <mrow><mo>*</mo>
             </mrow>
            </msup>
           </mrow>
          </msub><mo>-</mo>
          <msubsup>
           <mrow><mi>w</mi>
           </mrow>
           <mrow><mn>1</mn>
           </mrow>
           <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

           </mrow>
          </msubsup><mo>-</mo>
          <msubsup>
           <mrow><mi>w</mi>
           </mrow>
           <mrow><mn>2</mn>
           </mrow>
           <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

           </mrow>
          </msubsup>
          <msub>
           <mrow><mi>x</mi>
           </mrow>
           <mrow>
            <msup>
             <mrow><mi>j</mi>
             </mrow>
             <mrow><mo>*</mo>
             </mrow>
            </msup>
           </mrow>
          </msub>
         </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <mrow><mo>-</mo><mo> cos </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <mrow>
          <msub>
           <mrow><mi>y</mi>
           </mrow>
           <mrow>
            <msup>
             <mrow><mi>j</mi>
             </mrow>
             <mrow><mo>*</mo>
             </mrow>
            </msup>
           </mrow>
          </msub><mo>-</mo>
          <msubsup>
           <mrow><mi>w</mi>
           </mrow>
           <mrow><mn>1</mn>
           </mrow>
           <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

           </mrow>
          </msubsup><mo>-</mo>
          <msubsup>
           <mrow><mi>w</mi>
           </mrow>
           <mrow><mn>2</mn>
           </mrow>
           <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

           </mrow>
          </msubsup>
          <msub>
           <mrow><mi>x</mi>
           </mrow>
           <mrow>
            <msup>
             <mrow><mi>j</mi>
             </mrow>
             <mrow><mo>*</mo>
             </mrow>
            </msup>
           </mrow>
          </msub>
         </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         <msub>
          <mrow><mi>x</mi>
          </mrow>
          <mrow>
           <msup>
            <mrow><mi>j</mi>
            </mrow>
            <mrow><mo>*</mo>
            </mrow>
           </msup>
          </mrow>
         </msub>
        </mrow>
       </mtd>
      </mtr>
     </mtable><mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>)</mo>
    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow>
     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow><mi>t</mi><mo>+</mo><mn>1</mn><mo>/</mo><mn>2</mn>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup><mo>=</mo>
    </mrow>
   </mtd>
   <mtd>
    <mrow><mo> arg </mo>
     <msub>
      <mrow><mo> min </mo>
      </mrow>
      <mrow>
       <mrow><mi> &forall; </mi><mi>w</mi><mo>:</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>&par;</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&par;</mo>
<mo> &le; </mo><mn>1.5</mn>
       </mrow>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mo form='prefix' fence='true' stretchy='true' symmetric='true'>&par;</mo>

     <mrow><mi>w</mi><mo>-</mo>
      <msup>
       <mrow><mi>w</mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>t</mi><mo>+</mo><mn>1</mn><mo>/</mo><mn>2</mn>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&par;</mo>

<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
  </mtr>
 </mtable></math></li>
<li class="enumerate_item">if <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>t</mi><mo> &ge; </mo><mi>T</mi><mo>=</mo><mn>1000</mn>
  </mrow>
 </mrow></math> STOP</li>
</ol>
<div class="standard" id='magicparlabel-427'>because <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>v</mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo>=</mo><mi> &nabla; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

   <mrow><mi> &nabla; </mi><mi> &ell; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow>
     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup><mo>,</mo>
     <msub>
      <mrow><mi>z</mi>
      </mrow>
      <mrow>
       <msup>
        <mrow><mi>j</mi>
        </mrow>
        <mrow><mo>*</mo>
        </mrow>
       </msup>
      </mrow>
     </msub>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>
<mo>=</mo><mn>...</mn><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>(</mo>
   <mtable>
    <mtr>
     <mtd>
      <mrow><mo>-</mo><mo> cos </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow>
        <msub>
         <mrow><mi>y</mi>
         </mrow>
         <mrow>
          <msup>
           <mrow><mi>j</mi>
           </mrow>
           <mrow><mo>*</mo>
           </mrow>
          </msup>
         </mrow>
        </msub><mo>-</mo>
        <msubsup>
         <mrow><mi>w</mi>
         </mrow>
         <mrow><mn>1</mn>
         </mrow>
         <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
        </msubsup><mo>-</mo>
        <msubsup>
         <mrow><mi>w</mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
         <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
        </msubsup>
        <msub>
         <mrow><mi>x</mi>
         </mrow>
         <mrow>
          <msup>
           <mrow><mi>j</mi>
           </mrow>
           <mrow><mo>*</mo>
           </mrow>
          </msup>
         </mrow>
        </msub>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </mtd>
    </mtr>
    <mtr>
     <mtd>
      <mrow><mo>-</mo><mo> cos </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow>
        <msub>
         <mrow><mi>y</mi>
         </mrow>
         <mrow>
          <msup>
           <mrow><mi>j</mi>
           </mrow>
           <mrow><mo>*</mo>
           </mrow>
          </msup>
         </mrow>
        </msub><mo>-</mo>
        <msubsup>
         <mrow><mi>w</mi>
         </mrow>
         <mrow><mn>1</mn>
         </mrow>
         <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
        </msubsup><mo>-</mo>
        <msubsup>
         <mrow><mi>w</mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
         <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
        </msubsup>
        <msub>
         <mrow><mi>x</mi>
         </mrow>
         <mrow>
          <msup>
           <mrow><mi>j</mi>
           </mrow>
           <mrow><mo>*</mo>
           </mrow>
          </msup>
         </mrow>
        </msub>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       <msub>
        <mrow><mi>x</mi>
        </mrow>
        <mrow>
         <msup>
          <mrow><mi>j</mi>
          </mrow>
          <mrow><mo>*</mo>
          </mrow>
         </msup>
        </mrow>
       </msub>
      </mrow>
     </mtd>
    </mtr>
   </mtable><mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>)</mo>
  </mrow>
 </mrow></math>In Figures <a href="#fig_Example__1">b</a> &amp; <a href="#fig_Example__4">e</a>, we observe that the SGD got trapped outside <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='script'><mi>H</mi>
  </mstyle>
 </mrow></math> due to the unreasonably large learning rate at the beginning of the iterations, while the SGD with projection step managed to stay in <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='script'><mi>H</mi>
  </mstyle>
 </mrow></math> and converge. </div>
</li></ul>

<div class="standard" id='magicparlabel-428'><br />

</div>



<div class='float-figure'><div class='float-figure'><div class="plain_layout" id='magicparlabel-437'><img style='width:33%;' src='0_extra_tmp_mffk55_Dropbox_Teaching_2023_term2____ures_03_Stochastic_gradient_descent_SGD_w_1.png' alt='image: 0_extra_tmp_mffk55_Dropbox_Teaching_2023_term2____ures_03_Stochastic_gradient_descent_SGD_w_1.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure a:  <a id="fig_Example_" />
batch SGD Example <a href="#exa_The_batch_SGD">52</a> <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>w</mi>
   </mrow>
   <mrow><mn>1</mn>
   </mrow>
  </msub>
 </mrow></math></span></div>
</div>
<div class='float-figure'><div class="plain_layout" id='magicparlabel-445'><img style='width:33%;' src='1_extra_tmp_mffk55_Dropbox_Teaching_2023_term2_____03_Stochastic_gradient_descent_projSGD_w_2.png' alt='image: 1_extra_tmp_mffk55_Dropbox_Teaching_2023_term2_____03_Stochastic_gradient_descent_projSGD_w_2.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure b:  <a id="fig_Example__1" />
online SGD with projection Example <a href="#exa_Consider_a__rather">55</a><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>w</mi>
   </mrow>
   <mrow><mn>1</mn>
   </mrow>
  </msub>
 </mrow></math></span></div>
</div>
<div class='float-figure'><div class="plain_layout" id='magicparlabel-453'><img style='width:33%;' src='2_extra_tmp_mffk55_Dropbox_Teaching_2023_term2____res_03_Stochastic_gradient_descent_SVRG_w_1.png' alt='image: 2_extra_tmp_mffk55_Dropbox_Teaching_2023_term2____res_03_Stochastic_gradient_descent_SVRG_w_1.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure c:  <a id="fig_Example__2" />
SVRG Example <a href="#exa_The_SVRG_with">53</a> <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>w</mi>
   </mrow>
   <mrow><mn>1</mn>
   </mrow>
  </msub>
 </mrow></math></span></div>
</div>



<div class='float-figure'><div class="plain_layout" id='magicparlabel-462'><img style='width:33%;' src='0_extra_tmp_mffk55_Dropbox_Teaching_2023_term2____ures_03_Stochastic_gradient_descent_SGD_w_1.png' alt='image: 0_extra_tmp_mffk55_Dropbox_Teaching_2023_term2____ures_03_Stochastic_gradient_descent_SGD_w_1.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure d:  <a id="fig_Example__3" />
batch SGD Example <a href="#exa_The_batch_SGD">52</a> <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>w</mi>
   </mrow>
   <mrow><mn>2</mn>
   </mrow>
  </msub>
 </mrow></math></span></div>
</div>
<div class='float-figure'><div class="plain_layout" id='magicparlabel-470'><img style='width:33%;' src='1_extra_tmp_mffk55_Dropbox_Teaching_2023_term2_____03_Stochastic_gradient_descent_projSGD_w_2.png' alt='image: 1_extra_tmp_mffk55_Dropbox_Teaching_2023_term2_____03_Stochastic_gradient_descent_projSGD_w_2.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure e:  <a id="fig_Example__4" />
online SGD with projection Example <a href="#exa_Consider_a__rather">55</a> <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>w</mi>
   </mrow>
   <mrow><mn>2</mn>
   </mrow>
  </msub>
 </mrow></math></span></div>
</div>
<div class='float-figure'><div class="plain_layout" id='magicparlabel-478'><img style='width:33%;' src='3_extra_tmp_mffk55_Dropbox_Teaching_2023_term2____res_03_Stochastic_gradient_descent_SVRG_w_2.png' alt='image: 3_extra_tmp_mffk55_Dropbox_Teaching_2023_term2____res_03_Stochastic_gradient_descent_SVRG_w_2.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure f:  <a id="fig_Example__5" />
SVRG Example <a href="#exa_The_SVRG_with">53</a> <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>w</mi>
   </mrow>
   <mrow><mn>2</mn>
   </mrow>
  </msub>
 </mrow></math></span></div>
</div>



<div class='float-figure'><div class="plain_layout" id='magicparlabel-487'><img style='width:33%;' src='4_extra_tmp_mffk55_Dropbox_Teaching_2023_term2_____03_Stochastic_gradient_descent_AdaGrad_w_1.png' alt='image: 4_extra_tmp_mffk55_Dropbox_Teaching_2023_term2_____03_Stochastic_gradient_descent_AdaGrad_w_1.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure g:  <a id="fig_Example__1_1" />
online AdaGrad Example <a href="#exa_The_AdaGrad_with">54</a><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>w</mi>
   </mrow>
   <mrow><mn>1</mn>
   </mrow>
  </msub>
 </mrow></math></span></div>
</div>
<div class='float-figure'><div class="plain_layout" id='magicparlabel-495'><img style='width:33%;' src='5_extra_tmp_mffk55_Dropbox_Teaching_2023_term2_____03_Stochastic_gradient_descent_AdaGrad_w_2.png' alt='image: 5_extra_tmp_mffk55_Dropbox_Teaching_2023_term2_____03_Stochastic_gradient_descent_AdaGrad_w_2.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure h:  <a id="fig_Example__1_1_1" />
online AdaGrad Example <a href="#exa_The_AdaGrad_with">54</a><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>w</mi>
   </mrow>
   <mrow><mn>2</mn>
   </mrow>
  </msub>
 </mrow></math></span></div>
</div>


<div class="plain_layout" id='magicparlabel-500'><span class='float-caption-Standard float-caption float-caption-standard'>Figure 8.1:  Simulations of the Examples </span></div>


</div>

</body>
</html>
