<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN" "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="GENERATOR" content="LyX 2.3.6.1" />
<meta http-equiv="Content-type" content="text/html;charset=UTF-8" />
<title>LyX Document</title>
<style type='text/css'>
/* Layout-provided Styles */
div.standard {
text-align: left;

}
div.plain_layout {
text-align: left;

}
h3.subsection_ {
font-weight: bold;
font-size: medium;
margin-top: 0.9ex;
margin-bottom: 0.5ex;
text-align: left;

}
ol.enumerate {
margin-top: 0.7ex;
margin-bottom: 0.7ex;
margin-left: 3ex;
text-align: left;

}
ul.itemize {
margin-top: 0.7ex;
margin-bottom: 0.7ex;
margin-left: 3ex;
text-align: left;

}
h2.section {
font-weight: normal;
font-style: normal;
font-variant: small-caps;
font-size: medium;
margin-top: 1.3ex;
margin-bottom: 0.7ex;
text-align: center;

}
div.theorem {
font-style: italic;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.theorem_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
div.remark {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.remark_label {
font-weight: normal;
font-style: italic;
font-variant: normal;
font-size: medium;

}
div.note {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.note_label {
font-weight: normal;
font-style: italic;
font-variant: normal;
font-size: medium;

}
div.problem {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.problem_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
div.algorithm {
font-style: italic;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.algorithm_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
div.condition {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.condition_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
dl.description dt { font-weight: bold; }
div.Shadowbox { border: solid gray medium; border-bottom: solid black 1ex; border-right: solid black 1ex; padding: 0.5ex; }
div.Boxed {
	border: solid thick black;
	padding: 0.5ex;
}
span.foot_label {
	vertical-align: super;
	font-size: smaller;
	font-weight: bold;
	text-decoration: underline;
}
div.foot {
	display: inline;
	font-size: small;
	font-weight: medium;
	font-family: serif;
	font-variant: normal;
	font-style: normal;
}
div.foot_inner { display: none; }
div.foot:hover div.foot_inner {
	display: block;
	border: 1px double black;
	margin: 0em 1em;
	padding: 1em;
}
span.flex_url {
font-family: monospace;
}
div.float {
	border: 2px solid black;
	text-align: center;
}
div.float-caption {
	text-align: center;
	border: 2px solid black;
	padding: 1ex;
	margin: 1ex;
}


</style>
</head>
<body dir="auto">


<div class="standard" id='magicparlabel-1'><div class='Shadowbox'><div class="plain_layout" id='magicparlabel-10'>Machine Learning and Neural Networks (MATH3431)&nbsp;&nbsp;Epiphany term, 2023<div style='height:3ex'></div></div>

<div class="plain_layout" style='text-align: center;' id='magicparlabel-11'> Handout 4: Bayesian Learning via 
<br />

Stochastic gradient and 
<br />

Stochastic gradient Langevin dynamics <div style='height:3ex'></div></div>

<div class="plain_layout" id='magicparlabel-20'>Lecturer &amp; author: Georgios P. Karagiannis <a href="georgios.karagiannis@durham.ac.uk">georgios.karagiannis@durham.ac.uk</a></div>

<div class="plain_layout" id='magicparlabel-21'><hr />

<div style='height:3ex'></div></div>
<h3 class="subsection_" id='magicparlabel-22'>Aim</h3>
<div class="plain_layout" id='magicparlabel-23'>To introduce the Bayesian Learning, and Stochastic gradient Langevin dynamics (description, heuristics, and implementation). Stochastic gradient descent will be implemented in the Bayesian learning too. </div>

<div class="plain_layout" id='magicparlabel-24'><hr />

<div style='height:3ex'></div></div>
<h3 class="subsection_" id='magicparlabel-25'>Reading list &amp; references:</h3>

<ol class="enumerate" id='magicparlabel-26'><li class="enumerate_item">Welling, M., &amp; Teh, Y. W. (2011). Bayesian learning via stochastic gradient Langevin dynamics. In Proceedings of the 28th international conference on machine learning (ICML-11) (pp. 681-688).</li>
<li class="enumerate_item">Bottou, L. (2012). Stochastic gradient descent tricks. In Neural networks: Tricks of the trade (pp. 421-436). Springer, Berlin, Heidelberg.</li>
</ol>


<ul class="itemize" id='magicparlabel-34'><li class="itemize_item">Sato, I., &amp; Nakagawa, H. (2014). Approximation analysis of stochastic gradient Langevin dynamics by using Fokker-Planck equation and Ito process. In International Conference on Machine Learning (pp. 982-990). PMLR. </li>
<li class="itemize_item">Teh, Y. W., Thiery, A. H., &amp; Vollmer, S. J. (2016). Consistency and fluctuations for stochastic gradient Langevin dynamics. Journal of Machine Learning Research, 17.</li>
<li class="itemize_item">Vollmer, S. J., Zygalakis, K. C., &amp; Teh, Y. W. (2016). Exploration of the (non-) asymptotic bias and variance of stochastic gradient Langevin dynamics. The Journal of Machine Learning Research, 17(1), 5504-5548. –&gt;further reading for theory</li>
<li class="itemize_item">Nemeth, C., &amp; Fearnhead, P. (2021). Stochastic gradient Markov chain Monte Carlo. Journal of the American Statistical Association, 116(533), 433-450.</li>
</ul>

</div></div>
<h2 class="section" id='magicparlabel-43'><span class="section_label">1</span> Bayesian learning and motivations</h2>

<div class="remark" id='magicparlabel-44'><div class="remark_item"><span class="remark_label">Remark 1.</span>
Bayesian methods are appealing in their ability to capture uncertainty in learned parameters and avoid overﬁtting. Arguably with large datasets there will be little overﬁtting. Alternatively, as we have access to larger datasets and more computational resources, we become interested in building more complex models (eg from a logistic regression to a deep neural network), so that there will always be a need to quantify the amount of parameter uncertainty.</div>
</div>

<div class="standard" id='magicparlabel-45'><br />

</div>

<div class="note" id='magicparlabel-46'><div class="note_item"><span class="note_label">Note 2.</span>
<a id="note_Consider_a_Bayesian" />
Consider a Bayesian statistical model with sampling distribution (statistical model) <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>z</mi><mo>|</mo><mi>w</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> labeled by an unknown parameter <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>w</mi><mo> &isin; </mo><mo> &Theta; </mo><mo> &sube; </mo>
   <msup>
    <mrow>
     <mstyle mathvariant='double-struck'><mi>R</mi>
     </mstyle>
    </mrow>
    <mrow><mi>d</mi>
    </mrow>
   </msup>
  </mrow>
 </mrow></math> that follows a prior distribution <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>. Assume a dataset <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow>
     <mstyle mathvariant='script'><mi>S</mi>
     </mstyle>
    </mrow>
    <mrow><mi>n</mi>
    </mrow>
   </msub><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

   <mrow>
    <msub>
     <mrow><mi>z</mi>
     </mrow>
     <mrow><mi>i</mi>
     </mrow>
    </msub><mo>;</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>n</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

  </mrow>
 </mrow></math> of size <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>n</mi>
 </mrow></math> containing independently drawn examples. Let <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>L</mi>
    </mrow>
    <mrow><mi>n</mi>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>:</mo><mo>=</mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>z</mi>
     </mrow>
     <mrow>
      <mrow><mn>1</mn><mo>:</mo><mi>n</mi>
      </mrow>
     </mrow>
    </msub><mo>|</mo><mi>w</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> denote the likelihood of the observables <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msubsup>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

    <mrow>
     <msub>
      <mrow><mi>z</mi>
      </mrow>
      <mrow><mi>i</mi>
      </mrow>
     </msub><mo> &isin; </mo>
     <mstyle mathvariant='script'><mi>Z</mi>
     </mstyle>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

   </mrow>
   <mrow>
    <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
    </mrow>
   </mrow>
   <mrow><mi>n</mi>
   </mrow>
  </msubsup>
 </mrow></math> give parameter <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>w</mi>
 </mrow></math>. The Bayesian model is denoted as<a id="eq_" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>
    <mtable>
     <mtr>
      <mtd>
       <mrow>
        <msub>
         <mrow><mi>z</mi>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
        </msub><mo>|</mo><mi>w</mi>
       </mrow>
      </mtd>
      <mtd>
       <mrow><mover accent='false'><mo> &sim; </mo></mover><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow>
         <msub>
          <mrow><mi>z</mi>
          </mrow>
          <mrow>
           <mrow><mn>1</mn><mo>:</mo><mi>n</mi>
           </mrow>
          </mrow>
         </msub><mo>|</mo><mi>w</mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>,</mo>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd><mi>w</mi>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </mtd>
   <mtd><mrow/>
   </mtd>
   <mtd>(1.1)
   </mtd>
  </mtr>
 </mtable></math></div>
</div>

<div class="standard" id='magicparlabel-47'><br />

</div>

<div class="note" id='magicparlabel-48'><div class="note_item"><span class="note_label">Note 3.</span>
With regards to the Bayesian model in Note <a href="#note_Consider_a_Bayesian">2</a>, we denote the likelihood of the observables <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msubsup>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

    <mrow>
     <msub>
      <mrow><mi>z</mi>
      </mrow>
      <mrow><mi>i</mi>
      </mrow>
     </msub><mo> &isin; </mo>
     <mstyle mathvariant='script'><mi>Z</mi>
     </mstyle>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

   </mrow>
   <mrow>
    <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
    </mrow>
   </mrow>
   <mrow><mi>n</mi>
   </mrow>
  </msubsup>
 </mrow></math> given the parameter <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>w</mi>
 </mrow></math> as <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>L</mi>
    </mrow>
    <mrow><mi>n</mi>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>:</mo><mo>=</mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>z</mi>
     </mrow>
     <mrow>
      <mrow><mn>1</mn><mo>:</mo><mi>n</mi>
      </mrow>
     </mrow>
    </msub><mo>|</mo><mi>w</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math></div>
</div>

<div class="standard" id='magicparlabel-49'><br />

</div>

<div class="remark" id='magicparlabel-50'><div class="remark_item"><span class="remark_label">Remark 4.</span>
<a id="rem_Bayesian_learning_heavily" />
Bayesian learning (inference) relies on the posterior distribution density <a id="eq__1" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>w</mi><mo>|</mo>
      <msub>
       <mrow><mi>z</mi>
       </mrow>
       <mrow>
        <mrow><mn>1</mn><mo>:</mo><mi>n</mi>
        </mrow>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
     <mfrac>
      <mrow>
       <mrow>
        <msub>
         <mrow><mi>L</mi>
         </mrow>
         <mrow><mi>n</mi>
         </mrow>
        </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow>
      <mrow>
       <mrow><mo> &int; </mo>
        <msub>
         <mrow><mi>L</mi>
         </mrow>
         <mrow><mi>n</mi>
         </mrow>
        </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        <mstyle mathvariant='normal'><mi>d</mi>
        </mstyle><mi>w</mi>
       </mrow>
      </mrow>
     </mfrac>
    </mrow>
   </mtd>
   <mtd>(1.2)
   </mtd>
  </mtr>
 </mtable></math> which quantifies the researcher's belief (or uncertainty) about the unknown parameter <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>w</mi>
 </mrow></math> learned given examples <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msubsup>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

    <mrow>
     <msub>
      <mrow><mi>z</mi>
      </mrow>
      <mrow><mi>i</mi>
      </mrow>
     </msub><mo> &isin; </mo>
     <mstyle mathvariant='script'><mi>Z</mi>
     </mstyle>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

   </mrow>
   <mrow>
    <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
    </mrow>
   </mrow>
   <mrow><mi>n</mi>
   </mrow>
  </msubsup>
 </mrow></math>. It is often intractable; hence there is often a need to numerically compute it. (Section <a href="#sec_Full_Bayesian_learning">3</a>)</div>
</div>

<div class="standard" id='magicparlabel-51'><br />

</div>

<div class="remark" id='magicparlabel-52'><div class="remark_item"><span class="remark_label">Remark 5.</span>
<a id="enu_a_posteriori_averaging" />
 Point estimation of a function <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>h</mi>
 </mrow></math> of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>w</mi>
 </mrow></math> is often performed via computation of the posterior expectation <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>w</mi>
 </mrow></math> given the examples in <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow>
    <mstyle mathvariant='script'><mi>S</mi>
    </mstyle>
   </mrow>
   <mrow><mi>n</mi>
   </mrow>
  </msub>
 </mrow></math><a id="eq__2" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <msub>
      <mrow>
       <mstyle mathvariant='normal'><mi>E</mi>
       </mstyle>
      </mrow>
      <mrow><mi>f</mi>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>h</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>|</mo>
      <msub>
       <mrow><mi>z</mi>
       </mrow>
       <mrow>
        <mrow><mn>1</mn><mo>:</mo><mi>n</mi>
        </mrow>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mo> &int; </mo><mi>h</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>w</mi><mo>|</mo>
      <msub>
       <mrow><mi>z</mi>
       </mrow>
       <mrow>
        <mrow><mn>1</mn><mo>:</mo><mi>n</mi>
        </mrow>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <mstyle mathvariant='normal'><mi>d</mi>
     </mstyle><mi>w</mi>
    </mrow>
   </mtd>
   <mtd>(1.3)
   </mtd>
  </mtr>
 </mtable></math>It is often intractable; hence there is often a need to numerically compute it. (Section <a href="#sec_Full_Bayesian_learning">3</a>)</div>
</div>

<div class="standard" id='magicparlabel-53'><br />

</div>

<div class="remark" id='magicparlabel-54'><div class="remark_item"><span class="remark_label">Remark 6.</span>
Point estimation of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>w</mi>
 </mrow></math> can also be performed via maximum a-posteriori (MAP) estimator <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup>
   <mrow><mi>w</mi>
   </mrow>
   <mrow><mo>*</mo>
   </mrow>
  </msup>
 </mrow></math> of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>w</mi>
 </mrow></math> that is the maximizer <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup>
   <mrow><mi>w</mi>
   </mrow>
   <mrow><mo>*</mo>
   </mrow>
  </msup>
 </mrow></math> of <a href="#eq__1">(1.2)</a> i.e.<a id="eq__5" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <msup>
     <mrow><mi>w</mi>
     </mrow>
     <mrow><mo>*</mo>
     </mrow>
    </msup>
   </mtd>
   <mtd>
    <mrow><mo>=</mo><munder accent='false'>
     <mrow><mo> arg </mo><mo> max </mo>
     </mrow>
     <mrow><mi>w</mi><mo> &isin; </mo><mo> &Theta; </mo>
     </mrow></munder><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi>w</mi><mo>|</mo>
       <msub>
        <mrow><mi>z</mi>
        </mrow>
        <mrow>
         <mrow><mn>1</mn><mo>:</mo><mi>n</mi>
         </mrow>
        </mrow>
       </msub>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>(1.4)
   </mtd>
  </mtr>
  <mtr>
   <mtd><mrow/>
   </mtd>
   <mtd>
    <mrow><mo>=</mo><munder accent='false'>
     <mrow><mo> arg </mo><mo> max </mo>
     </mrow>
     <mrow><mi>w</mi><mo> &isin; </mo><mo> &Theta; </mo>
     </mrow></munder><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><munder accent='false'>
      <munder>
       <mrow>
        <mrow><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <mrow>
          <msub>
           <mrow><mi>L</mi>
           </mrow>
           <mrow><mi>n</mi>
           </mrow>
          </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </mrow><mo stretchy="true">&UnderBrace;</mo>
      </munder>
      <mstyle mathvariant='normal'><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>I</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mstyle></munder><munder accent='false'>
      <munder>
       <mrow>
        <mrow><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </mrow><mo stretchy="true">&UnderBrace;</mo>
      </munder>
      <mstyle mathvariant='normal'><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow><mi>I</mi><mi>I</mi>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mstyle></munder>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>(1.5)
   </mtd>
  </mtr>
 </mtable></math>Note that <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='normal'><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>I</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mstyle>
 </mrow></math> may be interpreted as an empirical risk function, and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mstyle mathvariant='normal'><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>I</mi><mi>I</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mstyle>
 </mrow></math> can be interpreted as a shrinkage term in terms of shrinkage methods (like LASSO, Ridge). It is often intractable; hence there is often a need to numerically compute it. (Section <a href="#sec_Maximum_A_Posteriori">2</a>)
<br />

</div>
</div>

<div class="standard" id='magicparlabel-55'><br />

</div>

<div class="note" id='magicparlabel-56'><div class="note_item"><span class="note_label">Note 7.</span>
To describe the learning algorithms Gradient Descent (GD), Stochastic Gradient Descent (SGD), and Stochastic Gradient Langevin Dynamics (SGLD), we consider that the examples (data) in <a href="#eq_">(1.1)</a> are independent realizations from the sampling distribution i.e. <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>z</mi>
    </mrow>
    <mrow><mi>i</mi>
    </mrow>
   </msub><mo>|</mo><mi>w</mi><mo> &sim; </mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mo> &sdot; </mo><mo>|</mo><mi>w</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> for <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>n</mi>
  </mrow>
 </mrow></math> and that <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>w</mi>
 </mrow></math> is continuous (not discrete). </div>
</div>

<div class="standard" id='magicparlabel-57'><br />

</div>

<div class="note" id='magicparlabel-58'><div class="note_item"><span class="note_label">Note 8.</span>
In what follows, we first present the implementation of GD and SGD addressing MAP learning, and then we introduce the implementation of SGLD addressing posterior density and expectation learning. </div>
</div>
<h2 class="section" id='magicparlabel-74'><span class="section_label">2</span> <a id="sec_Maximum_A_Posteriori" />
Maximum A Posteriori (MAP) learning via GD and SGD</h2>

<div class="problem" id='magicparlabel-75'><div class="problem_item"><span class="problem_label">Problem 9.</span>
Given the Bayesian model <a href="#eq_">(1.1)</a>, and rearranging <a href="#eq__5">(1.5)</a>, MAP estimate <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup>
   <mrow><mi>w</mi>
   </mrow>
   <mrow><mo>*</mo>
   </mrow>
  </msup>
 </mrow></math> of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>w</mi>
 </mrow></math> can be computed as<a id="eq__5_1" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <msup>
     <mrow><mi>w</mi>
     </mrow>
     <mrow><mo>*</mo>
     </mrow>
    </msup>
   </mtd>
   <mtd>
    <mrow><mo>=</mo><munder accent='false'>
     <mrow><mo> arg </mo><mo> max </mo>
     </mrow>
     <mrow><mi>w</mi><mo> &isin; </mo><mo> &Theta; </mo>
     </mrow></munder><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msub>
        <mrow><mi>L</mi>
        </mrow>
        <mrow><mi>n</mi>
        </mrow>
       </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><munder accent='false'>
     <mrow><mo> arg </mo><mo> max </mo>
     </mrow>
     <mrow><mi>w</mi><mo> &isin; </mo><mo> &Theta; </mo>
     </mrow></munder><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msubsup>
       <mrow><mo> &sum; </mo>
       </mrow>
       <mrow>
        <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
        </mrow>
       </mrow>
       <mrow><mi>n</mi>
       </mrow>
      </msubsup><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow><mi>w</mi><mo>|</mo>
        <msub>
         <mrow><mi>z</mi>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
        </msub>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>(2.1)
   </mtd>
  </mtr>
 </mtable></math></div>
</div>

<div class="standard" id='magicparlabel-76'><br />

</div>

<div class="remark" id='magicparlabel-77'><div class="remark_item"><span class="remark_label">Remark 10.</span>
GD is particularly suitable to solve <a href="#eq__5_1">(2.1)</a> when <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>w</mi>
 </mrow></math> has high dimensionality.</div>
</div>

<div class="standard" id='magicparlabel-78'><br />

</div>


<div class="standard" id='magicparlabel-79'><div class='Boxed'><div class="algorithm" id='magicparlabel-83'><div class="algorithm_item"><span class="algorithm_label">Algorithm 11.</span>
<a id="alg_Gradient_descent__Algorithm" />
Gradient descent (Algorithm <a href="#alg_Gradient_descent_algorithm">alg:Gradient-descent-algorithm</a> Handout 2) with learning rate <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo> &ge; </mo><mn>0</mn>
  </mrow>
 </mrow></math> can be used to solve <a href="#eq__5_1">(2.1)</a> by using the update rule as</div>
<div class="algorithm_item"><hr />

</div>
<div class="plain_layout" style='text-align: left;' id='magicparlabel-85'><i>For <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>t</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>...</mn>
  </mrow>
 </mrow></math> iterate: </i></div>

<ol class="enumerate" id='magicparlabel-86'><li class="enumerate_item"><i>Compute<a id="eq__6" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <msup>
     <mrow><mi>w</mi>
     </mrow>
     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi>t</mi><mo>+</mo><mn>1</mn>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </msup>
   </mtd>
   <mtd>
    <mrow><mo>=</mo>
     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup><mo>+</mo>
     <msub>
      <mrow><mi> &eta; </mi>
      </mrow>
      <mrow><mi>t</mi>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msubsup>
       <mrow><mo> &sum; </mo>
       </mrow>
       <mrow>
        <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
        </mrow>
       </mrow>
       <mrow><mi>n</mi>
       </mrow>
      </msubsup>
      <msub>
       <mrow><mi> &nabla; </mi>
       </mrow>
       <mrow><mi>w</mi>
       </mrow>
      </msub><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo>
      <msub>
       <mrow><mi> &nabla; </mi>
       </mrow>
       <mrow><mi>w</mi>
       </mrow>
      </msub><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <msup>
        <mrow><mi>w</mi>
        </mrow>
        <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>(2.2)
   </mtd>
  </mtr>
 </mtable></math></i></li>
</ol>
</div>
</div></div>


<div class="standard" id='magicparlabel-87'><br />

</div>

<div class="remark" id='magicparlabel-88'><div class="remark_item"><span class="remark_label">Remark 12.</span>
The implementation of other GD variants (eg <a href="#eq_sbGD_update_mechanism">eq:sbGD-update-mechanism</a> in Handout 2) is straightforward, based on Algorithm <a href="#alg_Gradient_descent__Algorithm">11</a>. </div>
</div>

<div class="standard" id='magicparlabel-89'><br />

</div>

<div class="remark" id='magicparlabel-90'><div class="remark_item"><span class="remark_label">Remark 13.</span>
<a id="rem_SGD_is_particularly" />
SGD is particularly suitable to solve <a href="#eq__5_1">(2.1)</a> when <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>w</mi>
 </mrow></math> has high dimensionality, and in big-data problems since the repetitive computation of the sum in <a href="#eq__6">(2.2)</a> is prohibitively expensive. Yet consider the benefits of SGD against GD as discussed in (Remarks <a href="#rem_In_practice__using">rem:In-practice,-using</a> and <a href="#rem_In_practice__for">rem:In-practice,-for</a> of Handout 3). </div>
</div>

<div class="standard" id='magicparlabel-91'><br />

</div>


<div class="standard" id='magicparlabel-92'><div class='Boxed'><div class="algorithm" id='magicparlabel-96'><div class="algorithm_item"><span class="algorithm_label">Algorithm 14.</span>
<a id="alg_Batch_Stochastic_Gradient" />
Batch Stochastic Gradient Descent (Algorithm <a href="#alg_batch_Stochastic_Gradient">alg:batch-Stochastic-Gradient</a> in Handout 3) with learning rate <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo> &ge; </mo><mn>0</mn>
  </mrow>
 </mrow></math> and batch size <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>m</mi>
 </mrow></math> can be used to solve <a href="#eq__5_1">(2.1)</a> by using the update rule as</div>
<div class="algorithm_item"><hr />

</div>
<div class="plain_layout" style='text-align: left;' id='magicparlabel-98'><i>For <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>t</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>...</mn>
  </mrow>
 </mrow></math> iterate: </i></div>

<ol class="enumerate" id='magicparlabel-99'><li class="enumerate_item"><i>generate a random set <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msup>
    <mrow>
     <mstyle mathvariant='script'><mi>J</mi>
     </mstyle>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup><mo> &sube; </mo>
   <msup>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

     <mrow><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>n</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

    </mrow>
    <mrow><mi>m</mi>
    </mrow>
   </msup>
  </mrow>
 </mrow></math> of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>m</mi>
 </mrow></math> indices from <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mn>1</mn>
 </mrow></math> to <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>n</mi>
 </mrow></math> with or without replacement, and set a <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow>
     <mover>
      <mrow>
       <mstyle mathvariant='script'><mi>S</mi>
       </mstyle>
      </mrow><mo stretchy="true">&tilde;</mo>
     </mover>
    </mrow>
    <mrow><mi>m</mi>
    </mrow>
   </msub><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

   <mrow>
    <msub>
     <mrow><mi>z</mi>
     </mrow>
     <mrow><mi>i</mi>
     </mrow>
    </msub><mo>;</mo><mi>i</mi><mo> &isin; </mo>
    <msup>
     <mrow>
      <mstyle mathvariant='script'><mi>J</mi>
      </mstyle>
     </mrow>
     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </msup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

  </mrow>
 </mrow></math>. </i></li>
<li class="enumerate_item"><i>compute <a id="eq__6_1" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <msup>
     <mrow><mi>w</mi>
     </mrow>
     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi>t</mi><mo>+</mo><mn>1</mn>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </msup>
   </mtd>
   <mtd>
    <mrow><mo>=</mo>
     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup><mo>+</mo>
     <msub>
      <mrow><mi> &eta; </mi>
      </mrow>
      <mrow><mi>t</mi>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <mfrac>
       <mrow><mi>n</mi>
       </mrow>
       <mrow><mi>m</mi>
       </mrow>
      </mfrac>
      <msub>
       <mrow><mo> &sum; </mo>
       </mrow>
       <mrow>
        <mrow><mi>j</mi><mo> &isin; </mo>
         <msup>
          <mrow>
           <mstyle mathvariant='script'><mi>J</mi>
           </mstyle>
          </mrow>
          <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

          </mrow>
         </msup>
        </mrow>
       </mrow>
      </msub>
      <msub>
       <mrow><mi> &nabla; </mi>
       </mrow>
       <mrow><mi>w</mi>
       </mrow>
      </msub><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo>
      <msub>
       <mrow><mi> &nabla; </mi>
       </mrow>
       <mrow><mi>w</mi>
       </mrow>
      </msub><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <msup>
        <mrow><mi>w</mi>
        </mrow>
        <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>(2.3)
   </mtd>
  </mtr>
 </mtable></math></i></li>
</ol>
</div>
</div></div>


<div class="standard" id='magicparlabel-101'><br />

</div>

<div class="remark" id='magicparlabel-102'><div class="remark_item"><span class="remark_label">Remark 15.</span>
Recursion <a href="#eq__6_1">(2.3)</a> is justified in terms of SGD theory as <a id="eq__10" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <msub>
      <mrow>
       <mstyle mathvariant='normal'><mi>E</mi>
       </mstyle>
      </mrow>
      <mrow>
       <mrow>
        <msup>
         <mrow>
          <mstyle mathvariant='script'><mi>J</mi>
          </mstyle>
         </mrow>
         <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
        </msup><mo> &sim; </mo>
        <mstyle mathvariant='normal'>
         <mrow><mi>s</mi><mi>i</mi><mi>m</mi><mi>p</mi><mi>l</mi><mi>e</mi><mo>-</mo><mi>r</mi><mi>a</mi><mi>n</mi><mi>d</mi><mi>o</mi><mi>m</mi><mo>-</mo><mi>s</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>l</mi><mi>i</mi><mi>n</mi><mi>g</mi>
         </mrow>
        </mstyle>
       </mrow>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <mfrac>
       <mrow><mi>n</mi>
       </mrow>
       <mrow><mi>m</mi>
       </mrow>
      </mfrac>
      <msub>
       <mrow><mo> &sum; </mo>
       </mrow>
       <mrow>
        <mrow><mi>j</mi><mo> &isin; </mo>
         <msup>
          <mrow>
           <mstyle mathvariant='script'><mi>J</mi>
           </mstyle>
          </mrow>
          <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

          </mrow>
         </msup>
        </mrow>
       </mrow>
      </msub>
      <msub>
       <mrow><mi> &nabla; </mi>
       </mrow>
       <mrow><mi>w</mi>
       </mrow>
      </msub><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow>
        <msub>
         <mrow><mi>z</mi>
         </mrow>
         <mrow><mi>j</mi>
         </mrow>
        </msub><mo>|</mo>
        <msup>
         <mrow><mi>w</mi>
         </mrow>
         <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
        </msup>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
     <msubsup>
      <mrow><mo> &sum; </mo>
      </mrow>
      <mrow>
       <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
       </mrow>
      </mrow>
      <mrow><mi>n</mi>
      </mrow>
     </msubsup>
     <msub>
      <mrow><mi> &nabla; </mi>
      </mrow>
      <mrow><mi>w</mi>
      </mrow>
     </msub><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msub>
        <mrow><mi>z</mi>
        </mrow>
        <mrow><mi>i</mi>
        </mrow>
       </msub><mo>|</mo>
       <msup>
        <mrow><mi>w</mi>
        </mrow>
        <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </msup>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>(2.4)
   </mtd>
  </mtr>
 </mtable></math></div>
</div>

<div class="standard" id='magicparlabel-107'><br />

</div>

<div class="remark" id='magicparlabel-108'><div class="remark_item"><span class="remark_label">Remark 16.</span>
The implementation of the SGD variants (Algorithms <a href="#alg_batch_Stochastic_Gradient">alg:batch-Stochastic-Gradient</a>, <a href="#alg_Stochastic_Variance_Reduced">alg:Stochastic-Variance-Reduced</a>, <a href="#alg_Stochastic_Gradient_descent_2">alg:Stochastic-Gradient-descent-2</a>, <a href="#def_Adaptive_Stochastic_Gradient">def:Adaptive-Stochastic-Gradient</a> in Handout 3)) is straightforward based on Algorithm <a href="#alg_Batch_Stochastic_Gradient">14</a> and <a href="#eq__10">(2.4)</a>. </div>
</div>
<h2 class="section" id='magicparlabel-109'><span class="section_label">3</span> <a id="sec_Full_Bayesian_learning" />
Fully Bayesian learning via SGLD</h2>

<div class="standard" id='magicparlabel-110'><br />

</div>

<div class="problem" id='magicparlabel-111'><div class="problem_item"><span class="problem_label">Problem 17.</span>
Fully Bayesian learning, computationally, is the problem of recovering the posterior distribution <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>w</mi><mo>|</mo>
    <msub>
     <mrow><mi>z</mi>
     </mrow>
     <mrow>
      <mrow><mn>1</mn><mo>:</mo><mi>n</mi>
      </mrow>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>w</mi>
 </mrow></math> given <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>z</mi>
   </mrow>
   <mrow>
    <mrow><mn>1</mn><mo>:</mo><mi>n</mi>
    </mrow>
   </mrow>
  </msub>
 </mrow></math> that admits density <a href="#eq__1">(1.2)</a>. For a given Bayesian model <a href="#eq_">(1.1)</a>, the Bayesian estimator of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>h</mi><mo>:</mo><mo>=</mo><mi>h</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> can be computed as the posterior expectation of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>w</mi>
 </mrow></math> given the data <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow>
    <mstyle mathvariant='script'><mi>S</mi>
    </mstyle>
   </mrow>
   <mrow><mi>n</mi>
   </mrow>
  </msub>
 </mrow></math> </div>
</div>

<div class="standard" id='magicparlabel-120'><br />

</div>

<div class="remark" id='magicparlabel-121'><div class="remark_item"><span class="remark_label">Remark 18.</span>
<a id="rem_Monte_Carlo_integration" />
Monte Carlo integration aims at approximating <a href="#eq__2">(1.3)</a>, by using Central Limit Theorem or Law of Large Numbers arguments as <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mover>
    <mrow><mi>h</mi>
    </mrow><mo stretchy="true">&circ;</mo>
   </mover><mo> &ap; </mo>
   <msub>
    <mrow>
     <mstyle mathvariant='normal'><mi>E</mi>
     </mstyle>
    </mrow>
    <mrow><mi>f</mi>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>h</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>|</mo>
    <msub>
     <mrow><mi>z</mi>
     </mrow>
     <mrow>
      <mrow><mn>1</mn><mo>:</mo><mi>n</mi>
      </mrow>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> where<a id="eq__11" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mover>
      <mrow><mi>h</mi>
      </mrow><mo stretchy="true">&circ;</mo>
     </mover><mo>=</mo>
     <mfrac>
      <mrow><mn>1</mn>
      </mrow>
      <mrow><mi>T</mi>
      </mrow>
     </mfrac>
     <msubsup>
      <mrow><mo> &sum; </mo>
      </mrow>
      <mrow>
       <mrow><mi>t</mi><mo>=</mo><mn>1</mn>
       </mrow>
      </mrow>
      <mrow><mi>T</mi>
      </mrow>
     </msubsup><mi>h</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>(3.1)
   </mtd>
  </mtr>
 </mtable></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

  <msup>
   <mrow><mi>w</mi>
   </mrow>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
  </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

 </mrow></math> are <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>T</mi>
 </mrow></math> simulations drawn (approximately) from the posterior distribution <a href="#eq__1">1.2</a>. This theory is subject to conditions we skip. </div>
</div>

<div class="standard" id='magicparlabel-122'><br />

</div>

<div class="remark" id='magicparlabel-123'><div class="remark_item"><span class="remark_label">Remark 19.</span>
Stochastic gradient Langevin dynamics (SGLD) algorithm is able to approximately produce samples from the posterior distribution <a href="#eq__1">(1.2)</a> of parameters <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>w</mi>
 </mrow></math> given the available data <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>z</mi>
   </mrow>
   <mrow>
    <mrow><mn>1</mn><mo>:</mo><mi>n</mi>
    </mrow>
   </mrow>
  </msub>
 </mrow></math>. That allows to recover the whole posterior distribution <a href="#eq__1">(1.2)</a> (hence account for the uncertainty in parameters) and approximate posterior expectations <a href="#eq__2">(1.3)</a> by averaging out <a href="#eq__11">(3.1)</a> according to the Monte Carlo integration (Remark <a href="#rem_Monte_Carlo_integration">18</a>). </div>
</div>

<div class="standard" id='magicparlabel-124'><br />

</div>

<div class="remark" id='magicparlabel-125'><div class="remark_item"><span class="remark_label">Remark 20.</span>
Stochastic gradient Langevin dynamics (SGLD) algorithm is able to generate a sample approximately distributed according to the posterior distribution <a href="#eq__1">(1.2)</a>. That allows to recover the whole posterior distribution (hence account for uncertainty in parameters) and approximate posterior expectations based on the Monte Carlo integration (Remark <a href="#rem_Monte_Carlo_integration">18</a>). </div>
</div>


<div class="note" id='magicparlabel-134'><div class="note_item"><span class="note_label">Note 21.</span>
SGLD relies on injecting the `right' amount of noise to a standard stochastic gradient optimization recursion <a href="#eq__6">(2.2)</a>, such that, as the stepsize <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &eta; </mi>
   </mrow>
   <mrow><mi>t</mi>
   </mrow>
  </msub>
 </mrow></math> properly reduces, the produced chain <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

  <msup>
   <mrow><mi>w</mi>
   </mrow>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow><mi>t</mi><mo>+</mo><mn>1</mn>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
  </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

 </mrow></math> converges to samples that could have been drawn from the true posterior distribution.</div>
</div>



<div class="standard" id='magicparlabel-145'><br />

</div>


<div class="standard" id='magicparlabel-146'><div class='Boxed'><div class="algorithm" id='magicparlabel-150'><div class="algorithm_item"><span class="algorithm_label">Algorithm 22.</span>
<a id="alg_Stochastic_Gradient_Langevin" />
Stochastic Gradient Langevin Dynamics (SGLD) with learning rate <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo>&gt;</mo><mn>0</mn>
  </mrow>
 </mrow></math>, batch size <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>m</mi>
 </mrow></math>, and temperature <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &tau; </mi><mo>&gt;</mo><mn>0</mn>
  </mrow>
 </mrow></math> is </div>
<div class="algorithm_item"><hr />

</div>

<ol class="enumerate" id='magicparlabel-152'><li class="enumerate_item"><i>Generate a random set <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msup>
    <mrow>
     <mstyle mathvariant='script'><mi>J</mi>
     </mstyle>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup><mo> &sube; </mo>
   <msup>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

     <mrow><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>n</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

    </mrow>
    <mrow><mi>m</mi>
    </mrow>
   </msup>
  </mrow>
 </mrow></math> of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>m</mi>
 </mrow></math> indices from <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mn>1</mn>
 </mrow></math> to <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>n</mi>
 </mrow></math> with or without replacement, and set a <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow>
     <mover>
      <mrow>
       <mstyle mathvariant='script'><mi>S</mi>
       </mstyle>
      </mrow><mo stretchy="true">&tilde;</mo>
     </mover>
    </mrow>
    <mrow><mi>m</mi>
    </mrow>
   </msub><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

   <mrow>
    <msub>
     <mrow><mi>z</mi>
     </mrow>
     <mrow><mi>i</mi>
     </mrow>
    </msub><mo>;</mo><mi>i</mi><mo> &isin; </mo>
    <msup>
     <mrow>
      <mstyle mathvariant='script'><mi>J</mi>
      </mstyle>
     </mrow>
     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </msup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

  </mrow>
 </mrow></math>. </i></li>
<li class="enumerate_item"><i>Compute </i><a id="eq__7" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow><mi>t</mi><mo>+</mo><mn>1</mn>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup><mo>=</mo>
     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup><mo>+</mo>
     <msub>
      <mrow><mi> &eta; </mi>
      </mrow>
      <mrow><mi>t</mi>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <mfrac>
       <mrow><mi>n</mi>
       </mrow>
       <mrow><mi>m</mi>
       </mrow>
      </mfrac>
      <msub>
       <mrow><mo> &sum; </mo>
       </mrow>
       <mrow>
        <mrow><mi>i</mi><mo> &isin; </mo>
         <msup>
          <mrow><mi>J</mi>
          </mrow>
          <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

          </mrow>
         </msup>
        </mrow>
       </mrow>
      </msub><mi> &nabla; </mi><mo> log </mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msub>
        <mrow><mi>z</mi>
        </mrow>
        <mrow><mi>i</mi>
        </mrow>
       </msub><mo>|</mo><mi>w</mi>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo><mi> &nabla; </mi><mo> log </mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo>
     <msqrt>
      <msub>
       <mrow><mi> &eta; </mi>
       </mrow>
       <mrow><mi>t</mi>
       </mrow>
      </msub>
     </msqrt>
     <msqrt><mi> &tau; </mi>
     </msqrt>
     <msub>
      <mrow><mi> &epsi; </mi>
      </mrow>
      <mrow><mi>t</mi>
      </mrow>
     </msub>
    </mrow>
   </mtd>
   <mtd>(3.2)
   </mtd>
  </mtr>
 </mtable></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &epsi; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mover accent='false'><mo> &sim; </mo>
   <mstyle mathvariant='normal'>
    <mrow><mi>i</mi><mi>i</mi><mi>d</mi>
    </mrow>
   </mstyle></mover>
   <mstyle mathvariant='normal'><mi>N</mi>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mn>0</mn><mo>,</mo><mn>1</mn>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> .</li>
<li class="enumerate_item"><i>Terminate if a termination criterion is satisfied; E.g., <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>t</mi><mo> &le; </mo>
   <msub>
    <mrow><mi>T</mi>
    </mrow>
    <mrow>
     <mstyle mathvariant='normal'>
      <mrow><mi>m</mi><mi>a</mi><mi>x</mi>&nbsp;
      </mrow>
     </mstyle>
    </mrow>
   </msub>
  </mrow>
 </mrow></math> for a prespecified <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>T</mi>
    </mrow>
    <mrow>
     <mstyle mathvariant='normal'>
      <mrow><mi>m</mi><mi>a</mi><mi>x</mi>&nbsp;
      </mrow>
     </mstyle>
    </mrow>
   </msub><mo>&gt;</mo><mn>0</mn>
  </mrow>
 </mrow></math>.</i></li>
</ol>
</div>
</div>
<br />

</div>

<div class="remark" id='magicparlabel-155'><div class="remark_item"><span class="remark_label">Remark 23.</span>
The first few iterations from Algorithm <a href="#alg_Stochastic_Gradient_Langevin">22</a> involve values generated at the beginning of the running algorithm while the chain have not yet converged to (or reached) an area of substantial posterior mass. Hence they are discarded from the output of the SGLD. These values are called burn-in. </div>
</div>

<div class="standard" id='magicparlabel-156'><br />

</div>

<div class="remark" id='magicparlabel-157'><div class="remark_item"><span class="remark_label">Remark 24.</span>
The output of SGLD (Algorithm <a href="#alg_Stochastic_Gradient_Langevin">22</a>) <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

  <msup>
   <mrow><mi>w</mi>
   </mrow>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
  </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

 </mrow></math> includes the generated values of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>w</mi>
 </mrow></math> produced during the last few iterations of the running algorithm (aka the end tail of the generated chain). </div>
</div>

<div class="standard" id='magicparlabel-158'><br />

</div>

<div class="remark" id='magicparlabel-159'><div class="remark_item"><span class="remark_label">Remark 25.</span>
SGLD (Algorithm <a href="#alg_Stochastic_Gradient_Langevin">22</a>) generates as output a random chain <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

  <msup>
   <mrow><mi>w</mi>
   </mrow>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
  </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

 </mrow></math> that is approximately distributed according to a distribution with density such as <a id="eq__3" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <msub>
      <mrow><mi>f</mi>
      </mrow>
      <mrow><mi> &tau; </mi>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>w</mi><mo>|</mo>
      <msub>
       <mrow><mi>z</mi>
       </mrow>
       <mrow>
        <mrow><mn>1</mn><mo>:</mo><mi>n</mi>
        </mrow>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &vprop; </mo>
    </mrow>
   </mtd>
   <mtd>
    <mrow><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <mfrac>
       <mrow><mn>1</mn>
       </mrow>
       <mrow><mi> &tau; </mi>
       </mrow>
      </mfrac>
      <msubsup>
       <mrow><mo> &prod; </mo>
       </mrow>
       <mrow>
        <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
        </mrow>
       </mrow>
       <mrow><mi>n</mi>
       </mrow>
      </msubsup><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msub>
        <mrow><mi>z</mi>
        </mrow>
        <mrow><mi>i</mi>
        </mrow>
       </msub><mo>|</mo><mi>w</mi>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>(3.3)
   </mtd>
  </mtr>
  <mtr>
   <mtd><mo> &vprop; </mo>
   </mtd>
   <mtd>
    <mrow><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <mfrac>
       <mrow><mn>1</mn>
       </mrow>
       <mrow><mi> &tau; </mi>
       </mrow>
      </mfrac>
      <msub>
       <mrow><mi>L</mi>
       </mrow>
       <mrow><mi>n</mi>
       </mrow>
      </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>(3.4)
   </mtd>
  </mtr>
 </mtable></math> under regularity conditions. Conditions <a href="#cond_Regarding_the_learning">26</a> on the learning rate are rather inevitable and should be satisfied.</div>
</div>

<div class="standard" id='magicparlabel-160'><br />

</div>

<div class="condition" id='magicparlabel-161'><div class="condition_item"><span class="condition_label">Condition 26.</span>
<a id="cond_Regarding_the_learning" />
Regarding the learning rate (or gain) <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

  <msub>
   <mrow><mi> &eta; </mi>
   </mrow>
   <mrow><mi>t</mi>
   </mrow>
  </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

 </mrow></math> should satisfy conditions </div>

<ol class="enumerate" id='magicparlabel-162'><li class="enumerate_item"><a id="enu__" />
<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo> &ge; </mo><mn>0</mn>
  </mrow>
 </mrow></math>, </li>
<li class="enumerate_item"><a id="enu_" />
<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msubsup>
    <mrow><mo> &sum; </mo>
    </mrow>
    <mrow>
     <mrow><mi>t</mi><mo>=</mo><mn>1</mn>
     </mrow>
    </mrow>
    <mrow><mi> &infin; </mi>
    </mrow>
   </msubsup>
   <msub>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo>=</mo><mi> &infin; </mi>
  </mrow>
 </mrow></math></li>
<li class="enumerate_item"><a id="enu__1" />
<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msubsup>
    <mrow><mo> &sum; </mo>
    </mrow>
    <mrow>
     <mrow><mi>t</mi><mo>=</mo><mn>1</mn>
     </mrow>
    </mrow>
    <mrow><mi> &infin; </mi>
    </mrow>
   </msubsup>
   <msubsup>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msubsup><mo>&lt;</mo><mi> &infin; </mi>
  </mrow>
 </mrow></math></li>
</ol>
</div>

<div class="standard" id='magicparlabel-165'><br />

</div>

<div class="remark" id='magicparlabel-166'><div class="remark_item"><span class="remark_label">Remark 27.</span>
The temperature parameter <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &tau; </mi><mo>&gt;</mo><mn>0</mn>
  </mrow>
 </mrow></math> is user specified and aims at controlling (eg; inflating) the variance of the produced chain for instance with practical purpose to escape from local modes (otherwise energy barriers) in non-convex problems. </div>
</div>

<div class="standard" id='magicparlabel-167'><br />

</div>

<div class="remark" id='magicparlabel-168'><div class="remark_item"><span class="remark_label">Remark 28.</span>
SGLD for <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &tau; </mi><mo>=</mo><mn>1</mn>
  </mrow>
 </mrow></math> approximately simulates from the posterior <a href="#eq__1">(1.2)</a>. </div>
</div>

<div class="standard" id='magicparlabel-169'><br />

</div>

<div class="remark" id='magicparlabel-170'><div class="remark_item"><span class="remark_label">Remark 29.</span>
The popular learning rates <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

  <msub>
   <mrow><mi> &eta; </mi>
   </mrow>
   <mrow><mi>t</mi>
   </mrow>
  </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

 </mrow></math> in Remark <a href="#rem_The_parameter_">rem:The-parameter-</a> in Handout 2 satisfy Condition <a href="#cond_Regarding_the_learning">26</a> and hence can be used in SGD too. Once parametrized, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &eta; </mi>
   </mrow>
   <mrow><mi>t</mi>
   </mrow>
  </msub>
 </mrow></math> can be tuned based on pilot runs using a reasonably small number of data.</div>
</div>



<div class="standard" id='magicparlabel-177'><br />

</div>

<div class="remark" id='magicparlabel-178'><div class="remark_item"><span class="remark_label">Remark 30.</span>
<a id="rem__Mathematically_speaking__The" />
&nbsp;(Mathematically speaking) The stochastic chain in <a href="#eq__7">(3.2)</a> can be viewed as a discretization of the continuous-time Langevin diffusion described by the stochastic differential equation<a id="eq__8" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mstyle mathvariant='normal'><mi>d</mi>
     </mstyle><mi>W</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mo>-</mo>
     <msub>
      <mrow><mi> &nabla; </mi>
      </mrow>
      <mrow><mi>w</mi>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

     <mrow><mo>-</mo><mo> log </mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi>W</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>|</mo>
       <msub>
        <mrow><mi>z</mi>
        </mrow>
        <mrow>
         <mrow><mn>1</mn><mo>:</mo><mi>n</mi>
         </mrow>
        </mrow>
       </msub>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

     <mstyle mathvariant='normal'><mi>d</mi>
     </mstyle><mi>t</mi><mo>+</mo>
     <msqrt>
      <mrow><mn>2</mn><mi> &tau; </mi>
      </mrow>
     </msqrt>
     <mstyle mathvariant='normal'><mi>d</mi>
     </mstyle><mi>B</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>,</mo><mspace width="6px" /><mspace width="6px" /><mi>t</mi><mo> &ge; </mo><mn>0</mn>
    </mrow>
   </mtd>
   <mtd>(3.5)
   </mtd>
  </mtr>
 </mtable></math>where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

  <mrow><mi>B</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

 </mrow></math> is a standard Brownian motion<div class="foot"><span class="foot_label">1</span><div class="foot_inner"><div class="plain_layout" id='magicparlabel-182'>A a continuous-time stochastic process: (1) <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>B</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mn>0</mn>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mn>0</mn>
  </mrow>
 </mrow></math> ; (2) <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>B</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> is almost surely continuous ; (3) <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>B</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> has independent increaments ; (4) <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>B</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>-</mo><mi>B</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>s</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &sim; </mo>
   <mstyle mathvariant='normal'><mi>N</mi>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mn>0</mn><mo>,</mo><mi>t</mi><mo>-</mo><mi>s</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> for <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mn>0</mn><mo> &le; </mo><mi>s</mi><mo> &le; </mo><mi>t</mi>
  </mrow>
 </mrow></math>.</div>
</div></div> in <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup>
   <mrow>
    <mstyle mathvariant='double-struck'><mi>R</mi>
    </mstyle>
   </mrow>
   <mrow><mi>d</mi>
   </mrow>
  </msup>
 </mrow></math> (i.e.). Under suitable assumptions on <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>f</mi>
 </mrow></math>, it can be shown that a Gibbs distribution with PDF such as <a id="eq__9" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <msup>
      <mrow><mi>f</mi>
      </mrow>
      <mrow><mo>*</mo>
      </mrow>
     </msup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>w</mi><mo>|</mo>
      <msub>
       <mrow><mi>z</mi>
       </mrow>
       <mrow>
        <mrow><mn>1</mn><mo>;</mo><mi>n</mi>
        </mrow>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &vprop; </mo><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mo>-</mo>
      <mfrac>
       <mrow><mn>1</mn>
       </mrow>
       <mrow><mi> &tau; </mi>
       </mrow>
      </mfrac><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

      <mrow><mo>-</mo><mo> log </mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow><mi>W</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>|</mo>
        <msub>
         <mrow><mi>z</mi>
         </mrow>
         <mrow>
          <mrow><mn>1</mn><mo>:</mo><mi>n</mi>
          </mrow>
         </mrow>
        </msub>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>(3.6)
   </mtd>
  </mtr>
 </mtable></math> is the unique invariant distribution of <a href="#eq__8">(3.5)</a>, and that the distributions of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>W</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> converge rapidly to <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup>
   <mrow><mi>f</mi>
   </mrow>
   <mrow><mo>*</mo>
   </mrow>
  </msup>
 </mrow></math> as <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>t</mi><mo> &rarr; </mo><mi> &infin; </mi>
  </mrow>
 </mrow></math>. </div>
</div>



<div class="standard" id='magicparlabel-188'><br />

</div>

<div class="remark" id='magicparlabel-189'><div class="remark_item"><span class="remark_label">Remark 31.</span>
(Heuristically speaking) In the initial phase of running, the stochastic gradient noise will dominate the injected noise <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &epsi; </mi>
   </mrow>
   <mrow><mi>t</mi>
   </mrow>
  </msub>
 </mrow></math> and the algorithm will imitate an eﬃcient SGD Algorithm <a href="#alg_Gradient_descent__Algorithm">11</a> -but this is until <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &eta; </mi>
   </mrow>
   <mrow><mi>t</mi>
   </mrow>
  </msub>
 </mrow></math> or <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &nabla; </mi><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>L</mi>
     </mrow>
     <mrow><mi>n</mi>
     </mrow>
    </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> become small enough. In the later phase of running, the injected noise <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &epsi; </mi>
   </mrow>
   <mrow><mi>t</mi>
   </mrow>
  </msub>
 </mrow></math> will dominate the stochastic gradient noise, so the SGLD will imitate a Langevin dynamics for the target distribution <a href="#eq__1">(1.2)</a>. The aim is for to the algorithm to transition smoothly between the two phases. Whether the algorithm is in the stochastic optimization phase or Langevin dynamics phase depends on the variance of the injected noise versus that of the stochastic gradient. </div>
</div>

<div class="standard" id='magicparlabel-190'><br />

</div>

<div class="remark" id='magicparlabel-191'><div class="remark_item"><span class="remark_label">Remark 32.</span>
One can argue that, the output of SGLD is also an &ldquo;almost&rdquo; minimizer of the empirical risk for large enough <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>t</mi>
 </mrow></math>. A draw from the Gibbs distribution <a href="#eq__9">(3.6)</a> is approximately a minimizer of <a href="#eq__5_1">(2.1)</a>. Also one can show that the SGLD recursion tracks the Langevin diffusion <a href="#eq__8">(3.5)</a> in a suitable sense. Hence, both imply that the distributions of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>W</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> will be close to the Gibbs distribution <a href="#eq__9">(3.6)</a> for all sufficiently large <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>t</mi>
 </mrow></math>. </div>
</div>

<div class="standard" id='magicparlabel-192'><br />

</div>

<div class="remark" id='magicparlabel-193'><div class="remark_item"><span class="remark_label">Remark 33.</span>
To guarantee the algorithm to work it is important for the step sizes <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &eta; </mi>
   </mrow>
   <mrow><mi>t</mi>
   </mrow>
  </msub>
 </mrow></math> to decrease to zero, so that the mixing rate of the algorithm will slow down with increasing number of iterations <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>t</mi>
 </mrow></math>. Then, we can keep the step size <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &eta; </mi>
   </mrow>
   <mrow><mi>t</mi>
   </mrow>
  </msub>
 </mrow></math> constant once it has decreased below a critical level.</div>
</div>

<div class="standard" id='magicparlabel-194'><br />

</div>

<div class="remark" id='magicparlabel-195'><div class="remark_item"><span class="remark_label">Remark 34.</span>
Expectation <a href="#eq__2">(1.3)</a>,  can be estimated as an arithmetic average<a id="eq__4" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mover>
      <mrow>
       <mrow>
        <msub>
         <mrow><mi>h</mi>
         </mrow>
         <mrow><mi>T</mi>
         </mrow>
        </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow><mo stretchy="true">&Hat;</mo>
     </mover><mo>=</mo>
     <mfrac>
      <mrow><mn>1</mn>
      </mrow>
      <mrow><mi>T</mi>
      </mrow>
     </mfrac>
     <msubsup>
      <mrow><mo> &sum; </mo>
      </mrow>
      <mrow>
       <mrow><mi>t</mi><mo>=</mo><mn>1</mn>
       </mrow>
      </mrow>
      <mrow><mi>T</mi>
      </mrow>
     </msubsup><mi>h</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>(3.7)
   </mtd>
  </mtr>
 </mtable></math>as <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mover>
    <mrow>
     <mrow>
      <msub>
       <mrow><mi>h</mi>
       </mrow>
       <mrow><mi>T</mi>
       </mrow>
      </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </mrow><mo stretchy="true">&Hat;</mo>
   </mover><mo> &rarr; </mo>
   <msub>
    <mrow>
     <mstyle mathvariant='normal'><mi>E</mi>
     </mstyle>
    </mrow>
    <mrow><mi>f</mi>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>h</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>|</mo>
    <msub>
     <mrow><mi>z</mi>
     </mrow>
     <mrow>
      <mrow><mn>1</mn><mo>:</mo><mi>n</mi>
      </mrow>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> based on LLN arguments.</div>
</div>

<div class="standard" id='magicparlabel-200'><br />

</div>

<div class="remark" id='magicparlabel-201'><div class="remark_item"><span class="remark_label">Remark 35.</span>
Another more efficient estimator for the expectation <a href="#eq__2">(1.3)</a> is the weighted arithmetic average<a id="eq__4_1" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mover>
      <mrow>
       <mrow><mi>h</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow><mo stretchy="true">&Hat;</mo>
     </mover><mo>=</mo>
     <msubsup>
      <mrow><mo> &sum; </mo>
      </mrow>
      <mrow>
       <mrow><mi>t</mi><mo>=</mo>
        <msub>
         <mrow><mi>T</mi>
         </mrow>
         <mrow><mn>0</mn>
         </mrow>
        </msub><mo>+</mo><mn>1</mn>
       </mrow>
      </mrow>
      <mrow><mi>T</mi>
      </mrow>
     </msubsup>
     <mfrac>
      <mrow>
       <msub>
        <mrow><mi> &eta; </mi>
        </mrow>
        <mrow><mi>t</mi>
        </mrow>
       </msub>
      </mrow>
      <mrow>
       <mrow>
        <msubsup>
         <mrow><mo> &sum; </mo>
         </mrow>
         <mrow>
          <mrow><mi>t</mi><mo>=</mo>
           <msub>
            <mrow><mi>T</mi>
            </mrow>
            <mrow><mn>0</mn>
            </mrow>
           </msub><mo>+</mo><mn>1</mn>
          </mrow>
         </mrow>
         <mrow><mi>T</mi>
         </mrow>
        </msubsup>
        <msub>
         <mrow><mi> &eta; </mi>
         </mrow>
         <mrow>
          <mrow><mi>t</mi><mo>'</mo>
          </mrow>
         </mrow>
        </msub>
       </mrow>
      </mrow>
     </mfrac><mi>h</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>(3.8)
   </mtd>
  </mtr>
 </mtable></math>Because the step size <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &eta; </mi>
   </mrow>
   <mrow><mi>t</mi>
   </mrow>
  </msub>
 </mrow></math> decreases, the mixing rate of the chain <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

  <msup>
   <mrow><mi>w</mi>
   </mrow>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
  </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

 </mrow></math> decreases as well and the simple sample average <a href="#eq__4">(3.7)</a> will overemphasize the tail end of the sequence where there is higher correlation among the samples resulting in higher variance in the estimator. </div>
</div>



<div class="standard" id='magicparlabel-208'><br />

</div>

<div class="remark" id='magicparlabel-209'><div class="remark_item"><span class="remark_label">Remark 36.</span>
Certain dimensions may have a vastly larger curvature leading to much bigger gradients. In this case a symmetric preconditioning matrix <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>P</mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo>&gt;</mo><mn>0</mn>
  </mrow>
 </mrow></math> can transform all dimensions to the same scale; this is similar to the SGD case in Handout 3. Hence the update <a href="#eq__7">(3.2)</a> becomes<a id="eq__7_1" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow><mi>t</mi><mo>+</mo><mn>1</mn>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup><mo>=</mo>
     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup><mo>+</mo>
     <msub>
      <mrow><mi> &eta; </mi>
      </mrow>
      <mrow><mi>t</mi>
      </mrow>
     </msub>
     <msub>
      <mrow><mi>P</mi>
      </mrow>
      <mrow><mi>t</mi>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <mfrac>
       <mrow><mi>n</mi>
       </mrow>
       <mrow><mi>m</mi>
       </mrow>
      </mfrac>
      <msub>
       <mrow><mo> &sum; </mo>
       </mrow>
       <mrow>
        <mrow><mi>i</mi><mo> &isin; </mo>
         <msup>
          <mrow><mi>J</mi>
          </mrow>
          <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

          </mrow>
         </msup>
        </mrow>
       </mrow>
      </msub><mi> &nabla; </mi><mo> log </mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msub>
        <mrow><mi>z</mi>
        </mrow>
        <mrow><mi>i</mi>
        </mrow>
       </msub><mo>|</mo><mi>w</mi>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo><mi> &nabla; </mi><mo> log </mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo>
     <msqrt>
      <msub>
       <mrow><mi> &eta; </mi>
       </mrow>
       <mrow><mi>t</mi>
       </mrow>
      </msub>
     </msqrt>
     <msqrt><mi> &tau; </mi>
     </msqrt>
     <msubsup>
      <mrow><mi>P</mi>
      </mrow>
      <mrow><mi>t</mi>
      </mrow>
      <mrow>
       <mfrac>
        <mrow><mn>1</mn>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
       </mfrac>
      </mrow>
     </msubsup>
     <msub>
      <mrow><mi> &epsi; </mi>
      </mrow>
      <mrow><mi>t</mi>
      </mrow>
     </msub>
    </mrow>
   </mtd>
   <mtd>(3.9)
   </mtd>
  </mtr>
 </mtable></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msubsup>
   <mrow><mi>P</mi>
   </mrow>
   <mrow><mi>t</mi>
   </mrow>
   <mrow>
    <mfrac>
     <mrow><mn>1</mn>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </mfrac>
   </mrow>
  </msubsup>
 </mrow></math> is such that <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msubsup>
    <mrow><mi>P</mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
    <mrow>
     <mfrac>
      <mrow><mn>1</mn>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </mfrac>
    </mrow>
   </msubsup>
   <msup>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <msubsup>
      <mrow><mi>P</mi>
      </mrow>
      <mrow><mi>t</mi>
      </mrow>
      <mrow>
       <mfrac>
        <mrow><mn>1</mn>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
       </mfrac>
      </mrow>
     </msubsup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
    <mrow><mi> &top; </mi>
    </mrow>
   </msup><mo>=</mo>
   <msub>
    <mrow><mi>P</mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub>
  </mrow>
 </mrow></math>. </div>
</div>



<div class="standard" id='magicparlabel-215'><br />

</div>

<div class="remark" id='magicparlabel-216'><div class="remark_item"><span class="remark_label">Remark 37.</span>
`Exploding gradients' is the practical phenomenon in which large updates to weights during training can cause a numerical overflow or underflow due to the machine error of the computer. Practical solutions involve, at each iteration <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>t</mi>
 </mrow></math>, checking the magnitude of the gradient <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>v</mi>
   </mrow>
   <mrow><mi>t</mi>
   </mrow>
  </msub>
 </mrow></math>, (e.g., Euclidean norm <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>&par;</mo>

  <msub>
   <mrow><mi>v</mi>
   </mrow>
   <mrow><mi>t</mi>
   </mrow>
  </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&par;</mo>

 </mrow></math>), and instantly changing it (e.g., truncating it) if it is gonna result an overflow. </div>

<dl class='description' id='magicparlabel-225'><dt class="description_label">Gradient&nbsp;scaling</dt>
<dd class="description_item"> involves normalizing the gradient vector such that vector norm (magnitude) equals a defined value. More formally, given any gradient <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>v</mi>
 </mrow></math> on an example, gradient clipping can be used in a standard recursion <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msup>
    <mrow><mi>w</mi>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>t</mi><mo>+</mo><mn>1</mn>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup><mo>=</mo>
   <msup>
    <mrow><mi>w</mi>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup><mo>+</mo>
   <msub>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub>
   <msub>
    <mrow><mi>v</mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub>
  </mrow>
 </mrow></math>as <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msup>
    <mrow><mi>w</mi>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>t</mi><mo>+</mo><mn>1</mn>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup><mo>=</mo>
   <msup>
    <mrow><mi>w</mi>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup><mo>+</mo>
   <msub>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub>
   <mstyle mathvariant='normal'>
    <mrow><mi>c</mi><mi>l</mi><mi>i</mi><mi>p</mi>
    </mrow>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>v</mi>
     </mrow>
     <mrow><mi>t</mi>
     </mrow>
    </msub><mo>,</mo><mi>c</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> where <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mstyle mathvariant='normal'>
    <mrow><mi>c</mi><mi>l</mi><mi>i</mi><mi>p</mi>
    </mrow>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>v</mi><mo>,</mo><mi>c</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mi>v</mi><mo> min </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mn>1</mn><mo>,</mo>
    <mfrac>
     <mrow><mi>c</mi>
     </mrow>
     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>&par;</mo>
<mi>v</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&par;</mo>

     </mrow>
    </mfrac>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>c</mi>
 </mrow></math> is a clipping threshold impaling that clipping will take place at iteration <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>t</mi>
 </mrow></math> if <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>&par;</mo>

   <msub>
    <mrow><mi>v</mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>&par;</mo>
<mo>&gt;</mo><mi>c</mi>
  </mrow>
 </mrow></math>. </dd>
<dt class="description_label">Gradient&nbsp;clipping</dt>
<dd class="description_item"> involves forcing the gradient values (element-wise) to a specific minimum or maximum value if the gradient exceeded an expected range.</dd>
</dl>
<div class="standard" id='magicparlabel-227'>Beware that unreasonable clipping may introduce significant bias and hence it should not be applied unnecessarily.</div>
</div>

<div class="standard" id='magicparlabel-228'><br />

</div>
<h2 class="section" id='magicparlabel-229'><span class="section_label">4</span> <a id="sec_Examples" />
Examples <div class="foot"><span class="foot_label">2</span><div class="foot_inner"><div class="plain_layout" id='magicparlabel-233'>Code is available from <span class="flex_url">https://github.com/georgios-stats/Machine_Learning_and_Neural_Networks_III_Epiphany_2023/tree/main/Lecture_handouts/code/04.Stochastic_gradient_Langevine_dynamics</span></div>
</div></div></h2>
<div class="standard" id='magicparlabel-238'>We continue the Example <a href="#exa_Consider_the_simple">exa:Consider-the-simple</a> in Handout 1, and Example <a href="#sec_Example">sec:Example</a> in Handout 2. Consider the Bayesian Normal linear regression model<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>
  <mtable>
   <mtr>
    <mtd>
     <mrow>
      <msub>
       <mrow><mi>y</mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub><mo>|</mo><mi> &beta; </mi><mo>,</mo>
      <msup>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msup><mo> &sim; </mo>
      <mstyle mathvariant='normal'><mi>N</mi>
      </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msubsup>
        <mrow><mi>x</mi>
        </mrow>
        <mrow><mi>i</mi>
        </mrow>
        <mrow><mi> &top; </mi>
        </mrow>
       </msubsup><mi> &beta; </mi><mo>,</mo>
       <msup>
        <mrow><mi> &sigma; </mi>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
       </msup>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </mtd>
    <mtd>
     <mrow>
      <mstyle mathvariant='normal'>
       <mrow><mi>s</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>l</mi><mi>i</mi><mi>n</mi><mi>g</mi>&nbsp;<mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>b</mi><mi>u</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi>
       </mrow>
      </mstyle><mspace width="6px" /><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msub>
        <mrow><mi>y</mi>
        </mrow>
        <mrow><mi>i</mi>
        </mrow>
       </msub><mo>|</mo><mi> &beta; </mi><mo>,</mo>
       <msup>
        <mrow><mi> &sigma; </mi>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
       </msup>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd>
     <mrow><mi> &beta; </mi><mo>|</mo>
      <msup>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msup><mo> &sim; </mo>
      <mstyle mathvariant='normal'><mi>N</mi>
      </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi> &mu; </mi><mo>,</mo>
       <msup>
        <mrow><mi> &sigma; </mi>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
       </msup><mi>V</mi>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </mtd>
    <mtd>
     <mrow>
      <mstyle mathvariant='normal'>
       <mrow><mi>p</mi><mi>r</mi><mi>i</mi><mi>o</mi><mi>r</mi>
       </mrow>
      </mstyle><mspace width="6px" /><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi> &beta; </mi><mo>|</mo>
       <msup>
        <mrow><mi> &sigma; </mi>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
       </msup>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd>
     <mrow>
      <msup>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msup><mo> &sim; </mo>
      <mstyle mathvariant='normal'>
       <mrow><mi>I</mi><mi>G</mi>
       </mrow>
      </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi> &phi; </mi><mo>,</mo><mi> &psi; </mi>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </mtd>
    <mtd>
     <mrow>
      <mstyle mathvariant='normal'>
       <mrow><mi>p</mi><mi>r</mi><mi>i</mi><mi>o</mi><mi>r</mi>
       </mrow>
      </mstyle><mspace width="6px" /><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <msup>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </mtd>
   </mtr>
  </mtable>
 </mrow></math>and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &beta; </mi><mo>,</mo>
    <msup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &beta; </mi><mo>|</mo>
    <msup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <msup>
    <mrow><mi> &sigma; </mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &beta; </mi><mo> &isin; </mo>
   <msup>
    <mrow>
     <mstyle mathvariant='double-struck'><mi>R</mi>
     </mstyle>
    </mrow>
    <mrow><mi>d</mi>
    </mrow>
   </msup>
  </mrow>
 </mrow></math>, and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msup>
    <mrow><mi> &sigma; </mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msup><mo> &isin; </mo>
   <msub>
    <mrow>
     <mstyle mathvariant='double-struck'><mi>R</mi>
     </mstyle>
    </mrow>
    <mrow><mo>+</mo>
    </mrow>
   </msub>
  </mrow>
 </mrow></math>. Note given densities<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mstyle mathvariant='normal'><mi>N</mi>
     </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>x</mi><mo>|</mo><mi> &mu; </mi><mo>,</mo><mo> &Sigma; </mo>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mo>=</mo>
     <msup>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mfrac>
        <mrow><mn>1</mn>
        </mrow>
        <mrow>
         <mrow><mn>2</mn><mi> &pi; </mi>
         </mrow>
        </mrow>
       </mfrac>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
      <mrow><mi>d</mi>
      </mrow>
     </msup>
     <mfrac>
      <mrow><mn>1</mn>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>|</mo>
<mo> &Sigma; </mo>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

      </mrow>
     </mfrac><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mo>-</mo>
      <mfrac>
       <mrow><mn>1</mn>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </mfrac>
      <msup>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>x</mi><mo>-</mo><mi> &mu; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
       <mrow><mi> &top; </mi>
       </mrow>
      </msup>
      <msup>
       <mrow><mo> &Sigma; </mo>
       </mrow>
       <mrow>
        <mrow><mo>-</mo><mn>1</mn>
        </mrow>
       </mrow>
      </msup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi>x</mi><mo>-</mo><mi> &mu; </mi>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow>
     <mstyle mathvariant='normal'>
      <mrow><mi>I</mi><mi>G</mi>
      </mrow>
     </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>x</mi><mo>|</mo><mi>a</mi><mo>,</mo><mi>b</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mo>=</mo>
     <mfrac>
      <mrow>
       <msup>
        <mrow><mi>b</mi>
        </mrow>
        <mrow><mi>a</mi>
        </mrow>
       </msup>
      </mrow>
      <mrow>
       <mrow><mo> &Gamma; </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>a</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow>
     </mfrac>
     <msup>
      <mrow><mi>x</mi>
      </mrow>
      <mrow>
       <mrow><mo>-</mo><mi>a</mi><mo>-</mo><mn>1</mn>
       </mrow>
      </mrow>
     </msup><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mo>-</mo>
      <mfrac>
       <mrow><mi>b</mi>
       </mrow>
       <mrow><mi>x</mi>
       </mrow>
      </mfrac>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <mstyle mathvariant='normal'><mn>1</mn>
     </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>x</mi><mo> &ge; </mo><mn>0</mn>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
  </mtr>
 </mtable></math>Because SGD (Algorithm <a href="#alg_Batch_Stochastic_Gradient">14</a>) and SGLD (Algorithm <a href="#alg_Stochastic_Gradient_Langevin">22</a>) can handle cases where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>w</mi><mo> &isin; </mo>
   <msup>
    <mrow>
     <mstyle mathvariant='double-struck'><mi>R</mi>
     </mstyle>
    </mrow>
    <mrow><mi>d</mi>
    </mrow>
   </msup>
  </mrow>
 </mrow></math> in a straightforward manner than what they do when <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>w</mi><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &beta; </mi><mo>,</mo>
    <msup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &isin; </mo>
   <msup>
    <mrow>
     <mstyle mathvariant='double-struck'><mi>R</mi>
     </mstyle>
    </mrow>
    <mrow><mi>d</mi>
    </mrow>
   </msup><mo> &times; </mo>
   <msub>
    <mrow>
     <mstyle mathvariant='double-struck'><mi>R</mi>
     </mstyle>
    </mrow>
    <mrow><mo>+</mo>
    </mrow>
   </msub>
  </mrow>
 </mrow></math> which requires an additional projection step; we consider a transformation <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>w</mi><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &beta; </mi><mo>,</mo><mi> &gamma; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &isin; </mo>
   <msup>
    <mrow>
     <mstyle mathvariant='double-struck'><mi>R</mi>
     </mstyle>
    </mrow>
    <mrow><mi>d</mi>
    </mrow>
   </msup><mo> &times; </mo>
   <mstyle mathvariant='double-struck'><mi>R</mi>
   </mstyle>
  </mrow>
 </mrow></math> with <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &gamma; </mi><mo>=</mo><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <msup>
    <mrow><mi> &sigma; </mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>. Hence, the Bayesian model becomes <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>
  <mtable>
   <mtr>
    <mtd>
     <mrow>
      <msub>
       <mrow><mi>y</mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub><mo>|</mo><mi> &beta; </mi><mo>,</mo>
      <msup>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msup><mo> &sim; </mo>
      <mstyle mathvariant='normal'><mi>N</mi>
      </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msubsup>
        <mrow><mi>x</mi>
        </mrow>
        <mrow><mi>i</mi>
        </mrow>
        <mrow><mi> &top; </mi>
        </mrow>
       </msubsup><mi> &beta; </mi><mo>,</mo><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &gamma; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </mtd>
    <mtd>
     <mrow>
      <mstyle mathvariant='normal'>
       <mrow><mi>s</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>l</mi><mi>i</mi><mi>n</mi><mi>g</mi>&nbsp;<mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>b</mi><mi>u</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi>
       </mrow>
      </mstyle><mspace width="6px" /><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msub>
        <mrow><mi>y</mi>
        </mrow>
        <mrow><mi>i</mi>
        </mrow>
       </msub><mo>|</mo><mi> &beta; </mi><mo>,</mo><mi> &gamma; </mi>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd>
     <mrow><mi> &beta; </mi><mo>|</mo>
      <msup>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msup><mo> &sim; </mo>
      <mstyle mathvariant='normal'><mi>N</mi>
      </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi> &mu; </mi><mo>=</mo><mn>0</mn><mo>,</mo><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &gamma; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi>V</mi>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </mtd>
    <mtd>
     <mrow>
      <mstyle mathvariant='normal'>
       <mrow><mi>p</mi><mi>r</mi><mi>i</mi><mi>o</mi><mi>r</mi>
       </mrow>
      </mstyle><mspace width="6px" /><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi> &beta; </mi><mo>|</mo><mi> &gamma; </mi>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd>
     <mrow><mi> &gamma; </mi><mo> &sim; </mo>
      <msub>
       <mrow><mi>f</mi>
       </mrow>
       <mrow><mi> &gamma; </mi>
       </mrow>
      </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &gamma; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </mtd>
    <mtd>
     <mrow>
      <mstyle mathvariant='normal'>
       <mrow><mi>p</mi><mi>r</mi><mi>i</mi><mi>o</mi><mi>r</mi>
       </mrow>
      </mstyle><mspace width="6px" /><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &gamma; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </mtd>
   </mtr>
  </mtable>
 </mrow></math>where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>f</mi>
    </mrow>
    <mrow><mi> &gamma; </mi>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &gamma; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> is computed according to the method of bijective transformation of random variables; i.e. <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>f</mi>
    </mrow>
    <mrow><mi> &gamma; </mi>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &gamma; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
   <mstyle mathvariant='normal'>
    <mrow><mi>I</mi><mi>G</mi>
    </mrow>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &gamma; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>|</mo><mi> &phi; </mi><mo>,</mo><mi> &psi; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo form='prefix' fence='true' stretchy='true' symmetric='true'>|</mo>

   <mrow>
    <mfrac>
     <mrow>
      <mstyle mathvariant='normal'><mi>d</mi>
      </mstyle>
     </mrow>
     <mrow>
      <mrow>
       <mstyle mathvariant='normal'><mi>d</mi>
       </mstyle><mi> &gamma; </mi>
      </mrow>
     </mrow>
    </mfrac><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &gamma; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>
<mo>=</mo>
   <mstyle mathvariant='normal'>
    <mrow><mi>I</mi><mi>G</mi>
    </mrow>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &gamma; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>|</mo><mi> &phi; </mi><mo>,</mo><mi> &psi; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &gamma; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>Then we can compute the required gradients in order to run the SGD, and SGLD with respect to <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>w</mi><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &beta; </mi><mo>,</mo><mi> &gamma; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> with <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &gamma; </mi><mo>=</mo><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <msup>
    <mrow><mi> &sigma; </mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>.<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msub>
        <mrow><mi>z</mi>
        </mrow>
        <mrow><mi>i</mi>
        </mrow>
       </msub><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow>
        <msub>
         <mrow><mi>x</mi>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
        </msub><mo>,</mo>
        <msub>
         <mrow><mi>y</mi>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
        </msub>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>|</mo><mi>w</mi>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
    </mrow>
   </mtd>
   <mtd>
    <mrow><mo>-</mo>
     <mfrac>
      <mrow><mn>1</mn>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </mfrac><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mn>2</mn><mi> &pi; </mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>-</mo>
     <mfrac>
      <mrow><mn>1</mn>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </mfrac><mi> &gamma; </mi><mo>-</mo>
     <mfrac>
      <mrow><mn>1</mn>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </mfrac>
     <msup>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow>
        <msub>
         <mrow><mi>y</mi>
         </mrow>
         <mrow><mi>j</mi>
         </mrow>
        </msub><mo>-</mo>
        <msubsup>
         <mrow><mi>x</mi>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
         <mrow><mi> &top; </mi>
         </mrow>
        </msubsup><mi> &beta; </mi>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msup><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mo>-</mo><mi> &gamma; </mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi>w</mi><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow><mi> &beta; </mi><mo>,</mo><mi> &gamma; </mi>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
    </mrow>
   </mtd>
   <mtd>
    <mrow><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi> &beta; </mi><mo>|</mo><mi> &gamma; </mi>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &gamma; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi> &beta; </mi><mo>|</mo><mi> &gamma; </mi>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
    </mrow>
   </mtd>
   <mtd>
    <mrow><mo>-</mo>
     <mfrac>
      <mrow><mi>d</mi>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </mfrac><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mn>2</mn><mi> &pi; </mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>-</mo>
     <mfrac>
      <mrow><mi>d</mi>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </mfrac><mi> &gamma; </mi><mo>-</mo>
     <mfrac>
      <mrow><mn>1</mn>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </mfrac><mo form='prefix' fence='true' stretchy='true' symmetric='true'>|</mo>
<mi>V</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>
<mo>-</mo>
     <mfrac>
      <mrow><mn>1</mn>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </mfrac><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mo>-</mo><mi> &gamma; </mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <msup>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow><mi> &beta; </mi><mo>-</mo><mi> &mu; </mi>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
      <mrow><mi> &top; </mi>
      </mrow>
     </msup>
     <msup>
      <mrow><mi>V</mi>
      </mrow>
      <mrow>
       <mrow><mo>-</mo><mn>1</mn>
       </mrow>
      </mrow>
     </msup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi> &beta; </mi><mo>-</mo><mi> &mu; </mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &gamma; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
    </mrow>
   </mtd>
   <mtd>
    <mrow><mi> &psi; </mi><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &phi; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>-</mo><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mo> &Gamma; </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &phi; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>-</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi> &phi; </mi><mo>+</mo><mn>1</mn>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi> &gamma; </mi><mo>-</mo><mi> &psi; </mi><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mo>-</mo><mi> &gamma; </mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo><mi> &gamma; </mi>
    </mrow>
   </mtd>
  </mtr>
 </mtable></math>Hence for the log sampling PDF we have<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <msub>
      <mrow><mi> &nabla; </mi>
      </mrow>
      <mrow><mi>w</mi>
      </mrow>
     </msub><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msub>
        <mrow><mi>z</mi>
        </mrow>
        <mrow><mi>i</mi>
        </mrow>
       </msub><mo>|</mo><mi>w</mi>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
    </mrow>
   </mtd>
   <mtd><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow>
     <mfrac>
      <mrow>
       <mstyle mathvariant='normal'><mi>d</mi>
       </mstyle>
      </mrow>
      <mrow>
       <mrow>
        <mstyle mathvariant='normal'><mi>d</mi>
        </mstyle><mi> &beta; </mi>
       </mrow>
      </mrow>
     </mfrac><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msub>
        <mrow><mi>z</mi>
        </mrow>
        <mrow><mi>i</mi>
        </mrow>
       </msub><mo>|</mo><mi>w</mi>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mspace width="6px" /><mo>;</mo><mspace width="6px" />
     <mfrac>
      <mrow>
       <mstyle mathvariant='normal'><mi>d</mi>
       </mstyle>
      </mrow>
      <mrow>
       <mrow>
        <mstyle mathvariant='normal'><mi>d</mi>
        </mstyle><mi> &gamma; </mi>
       </mrow>
      </mrow>
     </mfrac><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msub>
        <mrow><mi>z</mi>
        </mrow>
        <mrow><mi>i</mi>
        </mrow>
       </msub><mo>|</mo><mi>w</mi>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow>
     <mfrac>
      <mrow>
       <mstyle mathvariant='normal'><mi>d</mi>
       </mstyle>
      </mrow>
      <mrow>
       <mrow>
        <mstyle mathvariant='normal'><mi>d</mi>
        </mstyle><mi> &beta; </mi>
       </mrow>
      </mrow>
     </mfrac><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msub>
        <mrow><mi>z</mi>
        </mrow>
        <mrow><mi>i</mi>
        </mrow>
       </msub><mo>|</mo><mi>w</mi>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
    </mrow>
   </mtd>
   <mtd>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi>y</mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub><mo>-</mo>
      <msubsup>
       <mrow><mi>x</mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
       <mrow><mi> &top; </mi>
       </mrow>
      </msubsup><mi> &beta; </mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <msub>
      <mrow><mi>x</mi>
      </mrow>
      <mrow><mi>i</mi>
      </mrow>
     </msub><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mo>-</mo><mi> &gamma; </mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow>
     <mfrac>
      <mrow>
       <mstyle mathvariant='normal'><mi>d</mi>
       </mstyle>
      </mrow>
      <mrow>
       <mrow>
        <mstyle mathvariant='normal'><mi>d</mi>
        </mstyle><mi> &gamma; </mi>
       </mrow>
      </mrow>
     </mfrac><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msub>
        <mrow><mi>z</mi>
        </mrow>
        <mrow><mi>i</mi>
        </mrow>
       </msub><mo>|</mo><mi>w</mi>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
    </mrow>
   </mtd>
   <mtd>
    <mrow><mo>-</mo>
     <mfrac>
      <mrow><mn>1</mn>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </mfrac><mo>+</mo>
     <mfrac>
      <mrow><mn>1</mn>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </mfrac>
     <msup>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow>
        <msub>
         <mrow><mi>y</mi>
         </mrow>
         <mrow><mi>j</mi>
         </mrow>
        </msub><mo>-</mo>
        <msubsup>
         <mrow><mi>x</mi>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
         <mrow><mi> &top; </mi>
         </mrow>
        </msubsup><mi> &beta; </mi>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msup><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mo>-</mo><mi> &gamma; </mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
  </mtr>
 </mtable></math> ...so<a id="eq__12" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <msub>
      <mrow><mi> &nabla; </mi>
      </mrow>
      <mrow><mi>w</mi>
      </mrow>
     </msub><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msub>
        <mrow><mi>z</mi>
        </mrow>
        <mrow><mi>i</mi>
        </mrow>
       </msub><mo>|</mo><mi>w</mi>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>(</mo>
     <mtable>
      <mtr>
       <mtd>
        <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <mrow>
          <msub>
           <mrow><mi>y</mi>
           </mrow>
           <mrow><mi>i</mi>
           </mrow>
          </msub><mo>-</mo>
          <msubsup>
           <mrow><mi>x</mi>
           </mrow>
           <mrow><mi>i</mi>
           </mrow>
           <mrow><mi> &top; </mi>
           </mrow>
          </msubsup><mi> &beta; </mi>
         </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         <msub>
          <mrow><mi>x</mi>
          </mrow>
          <mrow><mi>i</mi>
          </mrow>
         </msub><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <mrow><mo>-</mo><mi> &gamma; </mi>
         </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <mrow><mo>-</mo>
         <mfrac>
          <mrow><mn>1</mn>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </mfrac><mo>+</mo>
         <mfrac>
          <mrow><mn>1</mn>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </mfrac>
         <msup>
          <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

           <mrow>
            <msub>
             <mrow><mi>y</mi>
             </mrow>
             <mrow><mi>j</mi>
             </mrow>
            </msub><mo>-</mo>
            <msubsup>
             <mrow><mi>x</mi>
             </mrow>
             <mrow><mi>i</mi>
             </mrow>
             <mrow><mi> &top; </mi>
             </mrow>
            </msubsup><mi> &beta; </mi>
           </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msup><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <mrow><mo>-</mo><mi> &gamma; </mi>
         </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </mtd>
      </mtr>
     </mtable><mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>)</mo>
    </mrow>
   </mtd>
   <mtd>(4.1)
   </mtd>
  </mtr>
 </mtable></math>Hence for the log a priori PDF we have<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <msub>
      <mrow><mi> &nabla; </mi>
      </mrow>
      <mrow><mi>w</mi>
      </mrow>
     </msub><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
    </mrow>
   </mtd>
   <mtd><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow>
     <mfrac>
      <mrow>
       <mstyle mathvariant='normal'><mi>d</mi>
       </mstyle>
      </mrow>
      <mrow>
       <mrow>
        <mstyle mathvariant='normal'><mi>d</mi>
        </mstyle><mi> &beta; </mi>
       </mrow>
      </mrow>
     </mfrac><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mspace width="6px" /><mo>;</mo><mspace width="6px" />
     <mfrac>
      <mrow>
       <mstyle mathvariant='normal'><mi>d</mi>
       </mstyle>
      </mrow>
      <mrow>
       <mrow>
        <mstyle mathvariant='normal'><mi>d</mi>
        </mstyle><mi> &gamma; </mi>
       </mrow>
      </mrow>
     </mfrac><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow>
     <mfrac>
      <mrow>
       <mstyle mathvariant='normal'><mi>d</mi>
       </mstyle>
      </mrow>
      <mrow>
       <mrow>
        <mstyle mathvariant='normal'><mi>d</mi>
        </mstyle><mi> &beta; </mi>
       </mrow>
      </mrow>
     </mfrac><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
    </mrow>
   </mtd>
   <mtd>
    <mrow><mo>-</mo><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mo>-</mo><mi> &gamma; </mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <msup>
      <mrow><mi>V</mi>
      </mrow>
      <mrow>
       <mrow><mo>-</mo><mn>1</mn>
       </mrow>
      </mrow>
     </msup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi> &beta; </mi><mo>-</mo><mi> &mu; </mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow>
     <mfrac>
      <mrow>
       <mstyle mathvariant='normal'><mi>d</mi>
       </mstyle>
      </mrow>
      <mrow>
       <mrow>
        <mstyle mathvariant='normal'><mi>d</mi>
        </mstyle><mi> &gamma; </mi>
       </mrow>
      </mrow>
     </mfrac><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
    </mrow>
   </mtd>
   <mtd>
    <mrow><mo>-</mo>
     <mfrac>
      <mrow><mi>d</mi>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </mfrac><mo>+</mo>
     <mfrac>
      <mrow><mn>1</mn>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </mfrac><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mo>-</mo><mi> &gamma; </mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <msup>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow><mi> &beta; </mi><mo>-</mo><mi> &mu; </mi>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
      <mrow><mi> &top; </mi>
      </mrow>
     </msup>
     <msup>
      <mrow><mi>V</mi>
      </mrow>
      <mrow>
       <mrow><mo>-</mo><mn>1</mn>
       </mrow>
      </mrow>
     </msup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi> &beta; </mi><mo>-</mo><mi> &mu; </mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>-</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi> &phi; </mi><mo>+</mo><mn>1</mn>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo><mi> &psi; </mi><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mo>-</mo><mi> &gamma; </mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo><mn>1</mn>
    </mrow>
   </mtd>
  </mtr>
 </mtable></math> ...so<a id="eq__13" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <msub>
      <mrow><mi> &nabla; </mi>
      </mrow>
      <mrow><mi>w</mi>
      </mrow>
     </msub><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>w</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>(</mo>
     <mtable>
      <mtr>
       <mtd>
        <mrow><mo>-</mo><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <mrow><mo>-</mo><mi> &gamma; </mi>
         </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         <msup>
          <mrow><mi>V</mi>
          </mrow>
          <mrow>
           <mrow><mo>-</mo><mn>1</mn>
           </mrow>
          </mrow>
         </msup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <mrow><mi> &beta; </mi><mo>-</mo><mi> &mu; </mi>
         </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <mrow>
         <mfrac>
          <mrow><mi>d</mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </mfrac><mo>+</mo>
         <mfrac>
          <mrow><mn>1</mn>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </mfrac><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <mrow><mo>-</mo><mi> &gamma; </mi>
         </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         <msup>
          <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

           <mrow><mi> &beta; </mi><mo>-</mo><mi> &mu; </mi>
           </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

          </mrow>
          <mrow><mi> &top; </mi>
          </mrow>
         </msup>
         <msup>
          <mrow><mi>V</mi>
          </mrow>
          <mrow>
           <mrow><mo>-</mo><mn>1</mn>
           </mrow>
          </mrow>
         </msup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <mrow><mi> &beta; </mi><mo>-</mo><mi> &mu; </mi>
         </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>-</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <mrow><mi> &phi; </mi><mo>+</mo><mn>1</mn>
         </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo><mi> &psi; </mi><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <mrow><mo>-</mo><mi> &gamma; </mi>
         </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo><mn>1</mn>
        </mrow>
       </mtd>
      </mtr>
     </mtable><mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>)</mo>
    </mrow>
   </mtd>
   <mtd>(4.2)
   </mtd>
  </mtr>
 </mtable></math> To implement SGD (Algorithm <a href="#alg_Batch_Stochastic_Gradient">14</a>) and SGLD (Algorithm <a href="#alg_Stochastic_Gradient_Langevin">22</a>) , we just need to plug in the computed gradients <a href="#eq__12">(4.1)</a> and <a href="#eq__13">(4.2)</a> for <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>w</mi><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &beta; </mi><mo>,</mo><mi> &gamma; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &isin; </mo>
   <msup>
    <mrow>
     <mstyle mathvariant='double-struck'><mi>R</mi>
     </mstyle>
    </mrow>
    <mrow><mi>d</mi>
    </mrow>
   </msup><mo> &times; </mo>
   <mstyle mathvariant='double-struck'><mi>R</mi>
   </mstyle>
  </mrow>
 </mrow></math> with <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &gamma; </mi><mo>=</mo><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <msup>
    <mrow><mi> &sigma; </mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>. After running SGD and SGLD with the computed gradients with respect to <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>w</mi><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &beta; </mi><mo>,</mo><mi> &gamma; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &isin; </mo>
   <msup>
    <mrow>
     <mstyle mathvariant='double-struck'><mi>R</mi>
     </mstyle>
    </mrow>
    <mrow><mi>d</mi>
    </mrow>
   </msup><mo> &times; </mo>
   <mstyle mathvariant='double-struck'><mi>R</mi>
   </mstyle>
  </mrow>
 </mrow></math> with <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &gamma; </mi><mo>=</mo><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <msup>
    <mrow><mi> &sigma; </mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>, and obtaining chains <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msubsup>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

    <mrow>
     <msup>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msup>
       <mrow><mi> &beta; </mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup><mo>,</mo>
      <msup>
       <mrow><mi> &gamma; </mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

   </mrow>
   <mrow>
    <mrow><mi>t</mi><mo>=</mo><mn>1</mn>
    </mrow>
   </mrow>
   <mrow><mi>T</mi>
   </mrow>
  </msubsup>
 </mrow></math>, we can just perform transformation <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msubsup>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

    <mrow>
     <msup>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <msup>
        <mrow><mi> &sigma; </mi>
        </mrow>
        <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msup><mo>=</mo><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <msup>
      <mrow><mi> &gamma; </mi>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

   </mrow>
   <mrow>
    <mrow><mi>t</mi><mo>=</mo><mn>1</mn>
    </mrow>
   </mrow>
   <mrow><mi>T</mi>
   </mrow>
  </msubsup>
 </mrow></math> if we are interested in learning <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

  <mrow><mi> &beta; </mi><mo>,</mo>
   <msup>
    <mrow><mi> &sigma; </mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msup>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

 </mrow></math>.</div>

<div class="standard" id='magicparlabel-260'>We consider <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &mu; </mi><mo>=</mo><mn>0</mn>
  </mrow>
 </mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &phi; </mi><mo>=</mo><mn>1</mn>
  </mrow>
 </mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &psi; </mi><mo>=</mo><mn>1</mn>
  </mrow>
 </mrow></math>, and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>V</mi><mo>=</mo><mn>100</mn>
   <msub>
    <mrow><mi>I</mi>
    </mrow>
    <mrow><mi>d</mi>
    </mrow>
   </msub>
  </mrow>
 </mrow></math>, for our simulations below. </div>

<ul class="itemize" id='magicparlabel-261'><li class="itemize_item">In Figures <a href="#fig_">4.1</a>, we ran the SGD for different batch sizes <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>m</mi>
 </mrow></math> and compared it against the exact MLE. We observe that SGD trace converges to the exact MLE. The oscillations are due to the stochastic gradient (ie, noise in the gradient). </li>
<li class="itemize_item">In Figures <a href="#fig__2">4.2</a>, we ran the SGLD for different batch sizes <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>m</mi>
 </mrow></math> but the same temperature <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &tau; </mi><mo>=</mo><mn>1</mn>
  </mrow>
 </mrow></math> and compared it against the exact posterior densities. We observe that the histograms of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

  <msup>
   <mrow><mi>w</mi>
   </mrow>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
  </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

 </mrow></math> produced from SGLD are closer to the curves representing the exact posteriors when the batch size <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>m</mi>
 </mrow></math> is bigger. As we said this is not a panacea; if the landscape of the exact psterior density was multimodal (aka not convex but with had several maxima), then the SGLD using smaller batch sizes could have performed better, in the sense that the inflated noise from the stochastic gradient could accidentally make the generated chain to pass the low mass barrier and visit a different mode, unlike the one with larger batch-size and hence smaller variation.</li>
<li class="itemize_item">In Figures <a href="#fig__2_1">4.3</a>, we ran the SGLD for different temperatures <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi> &tau; </mi>
 </mrow></math> but the same batch sizes <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>m</mi><mo>=</mo><mn>100</mn>
  </mrow>
 </mrow></math> and compared it against the exact posterior densities. We observe that increasing the temperature <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi> &tau; </mi>
 </mrow></math> may increase the variation of the produced chain. We can use a large <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi> &tau; </mi>
 </mrow></math> at the beginning of the run of the algorithm to perform an exploration of the space (this is particularly useful for non-convex/multimodal densities as it allows visiting different modes), and later on we can use a smaller temperature such as <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &tau; </mi><mo>=</mo><mn>1</mn>
  </mrow>
 </mrow></math>. </li>
</ul>

<div class="standard" id='magicparlabel-264'><br />

</div>



<div class='float-figure'><div class='float-figure'><div class="plain_layout" id='magicparlabel-273'><img style='width:33%;' src='0_extra_tmp_mffk55_Dropbox_Teaching_2023_term2____ent_Langevine_dynamics_SGD_w1_batch_size=10.png' alt='image: 0_extra_tmp_mffk55_Dropbox_Teaching_2023_term2____ent_Langevine_dynamics_SGD_w1_batch_size=10.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure a:  <a id="fig__1" />
 </span></div>
</div>
<div class='float-figure'><div class="plain_layout" id='magicparlabel-281'><img style='width:33%;' src='1_extra_tmp_mffk55_Dropbox_Teaching_2023_term2____nt_Langevine_dynamics_SGD_w1_batch_size=100.png' alt='image: 1_extra_tmp_mffk55_Dropbox_Teaching_2023_term2____nt_Langevine_dynamics_SGD_w1_batch_size=100.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure b:  <a id="fig__1_1" />
 </span></div>
</div>
<div class='float-figure'><div class="plain_layout" id='magicparlabel-289'><img style='width:33%;' src='2_extra_tmp_mffk55_Dropbox_Teaching_2023_term2____t_Langevine_dynamics_SGD_w1_batch_size=1000.png' alt='image: 2_extra_tmp_mffk55_Dropbox_Teaching_2023_term2____t_Langevine_dynamics_SGD_w1_batch_size=1000.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure c:  <a id="fig__1_2" />
 </span></div>
</div>



<div class='float-figure'><div class="plain_layout" id='magicparlabel-298'><img style='width:33%;' src='3_extra_tmp_mffk55_Dropbox_Teaching_2023_term2____ent_Langevine_dynamics_SGD_w2_batch_size=10.png' alt='image: 3_extra_tmp_mffk55_Dropbox_Teaching_2023_term2____ent_Langevine_dynamics_SGD_w2_batch_size=10.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure d:  <a id="fig__1_3" />
 </span></div>
</div>
<div class='float-figure'><div class="plain_layout" id='magicparlabel-306'><img style='width:33%;' src='4_extra_tmp_mffk55_Dropbox_Teaching_2023_term2____nt_Langevine_dynamics_SGD_w2_batch_size=100.png' alt='image: 4_extra_tmp_mffk55_Dropbox_Teaching_2023_term2____nt_Langevine_dynamics_SGD_w2_batch_size=100.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure e:  <a id="fig__1_1_1" />
 </span></div>
</div>
<div class='float-figure'><div class="plain_layout" id='magicparlabel-314'><img style='width:33%;' src='5_extra_tmp_mffk55_Dropbox_Teaching_2023_term2____t_Langevine_dynamics_SGD_w2_batch_size=1000.png' alt='image: 5_extra_tmp_mffk55_Dropbox_Teaching_2023_term2____t_Langevine_dynamics_SGD_w2_batch_size=1000.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure f:  <a id="fig__1_2_1" />
 </span></div>
</div>



<div class='float-figure'><div class="plain_layout" id='magicparlabel-323'><img style='width:33%;' src='6_extra_tmp_mffk55_Dropbox_Teaching_2023_term2____ent_Langevine_dynamics_SGD_w3_batch_size=10.png' alt='image: 6_extra_tmp_mffk55_Dropbox_Teaching_2023_term2____ent_Langevine_dynamics_SGD_w3_batch_size=10.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure g:  <a id="fig__1_3_1" />
 </span></div>
</div>
<div class='float-figure'><div class="plain_layout" id='magicparlabel-331'><img style='width:33%;' src='7_extra_tmp_mffk55_Dropbox_Teaching_2023_term2____nt_Langevine_dynamics_SGD_w3_batch_size=100.png' alt='image: 7_extra_tmp_mffk55_Dropbox_Teaching_2023_term2____nt_Langevine_dynamics_SGD_w3_batch_size=100.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure h:  <a id="fig__1_1_1_1" />
 </span></div>
</div>
<div class='float-figure'><div class="plain_layout" id='magicparlabel-339'><img style='width:33%;' src='8_extra_tmp_mffk55_Dropbox_Teaching_2023_term2____t_Langevine_dynamics_SGD_w3_batch_size=1000.png' alt='image: 8_extra_tmp_mffk55_Dropbox_Teaching_2023_term2____t_Langevine_dynamics_SGD_w3_batch_size=1000.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure i:  <a id="fig__1_2_1_1" />
 </span></div>
</div>


<div class="plain_layout" id='magicparlabel-344'><span class='float-caption-Standard float-caption float-caption-standard'>Figure 4.1:  <a id="fig_" />
 Bayesian learning via SGD (SGD vs (exact)MLE) Study on batch size <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>m</mi>
 </mrow></math>. </span></div>


</div>




<div class='float-figure'><div class='float-figure'><div class="plain_layout" id='magicparlabel-358'><img style='width:33%;' src='9_extra_tmp_mffk55_Dropbox_Teaching_2023_term2____nt_Langevine_dynamics_SGLD_w1_batch_size=10.png' alt='image: 9_extra_tmp_mffk55_Dropbox_Teaching_2023_term2____nt_Langevine_dynamics_SGLD_w1_batch_size=10.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure a:  <a id="fig__1_4" />
</span></div>
</div>
<div class='float-figure'><div class="plain_layout" id='magicparlabel-366'><img style='width:33%;' src='10_extra_tmp_mffk55_Dropbox_Teaching_2023_term2___t_Langevine_dynamics_SGLD_w1_batch_size=100.png' alt='image: 10_extra_tmp_mffk55_Dropbox_Teaching_2023_term2___t_Langevine_dynamics_SGLD_w1_batch_size=100.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure b:  <a id="fig__1_1_2" />
</span></div>
</div>
<div class='float-figure'><div class="plain_layout" id='magicparlabel-374'><img style='width:33%;' src='11_extra_tmp_mffk55_Dropbox_Teaching_2023_term2____Langevine_dynamics_SGLD_w1_batch_size=1000.png' alt='image: 11_extra_tmp_mffk55_Dropbox_Teaching_2023_term2____Langevine_dynamics_SGLD_w1_batch_size=1000.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure c:  <a id="fig__1_2_2" />
</span></div>
</div>



<div class='float-figure'><div class="plain_layout" id='magicparlabel-383'><img style='width:33%;' src='12_extra_tmp_mffk55_Dropbox_Teaching_2023_term2___nt_Langevine_dynamics_SGLD_w2_batch_size=10.png' alt='image: 12_extra_tmp_mffk55_Dropbox_Teaching_2023_term2___nt_Langevine_dynamics_SGLD_w2_batch_size=10.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure d:  <a id="fig__1_3_2" />
</span></div>
</div>
<div class='float-figure'><div class="plain_layout" id='magicparlabel-391'><img style='width:33%;' src='13_extra_tmp_mffk55_Dropbox_Teaching_2023_term2___t_Langevine_dynamics_SGLD_w2_batch_size=100.png' alt='image: 13_extra_tmp_mffk55_Dropbox_Teaching_2023_term2___t_Langevine_dynamics_SGLD_w2_batch_size=100.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure e:  <a id="fig__1_1_1_2" />
</span></div>
</div>
<div class='float-figure'><div class="plain_layout" id='magicparlabel-399'><img style='width:33%;' src='14_extra_tmp_mffk55_Dropbox_Teaching_2023_term2____Langevine_dynamics_SGLD_w2_batch_size=1000.png' alt='image: 14_extra_tmp_mffk55_Dropbox_Teaching_2023_term2____Langevine_dynamics_SGLD_w2_batch_size=1000.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure f:  <a id="fig__1_2_1_2" />
</span></div>
</div>



<div class='float-figure'><div class="plain_layout" id='magicparlabel-408'><img style='width:33%;' src='15_extra_tmp_mffk55_Dropbox_Teaching_2023_term2___nt_Langevine_dynamics_SGLD_w3_batch_size=10.png' alt='image: 15_extra_tmp_mffk55_Dropbox_Teaching_2023_term2___nt_Langevine_dynamics_SGLD_w3_batch_size=10.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure g:  <a id="fig__1_3_1_1" />
</span></div>
</div>
<div class='float-figure'><div class="plain_layout" id='magicparlabel-416'><img style='width:33%;' src='16_extra_tmp_mffk55_Dropbox_Teaching_2023_term2___t_Langevine_dynamics_SGLD_w3_batch_size=100.png' alt='image: 16_extra_tmp_mffk55_Dropbox_Teaching_2023_term2___t_Langevine_dynamics_SGLD_w3_batch_size=100.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure h:  <a id="fig__1_1_1_1_1" />
</span></div>
</div>
<div class='float-figure'><div class="plain_layout" id='magicparlabel-424'><img style='width:33%;' src='17_extra_tmp_mffk55_Dropbox_Teaching_2023_term2____Langevine_dynamics_SGLD_w3_batch_size=1000.png' alt='image: 17_extra_tmp_mffk55_Dropbox_Teaching_2023_term2____Langevine_dynamics_SGLD_w3_batch_size=1000.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure i:  <a id="fig__1_2_1_1_1" />
</span></div>
</div>


<div class="plain_layout" id='magicparlabel-429'><span class='float-caption-Standard float-caption float-caption-standard'>Figure 4.2:  <a id="fig__2" />
 Bayesian learning: SGLD vs exact posterior (in red). Temperature <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &tau; </mi><mo>=</mo><mn>1</mn>
  </mrow>
 </mrow></math>. Study on batch size <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>m</mi>
 </mrow></math></span></div>
</div>




<div class='float-figure'><div class='float-figure'><div class="plain_layout" id='magicparlabel-442'><img style='width:33%;' src='18_extra_tmp_mffk55_Dropbox_Teaching_2023_term2___radient_Langevine_dynamics_SGLD_w1_tau=0_01.png' alt='image: 18_extra_tmp_mffk55_Dropbox_Teaching_2023_term2___radient_Langevine_dynamics_SGLD_w1_tau=0_01.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure a:  <a id="fig__1_4_1" />
</span></div>
</div>
<div class='float-figure'><div class="plain_layout" id='magicparlabel-450'><img style='width:33%;' src='19_extra_tmp_mffk55_Dropbox_Teaching_2023_term2___c_gradient_Langevine_dynamics_SGLD_w1_tau=1.png' alt='image: 19_extra_tmp_mffk55_Dropbox_Teaching_2023_term2___c_gradient_Langevine_dynamics_SGLD_w1_tau=1.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure b:  <a id="fig__1_1_2_1" />
</span></div>
</div>
<div class='float-figure'><div class="plain_layout" id='magicparlabel-458'><img style='width:33%;' src='20_extra_tmp_mffk55_Dropbox_Teaching_2023_term2____gradient_Langevine_dynamics_SGLD_w1_tau=10.png' alt='image: 20_extra_tmp_mffk55_Dropbox_Teaching_2023_term2____gradient_Langevine_dynamics_SGLD_w1_tau=10.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure c:  <a id="fig__1_2_2_1" />
</span></div>
</div>



<div class='float-figure'><div class="plain_layout" id='magicparlabel-467'><img style='width:33%;' src='21_extra_tmp_mffk55_Dropbox_Teaching_2023_term2___radient_Langevine_dynamics_SGLD_w2_tau=0_01.png' alt='image: 21_extra_tmp_mffk55_Dropbox_Teaching_2023_term2___radient_Langevine_dynamics_SGLD_w2_tau=0_01.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure d:  <a id="fig__1_3_2_1" />
</span></div>
</div>
<div class='float-figure'><div class="plain_layout" id='magicparlabel-475'><img style='width:33%;' src='22_extra_tmp_mffk55_Dropbox_Teaching_2023_term2___c_gradient_Langevine_dynamics_SGLD_w2_tau=1.png' alt='image: 22_extra_tmp_mffk55_Dropbox_Teaching_2023_term2___c_gradient_Langevine_dynamics_SGLD_w2_tau=1.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure e:  <a id="fig__1_1_1_2_1" />
</span></div>
</div>
<div class='float-figure'><div class="plain_layout" id='magicparlabel-483'><img style='width:33%;' src='23_extra_tmp_mffk55_Dropbox_Teaching_2023_term2____gradient_Langevine_dynamics_SGLD_w2_tau=10.png' alt='image: 23_extra_tmp_mffk55_Dropbox_Teaching_2023_term2____gradient_Langevine_dynamics_SGLD_w2_tau=10.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure f:  <a id="fig__1_2_1_2_1" />
</span></div>
</div>



<div class='float-figure'><div class="plain_layout" id='magicparlabel-492'><img style='width:33%;' src='24_extra_tmp_mffk55_Dropbox_Teaching_2023_term2___radient_Langevine_dynamics_SGLD_w3_tau=0_01.png' alt='image: 24_extra_tmp_mffk55_Dropbox_Teaching_2023_term2___radient_Langevine_dynamics_SGLD_w3_tau=0_01.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure g:  <a id="fig__1_3_1_1_1" />
</span></div>
</div>
<div class='float-figure'><div class="plain_layout" id='magicparlabel-500'><img style='width:33%;' src='25_extra_tmp_mffk55_Dropbox_Teaching_2023_term2___c_gradient_Langevine_dynamics_SGLD_w3_tau=1.png' alt='image: 25_extra_tmp_mffk55_Dropbox_Teaching_2023_term2___c_gradient_Langevine_dynamics_SGLD_w3_tau=1.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure h:  <a id="fig__1_1_1_1_1_1" />
</span></div>
</div>
<div class='float-figure'><div class="plain_layout" id='magicparlabel-508'><img style='width:33%;' src='26_extra_tmp_mffk55_Dropbox_Teaching_2023_term2____gradient_Langevine_dynamics_SGLD_w3_tau=10.png' alt='image: 26_extra_tmp_mffk55_Dropbox_Teaching_2023_term2____gradient_Langevine_dynamics_SGLD_w3_tau=10.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure i:  <a id="fig__1_2_1_1_1_1" />
</span></div>
</div>


<div class="plain_layout" id='magicparlabel-513'><span class='float-caption-Standard float-caption float-caption-standard'>Figure 4.3:  <a id="fig__2_1" />
 Bayesian learning: SGLD vs exact posterior (in red). Batch size <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo>=</mo><mn>100</mn>
  </mrow>
 </mrow></math>. Study on <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi> &tau; </mi>
 </mrow></math></span></div>
</div>

</body>
</html>
